<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/export/exporting_pcks.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-exporting-pcks"></target>
    <section ids="exporting-packs-patches-and-mods doc-exporting-pcks" names="exporting\ packs,\ patches,\ and\ mods doc_exporting_pcks">
        <title>Exporting packs, patches, and mods</title>
        <section ids="use-cases" names="use\ cases">
            <title>Use cases</title>
            <paragraph>Oftentimes, one would like to add functionality to one's game after it has been
                deployed.</paragraph>
            <paragraph>Examples of this include...</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Downloadable Content: the ability to add features and content to one's game.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Patches: the ability to fix a bug that is present in a shipped product.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Mods: grant other people the ability to create content for one's game.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>These tools help developers to extend their development beyond the initial
                release.</paragraph>
        </section>
        <section ids="overview-of-pck-zip-files" names="overview\ of\ pck/zip\ files">
            <title>Overview of PCK/ZIP files</title>
            <paragraph>Godot enables this via a feature called <strong>resource packs</strong> (PCK files,
                with the <literal>.pck</literal> extension, or ZIP files).</paragraph>
            <paragraph><strong>Advantages:</strong></paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>incremental updates/patches</paragraph>
                </list_item>
                <list_item>
                    <paragraph>offer DLCs</paragraph>
                </list_item>
                <list_item>
                    <paragraph>offer mod support</paragraph>
                </list_item>
                <list_item>
                    <paragraph>no source code disclosure needed for mods</paragraph>
                </list_item>
                <list_item>
                    <paragraph>more modular project structure</paragraph>
                </list_item>
                <list_item>
                    <paragraph>users don't have to replace the entire game</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>The first part of using them involves exporting and delivering the project to
                players. Then, when one wants to add functionality or content later on, they
                just deliver the updates via PCK/ZIP files to the users.</paragraph>
            <paragraph>PCK/ZIP files usually contain, but are not limited to:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>scripts</paragraph>
                </list_item>
                <list_item>
                    <paragraph>scenes</paragraph>
                </list_item>
                <list_item>
                    <paragraph>shaders</paragraph>
                </list_item>
                <list_item>
                    <paragraph>models</paragraph>
                </list_item>
                <list_item>
                    <paragraph>textures</paragraph>
                </list_item>
                <list_item>
                    <paragraph>sound effects</paragraph>
                </list_item>
                <list_item>
                    <paragraph>music</paragraph>
                </list_item>
                <list_item>
                    <paragraph>any other asset suitable for import into the game</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>The PCK/ZIP files can even be an entirely different Godot project, which the
                original game loads in at runtime.</paragraph>
            <paragraph>It is possible to load both PCK and ZIP files as additional packs at the same time.
                See <reference internal="True" refuri="exporting_projects#doc-exporting-projects-pck-versus-zip"><inline classes="std std-ref">PCK versus ZIP pack file formats</inline></reference> for a comparison of the two formats.</paragraph>
            <seealso>
                <paragraph>If you want to load loose files at runtime (not packed in a PCK or ZIP by Godot),
                    consider using <reference internal="True" refuri="../io/runtime_file_loading_and_saving#doc-runtime-loading-and-saving"><inline classes="std std-ref">Runtime file loading and saving</inline></reference> instead.
                    This is useful for loading user-generated content that is not made with Godot,
                    without requiring users to pack their mods into a specific file format.</paragraph>
                <paragraph>The downside of this approach is that it's less transparent to the game logic,
                    as it will not benefit from the same resource management as PCK/ZIP files.</paragraph>
            </seealso>
        </section>
        <section ids="generating-pck-files" names="generating\ pck\ files">
            <title>Generating PCK files</title>
            <paragraph>In order to pack all resources of a project into a PCK file, open the project
                and go to <strong>Project &gt; Export</strong> and click on <strong>Export PCK/ZIP</strong>. Also, make sure
                to have an export preset selected while doing so.</paragraph>
            <image candidates="{'*': 'tutorials/export/img/export_pck.webp'}" original_uri="img/export_pck.webp" uri="tutorials/export/img/export_pck.webp"></image>
            <paragraph>Another method would be to <reference internal="True" refuri="../editor/command_line_tutorial#doc-command-line-tutorial-exporting"><inline classes="std std-ref">export from the command line</inline></reference>
                with <literal>--export-pack</literal>. The output file must with a <literal>.pck</literal> or <literal>.zip</literal>
                file extension. The export process will build that type of file for the
                chosen platform.</paragraph>
            <note>
                <paragraph>If one wishes to support mods for their game, they will need their users to
                    create similarly exported files. Assuming the original game expects a
                    certain structure for the PCK's resources and/or a certain interface for
                    its scripts, then either...</paragraph>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>The developer must publicize documentation of these expected structures/
                            interfaces, expect modders to install Godot Engine, and then also expect
                            those modders to conform to the documentation's defined API when building
                            mod content for the game (so that it will work). Users would then use
                            Godot's built in exporting tools to create a PCK file, as detailed
                            above.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>The developer uses Godot to build a GUI tool for adding their exact API
                            content to a project. This Godot tool must either run on a tools-enabled
                            build of the engine or have access to one (distributed alongside or
                            perhaps in the original game's files). The tool can then use the Godot
                            executable to export a PCK file from the command line with
                            <reference internal="True" refuri="../../classes/class_os#class-os-method-execute"><inline classes="std std-ref">OS.execute()</inline></reference>. The game itself shouldn't
                            use a tool-build of the engine (for security), so it's best to keep
                            the modding tool and game separate.</paragraph>
                    </list_item>
                </enumerated_list>
            </note>
        </section>
        <section ids="opening-pck-or-zip-files-at-runtime" names="opening\ pck\ or\ zip\ files\ at\ runtime">
            <title>Opening PCK or ZIP files at runtime</title>
            <paragraph>To load a PCK or ZIP file, one uses the ProjectSettings singleton. The following
                example expects a <literal>mod.pck</literal> file in the directory of the game's executable.
                The PCK or ZIP file contains a <literal>mod_scene.tscn</literal> test scene in its root.</paragraph>
            <container classes="sphinx-tabs" type="tab-element">
                <div aria-label="Tabbed content" role="tablist">
                    <button aria-controls="panel-0-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                    <button aria-controls="panel-0-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
                </div>
                <div aria-labelledby="tab-0-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">func _your_function():
    # This could fail if, for example, mod.pck cannot be found.
    var success = ProjectSettings.load_resource_pack(OS.get_executable_path().get_base_dir().path_join("mod.pck"))

    if success:
        # Now one can use the assets as if they had them in the project from the start.
        var imported_scene = load("res://mod_scene.tscn")</literal_block>
                </div>
                <div aria-labelledby="tab-0-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-0-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">private void YourFunction()
{
    // This could fail if, for example, mod.pck cannot be found.
    var success = ProjectSettings.LoadResourcePack(OS.get_executable_path().get_base_dir().path_join("mod.pck));

    if (success)
    {
        // Now one can use the assets as if they had them in the project from the start.
        var importedScene = (PackedScene)ResourceLoader.Load("res://mod_scene.tscn");
    }
}</literal_block>
                </div>
            </container>
            <warning>
                <paragraph>By default, if you import a file with the same file path/name as one you
                    already have in your project, the imported one will replace it. This is
                    something to watch out for when creating DLC or mods. You can solve this
                    problem by using a tool that isolates mods to a specific mods subfolder.</paragraph>
                <paragraph>However, it is also a way of creating patches for one's own game. A PCK/ZIP
                    file of this kind can fix the content of a previously loaded PCK/ZIP
                    (therefore, the order in which packs are loaded matters).</paragraph>
                <paragraph>To opt out of this behavior, pass <literal>false</literal> as the second argument to
                    <reference internal="True" refuri="../../classes/class_projectsettings#class-projectsettings-method-load-resource-pack"><inline classes="std std-ref">ProjectSettings.load_resource_pack()</inline></reference>.</paragraph>
            </warning>
            <note>
                <paragraph>For a C# project, you need to build the DLL and place it in the project directory first.
                    Then, before loading the resource pack, you need to load its DLL as follows:
                    <literal>Assembly.LoadFile("mod.dll")</literal></paragraph>
            </note>
            <section ids="troubleshooting" names="troubleshooting">
                <title>Troubleshooting</title>
                <paragraph>If you are loading a resource pack and are not noticing any changes, it may be
                    due to the pack being loaded too late. This is particularly the case with menu
                    scenes that may preload other scenes using
                    <reference internal="True" refuri="../../classes/class_@gdscript#class-gdscript-method-preload"><inline classes="std std-ref">preload()</inline></reference>. This means that loading
                    a pack in the menu will not affect the other scene that was already preloaded.</paragraph>
                <paragraph>To avoid this, you need to load the pack as early as possible.
                    To do so, create a new <reference internal="True" refuri="../scripting/singletons_autoload#doc-singletons-autoload"><inline classes="std std-ref">autoload</inline></reference> script and
                    call <reference internal="True" refuri="../../classes/class_projectsettings#class-projectsettings-method-load-resource-pack"><inline classes="std std-ref">ProjectSettings.load_resource_pack()</inline></reference>
                    in the autoload script's <literal>_init()</literal> function, rather than <literal>_enter_tree()</literal>
                    or <literal>_ready()</literal>.</paragraph>
            </section>
        </section>
        <section ids="summary" names="summary">
            <title>Summary</title>
            <paragraph>This tutorial explains how to add mods, patches, or DLC to a game.
                The most important thing is to identify how one plans to distribute future
                content for their game and develop a workflow that is customized for that
                purpose. Godot should make that process smooth regardless of which route a
                developer pursues.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
