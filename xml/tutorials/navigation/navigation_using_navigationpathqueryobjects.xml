<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.17.1 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/navigation/navigation_using_navigationpathqueryobjects.rst" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-navigation-using-navigationpathqueryobjects"></target>
    <section ids="using-navigationpathqueryobjects doc-navigation-using-navigationpathqueryobjects" names="using\ navigationpathqueryobjects 使用\ navigationpathqueryobject doc_navigation_using_navigationpathqueryobjects">
        <title>使用 NavigationPathQueryObject</title>
        <paragraph><literal>NavigationPathQueryObjects</literal> 即导航路径查询对象，可以与 <literal>NavigationServer.query_path()</literal> 配合使用，对获取的导航路径进行丰富的<strong>自定义</strong>，指定包括<strong>元数据</strong>在内的各种项目。</paragraph>
        <paragraph>与获取正常的NavigationPath相比，这需要更多的设定，但可以让你根据项目的不同需求定制寻路并提供路径数据。</paragraph>
        <paragraph>NavigationPathQueryObjects由一对物件组成，一个 <literal>NavigationPathQueryParameters</literal> 物件保存查询的自定义选项，另一个 <literal>NavigationPathQueryResult</literal> 接收查询结果路径和元资料的（定期）更新。</paragraph>
        <paragraph><literal>NavigationPathQueryParameters</literal> 的2D和3D版本分别为 <reference internal="True" refuri="../../classes/class_navigationpathqueryparameters2d#class-navigationpathqueryparameters2d"><inline classes="std std-ref">NavigationPathQueryParameters2D</inline></reference> 和 <reference internal="True" refuri="../../classes/class_navigationpathqueryparameters3d#class-navigationpathqueryparameters3d"><inline classes="std std-ref">NavigationPathQueryParameters3D</inline></reference> 。</paragraph>
        <paragraph>2D and 3D versions of <literal>NavigationPathQueryResult</literal> are available as
            <reference internal="True" refuri="../../classes/class_navigationpathqueryresult2d#class-navigationpathqueryresult2d"><inline classes="std std-ref">NavigationPathQueryResult2D</inline></reference> and
            <reference internal="True" refuri="../../classes/class_navigationpathqueryresult3d#class-navigationpathqueryresult3d"><inline classes="std std-ref">NavigationPathQueryResult3D</inline></reference> respectively.</paragraph>
        <paragraph>参数和结果都与 <literal>NavigationServer.query_path()</literal> 函数成对使用。</paragraph>
        <paragraph>有关可用的自定义选项及其使用，请参阅参数的类文档。</paragraph>
        <paragraph>虽然这不是一个严格的要求，但这两个对象都要提前创建一次，存储在代理的持久变量中，并通过更新的参数重复用于每个后续路径查询。如果项目有大量同时进行的代理定期更新其路径，则这种重用可以避免频繁创建对象所带来的性能影响。</paragraph>
        <container classes="sphinx-tabs" type="tab-element">
            <div aria-label="Tabbed content" role="tablist">
                <button aria-controls="panel-0-MkQgR0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-MkQgR0RTY3JpcHQ=" name="MkQgR0RTY3JpcHQ=" role="tab" tabindex="0">2D GDScript</button>
                <button aria-controls="panel-0-M0QgR0RTY3JpcHQ=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-M0QgR0RTY3JpcHQ=" name="M0QgR0RTY3JpcHQ=" role="tab" tabindex="-1">3D GDScript</button>
            </div>
            <div aria-labelledby="tab-0-MkQgR0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-0-MkQgR0RTY3JpcHQ=" name="MkQgR0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve"># Prepare query objects.
var query_parameters := NavigationPathQueryParameters2D.new()
var query_result := NavigationPathQueryResult2D.new()

func query_path(p_start_position: Vector2, p_target_position: Vector2, p_navigation_layers: int = 1) -&gt; PackedVector2Array:
    if not is_inside_tree():
        return PackedVector2Array()

    query_parameters.map = get_world_2d().get_navigation_map()
    query_parameters.start_position = p_start_position
    query_parameters.target_position = p_target_position
    query_parameters.navigation_layers = p_navigation_layers

    NavigationServer2D.query_path(query_parameters, query_result)
    var path: PackedVector2Array = query_result.get_path()

    return path</literal_block>
            </div>
            <div aria-labelledby="tab-0-M0QgR0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-0-M0QgR0RTY3JpcHQ=" name="M0QgR0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve"># Prepare query objects.
var query_parameters := NavigationPathQueryParameters3D.new()
var query_result := NavigationPathQueryResult3D.new()

func query_path(p_start_position: Vector3, p_target_position: Vector3, p_navigation_layers: int = 1) -&gt; PackedVector3Array:
    if not is_inside_tree():
        return PackedVector3Array()

    query_parameters.map = get_world_3d().get_navigation_map()
    query_parameters.start_position = p_start_position
    query_parameters.target_position = p_target_position
    query_parameters.navigation_layers = p_navigation_layers

    NavigationServer3D.query_path(query_parameters, query_result)
    var path: PackedVector3Array = query_result.get_path()

    return path</literal_block>
            </div>
        </container>
        <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/zh_CN/?utm_source=widget"><image alt="翻译状态" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/zh_CN/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/zh_CN/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
    </section>
</document>
