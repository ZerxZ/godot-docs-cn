<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/shaders/shaders_style_guide.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-shaders-style-guide"></target>
    <section ids="shaders-style-guide doc-shaders-style-guide" names="shaders\ style\ guide doc_shaders_style_guide">
        <title>Shaders style guide</title>
        <paragraph>This style guide lists conventions to write elegant shaders. The goal is to
            encourage writing clean, readable code and promote consistency across projects,
            discussions, and tutorials. Hopefully, this will also support the development of
            auto-formatting tools.</paragraph>
        <paragraph>Since the Godot shader language is close to C-style languages and GLSL, this
            guide is inspired by Godot's own GLSL formatting. You can view examples of
            GLSL files in Godot's source code
            <reference name="here" refuri="https://github.com/godotengine/godot/blob/master/drivers/gles3/shaders/">here</reference>.</paragraph>
        <paragraph>Style guides aren't meant as hard rulebooks. At times, you may not be able to
            apply some of the guidelines below. When that happens, use your best judgment,
            and ask fellow developers for insights.</paragraph>
        <paragraph>In general, keeping your code consistent in your projects and within your team is
            more important than following this guide to a tee.</paragraph>
        <note>
            <paragraph>Godot's built-in shader editor uses a lot of these conventions
                by default. Let it help you.</paragraph>
        </note>
        <paragraph>Here is a complete shader example based on these guidelines:</paragraph>
        <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">shader_type canvas_item;
// Screen-space shader to adjust a 2D scene's brightness, contrast
// and saturation. Taken from
// https://github.com/godotengine/godot-demo-projects/blob/master/2d/screen_space_shaders/shaders/BCS.gdshader

uniform sampler2D screen_texture : hint_screen_texture, filter_linear_mipmap;
uniform float brightness = 0.8;
uniform float contrast = 1.5;
uniform float saturation = 1.8;

void fragment() {
    vec3 c = textureLod(screen_texture, SCREEN_UV, 0.0).rgb;

    c.rgb = mix(vec3(0.0), c.rgb, brightness);
    c.rgb = mix(vec3(0.5), c.rgb, contrast);
    c.rgb = mix(vec3(dot(vec3(1.0), c.rgb) * 0.33333), c.rgb, saturation);

    COLOR.rgb = c;
}</literal_block>
        <section ids="formatting" names="formatting">
            <title>Formatting</title>
            <section ids="encoding-and-special-characters" names="encoding\ and\ special\ characters">
                <title>Encoding and special characters</title>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Use line feed (<strong>LF</strong>) characters to break lines, not CRLF or CR. <emphasis>(editor default)</emphasis></paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Use one line feed character at the end of each file. <emphasis>(editor default)</emphasis></paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Use <strong>UTF-8</strong> encoding without a <reference name="byte order mark" refuri="https://en.wikipedia.org/wiki/Byte_order_mark">byte order mark</reference><target ids="byte-order-mark" names="byte\ order\ mark" refuri="https://en.wikipedia.org/wiki/Byte_order_mark"></target>. <emphasis>(editor default)</emphasis></paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Use <strong>Tabs</strong> instead of spaces for indentation. <emphasis>(editor default)</emphasis></paragraph>
                    </list_item>
                </bullet_list>
            </section>
            <section ids="indentation" names="indentation">
                <title>Indentation</title>
                <paragraph>Each indent level should be one tab greater than the block containing it.</paragraph>
                <paragraph><strong>Good</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment() {
    COLOR = vec3(1.0, 1.0, 1.0);
}</literal_block>
                <paragraph><strong>Bad</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment() {
        COLOR = vec3(1.0, 1.0, 1.0);
}</literal_block>
                <paragraph>Use 2 indent levels to distinguish continuation lines from
                    regular code blocks.</paragraph>
                <paragraph><strong>Good</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">vec2 st = vec2(
        atan(NORMAL.x, NORMAL.z),
        acos(NORMAL.y));</literal_block>
                <paragraph><strong>Bad</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">vec2 st = vec2(
    atan(NORMAL.x, NORMAL.z),
    acos(NORMAL.y));</literal_block>
            </section>
            <section ids="line-breaks-and-blank-lines" names="line\ breaks\ and\ blank\ lines">
                <title>Line breaks and blank lines</title>
                <paragraph>For a general indentation rule, follow
                    <reference name='the "1TBS Style"' refuri="https://en.wikipedia.org/wiki/Indentation_style#Variant:_1TBS_(OTBS)">the "1TBS Style"</reference><target ids="the-1tbs-style" names='the\ "1tbs\ style"' refuri="https://en.wikipedia.org/wiki/Indentation_style#Variant:_1TBS_(OTBS)"></target>
                    which recommends placing the brace associated with a control statement on the
                    same line. Always use braces for statements, even if they only span one line.
                    This makes them easier to refactor and avoids mistakes when adding more lines to
                    an <literal>if</literal> statement or similar.</paragraph>
                <paragraph><strong>Good</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment() {
    if (true) {
        // ...
    }
}</literal_block>
                <paragraph><strong>Bad</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment()
{
    if (true)
        // ...
}</literal_block>
            </section>
            <section ids="blank-lines" names="blank\ lines">
                <title>Blank lines</title>
                <paragraph>Surround function definitions with one (and only one) blank line:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void do_something() {
    // ...
}

void fragment() {
    // ...
}</literal_block>
                <paragraph>Use one (and only one) blank line inside functions to separate logical sections.</paragraph>
            </section>
            <section ids="line-length" names="line\ length">
                <title>Line length</title>
                <paragraph>Keep individual lines of code under 100 characters.</paragraph>
                <paragraph>If you can, try to keep lines under 80 characters. This helps to read the code
                    on small displays and with two shaders opened side-by-side in an external text
                    editor. For example, when looking at a differential revision.</paragraph>
            </section>
            <section ids="one-statement-per-line" names="one\ statement\ per\ line">
                <title>One statement per line</title>
                <paragraph>Never combine multiple statements on a single line.</paragraph>
                <paragraph><strong>Good</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment() {
    ALBEDO = vec3(1.0);
    EMISSION = vec3(1.0);
}</literal_block>
                <paragraph><strong>Bad</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment() {
    ALBEDO = vec3(1.0); EMISSION = vec3(1.0);
}</literal_block>
                <paragraph>The only exception to that rule is the ternary operator:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment() {
     bool should_be_white = true;
     ALBEDO = should_be_white ? vec3(1.0) : vec3(0.0);
 }</literal_block>
            </section>
            <section ids="comment-spacing" names="comment\ spacing">
                <title>Comment spacing</title>
                <paragraph>Regular comments should start with a space, but not code that you comment out.
                    This helps differentiate text comments from disabled code.</paragraph>
                <paragraph><strong>Good</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">// This is a comment.
//return;</literal_block>
                <paragraph><strong>Bad</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">//This is a comment.
// return;</literal_block>
                <paragraph>Don't use multiline comment syntax if your comment can fit on a single line:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">/* This is another comment. */</literal_block>
                <note>
                    <paragraph>In the shader editor, to make the selected code a comment (or uncomment it),
                        press <literal classes="kbd">Ctrl + K</literal>. This feature adds or removes <literal>//</literal> at the start of
                        the selected lines.</paragraph>
                </note>
            </section>
            <section ids="documentation-comments" names="documentation\ comments">
                <title>Documentation comments</title>
                <paragraph>Use the following format for documentation comments above uniforms, with <strong>two</strong>
                    leading asterisks (<literal>/**</literal>) and follow-up asterisks on every line:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">/**
 * This is a documentation comment.
 * These lines will appear in the inspector when hovering the shader parameter
 * named "Something".
 * You can use [b]BBCode[/b] [i]formatting[/i] in the comment.
 */
uniform int something = 1;</literal_block>
                <paragraph>These comments will appear when hovering a property in the inspector. If you
                    don't wish the comment to be visible in the inspector, use the standard comment
                    syntax instead (<literal>// ...</literal> or <literal>/* ... */</literal> with only one leading asterisk).</paragraph>
            </section>
            <section ids="whitespace" names="whitespace">
                <title>Whitespace</title>
                <paragraph>Always use one space around operators and after commas. Also, avoid extraneous spaces
                    in function calls.</paragraph>
                <paragraph><strong>Good</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">COLOR.r = 5.0;
COLOR.r = COLOR.g + 0.1;
COLOR.b = some_function(1.0, 2.0);</literal_block>
                <paragraph><strong>Bad</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">COLOR.r=5.0;
COLOR.r = COLOR.g+0.1;
COLOR.b = some_function (1.0,2.0);</literal_block>
                <paragraph>Don't use spaces to align expressions vertically:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">ALBEDO.r   = 1.0;
EMISSION.r = 1.0;</literal_block>
            </section>
            <section ids="floating-point-numbers" names="floating-point\ numbers">
                <title>Floating-point numbers</title>
                <paragraph>Always specify at least one digit for both the integer and fractional part. This
                    makes it easier to distinguish floating-point numbers from integers, as well as
                    distinguishing numbers greater than 1 from those lower than 1.</paragraph>
                <paragraph><strong>Good</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment() {
    ALBEDO.rgb = vec3(5.0, 0.1, 0.2);
}</literal_block>
                <paragraph><strong>Bad</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void fragment() {
    ALBEDO.rgb = vec3(5., .1, .2);
}</literal_block>
            </section>
        </section>
        <section ids="accessing-vector-members" names="accessing\ vector\ members">
            <title>Accessing vector members</title>
            <paragraph>Use <literal>r</literal>, <literal>g</literal>, <literal>b</literal>, and <literal>a</literal> when accessing a vector's members if it
                contains a color. If the vector contains anything else than a color, use <literal>x</literal>,
                <literal>y</literal>, <literal>z</literal>, and <literal>w</literal>. This allows those reading your code to better
                understand what the underlying data represents.</paragraph>
            <paragraph><strong>Good</strong>:</paragraph>
            <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">COLOR.rgb = vec3(5.0, 0.1, 0.2);</literal_block>
            <paragraph><strong>Bad</strong>:</paragraph>
            <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">COLOR.xyz = vec3(5.0, 0.1, 0.2);</literal_block>
        </section>
        <section ids="naming-conventions" names="naming\ conventions">
            <title>Naming conventions</title>
            <paragraph>These naming conventions follow the Godot Engine style. Breaking these will make
                your code clash with the built-in naming conventions, leading to inconsistent
                code.</paragraph>
            <section ids="functions-and-variables" names="functions\ and\ variables">
                <title>Functions and variables</title>
                <paragraph>Use snake_case to name functions and variables:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">void some_function() {
     float some_variable = 0.5;
}</literal_block>
            </section>
            <section ids="constants" names="constants">
                <title>Constants</title>
                <paragraph>Write constants with CONSTANT_CASE, that is to say in all caps with an
                    underscore (_) to separate words:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">const float GOLDEN_RATIO = 1.618;</literal_block>
            </section>
            <section ids="preprocessor-directives" names="preprocessor\ directives">
                <title>Preprocessor directives</title>
                <paragraph><reference internal="True" refuri="shader_reference/shader_preprocessor#doc-shader-preprocessor"><inline classes="std std-ref">Shader preprocessor</inline></reference> directives should be written in CONSTANT__CASE.
                    Directives should be written without any indentation before them, even if
                    nested within a function.</paragraph>
                <paragraph>To preserve the natural flow of indentation when shader errors are printed to
                    the console, extra indentation should <strong>not</strong> be added within <literal>#if</literal>,
                    <literal>#ifdef</literal> or <literal>#ifndef</literal> blocks:</paragraph>
                <paragraph><strong>Good</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">#define HEIGHTMAP_ENABLED

void fragment() {
    vec2 position = vec2(1.0, 2.0);

#ifdef HEIGHTMAP_ENABLED
    sample_heightmap(position);
#endif
}</literal_block>
                <paragraph><strong>Bad</strong>:</paragraph>
                <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">#define heightmap_enabled

void fragment() {
    vec2 position = vec2(1.0, 2.0);

    #ifdef heightmap_enabled
        sample_heightmap(position);
    #endif
}</literal_block>
            </section>
        </section>
        <section ids="applying-formatting-automatically" names="applying\ formatting\ automatically">
            <title>Applying formatting automatically</title>
            <paragraph>To automatically format shader files, you can use
                <reference name="clang-format" refuri="https://clang.llvm.org/docs/ClangFormat.html">clang-format</reference> on one or several
                <literal>.gdshader</literal> files, as the syntax is close enough to a C-style language.</paragraph>
            <paragraph>However, the default style in clang-format doesn't follow this style guide,
                so you need to save this file as <literal>.clang-format</literal> in your project's root folder:</paragraph>
            <literal_block force="False" highlight_args="{}" language="yaml" linenos="False" xml:space="preserve">BasedOnStyle: LLVM
AlignAfterOpenBracket: DontAlign
AlignOperands: DontAlign
AlignTrailingComments:
Kind: Never
OverEmptyLines: 0
AllowAllParametersOfDeclarationOnNextLine: false
AllowShortFunctionsOnASingleLine: Inline
BreakConstructorInitializers: AfterColon
ColumnLimit: 0
ContinuationIndentWidth: 8
IndentCaseLabels: true
IndentWidth: 4
InsertBraces: true
KeepEmptyLinesAtTheStartOfBlocks: false
RemoveSemicolon: true
SpacesInLineCommentPrefix:
Minimum: 0 # We want a minimum of 1 for comments, but allow 0 for disabled code.
Maximum: -1
TabWidth: 4
UseTab: Always</literal_block>
            <paragraph>While in the project root, you can then call <literal>clang-format -i path/to/shader.gdshader</literal>
                in a terminal to format a single shader file, or <literal>clang-format -i path/to/folder/*.gdshader</literal>
                to format all shaders in a folder.</paragraph>
        </section>
        <section ids="code-order" names="code\ order">
            <title>Code order</title>
            <paragraph>We suggest to organize shader code this way:</paragraph>
            <literal_block force="False" highlight_args="{}" language="glsl" linenos="False" xml:space="preserve">01. shader type declaration
02. render mode declaration
03. // docstring

04. uniforms
05. constants
06. varyings

07. other functions
08. vertex() function
09. fragment() function
10. light() function</literal_block>
            <paragraph>We optimized the order to make it easy to read the code from top to bottom, to
                help developers reading the code for the first time understand how it works, and
                to avoid errors linked to the order of variable declarations.</paragraph>
            <paragraph>This code order follows two rules of thumb:</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Metadata and properties first, followed by methods.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>"Public" comes before "private". In a shader language's context, "public"
                        refers to what's easily adjustable by the user (uniforms).</paragraph>
                </list_item>
            </enumerated_list>
            <section ids="local-variables" names="local\ variables">
                <title>Local variables</title>
                <paragraph>Declare local variables as close as possible to their first use. This makes it
                    easier to follow the code, without having to scroll too much to find where the
                    variable was declared.</paragraph>
                <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
            </section>
        </section>
    </section>
</document>
