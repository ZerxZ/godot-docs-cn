<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/inputs/handling_quit_requests.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-handling-quit-requests"></target>
    <section ids="handling-quit-requests doc-handling-quit-requests" names="handling\ quit\ requests doc_handling_quit_requests">
        <title>Handling quit requests</title>
        <section ids="quitting" names="quitting">
            <title>Quitting</title>
            <paragraph>Most platforms have the option to request the application to quit. On
                desktops, this is usually done with the "x" icon on the window title bar.
                On mobile devices, the app can quit at any time while it is suspended
                to the background.</paragraph>
        </section>
        <section ids="handling-the-notification" names="handling\ the\ notification">
            <title>Handling the notification</title>
            <paragraph>On desktop and web platforms, <reference internal="True" refuri="../../classes/class_node#class-node"><inline classes="std std-ref">Node</inline></reference> receives a special
                <literal>NOTIFICATION_WM_CLOSE_REQUEST</literal> notification when quitting is requested from
                the window manager.</paragraph>
            <paragraph>Handling the notification is done as follows (on any node):</paragraph>
            <container classes="sphinx-tabs" type="tab-element">
                <div aria-label="Tabbed content" role="tablist">
                    <button aria-controls="panel-0-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                    <button aria-controls="panel-0-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
                </div>
                <div aria-labelledby="tab-0-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">func _notification(what):
    if what == NOTIFICATION_WM_CLOSE_REQUEST:
        get_tree().quit() # default behavior</literal_block>
                </div>
                <div aria-labelledby="tab-0-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-0-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">public override void _Notification(int what)
{
    if (what == NotificationWMCloseRequest)
    {
        GetTree().Quit(); // default behavior
    }
}</literal_block>
                </div>
            </container>
            <paragraph>It is important to note that by default, Godot apps have the built-in
                behavior to quit when quit is requested from the window manager. This
                can be changed, so that the user can take care of the complete quitting
                procedure:</paragraph>
            <container classes="sphinx-tabs" type="tab-element">
                <div aria-label="Tabbed content" role="tablist">
                    <button aria-controls="panel-1-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-1-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                    <button aria-controls="panel-1-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-1-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
                </div>
                <div aria-labelledby="tab-1-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-1-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">get_tree().set_auto_accept_quit(false)</literal_block>
                </div>
                <div aria-labelledby="tab-1-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-1-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">GetTree().AutoAcceptQuit = false;</literal_block>
                </div>
            </container>
        </section>
        <section ids="on-mobile-devices" names="on\ mobile\ devices">
            <title>On mobile devices</title>
            <paragraph>There is no direct equivalent to <literal>NOTIFICATION_WM_CLOSE_REQUEST</literal> on mobile
                platforms. Due to the nature of mobile operating systems, the only place
                that you can run code prior to quitting is when the app is being suspended to
                the background. On both Android and iOS, the app can be killed while suspended
                at any time by either the user or the OS. A way to plan ahead for this
                possibility is to utilize <literal>NOTIFICATION_APPLICATION_PAUSED</literal> in order to
                perform any needed actions as the app is being suspended.</paragraph>
            <note>
                <paragraph>On iOS, you only have approximately 5 seconds to finish a task started by this signal. If you go over this allotment, iOS will kill the app instead of pausing it.</paragraph>
            </note>
            <paragraph>On Android, pressing the Back button will exit the application if
                <strong>Application &gt; Config &gt; Quit On Go Back</strong> is checked in the Project Settings
                (which is the default). This will fire <literal>NOTIFICATION_WM_GO_BACK_REQUEST</literal>.</paragraph>
        </section>
        <section ids="sending-your-own-quit-notification" names="sending\ your\ own\ quit\ notification">
            <title>Sending your own quit notification</title>
            <paragraph>While forcing the application to close can be done by calling
                <reference internal="True" refuri="../../classes/class_scenetree#class-scenetree-method-quit"><inline classes="std std-ref">SceneTree.quit</inline></reference>, doing so will not send
                the <literal>NOTIFICATION_WM_CLOSE_REQUEST</literal> to the nodes in the scene tree.
                Quitting by calling <reference internal="True" refuri="../../classes/class_scenetree#class-scenetree-method-quit"><inline classes="std std-ref">SceneTree.quit</inline></reference> will
                not allow custom actions to complete (such as saving, confirming the quit,
                or debugging), even if you try to delay the line that forces the quit.</paragraph>
            <paragraph>Instead, if you want to notify the nodes in the scene tree about the upcoming
                program termination, you should send the notification yourself:</paragraph>
            <container classes="sphinx-tabs" type="tab-element">
                <div aria-label="Tabbed content" role="tablist">
                    <button aria-controls="panel-2-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                    <button aria-controls="panel-2-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
                </div>
                <div aria-labelledby="tab-2-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-2-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">get_tree().root.propagate_notification(NOTIFICATION_WM_CLOSE_REQUEST)</literal_block>
                </div>
                <div aria-labelledby="tab-2-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">GetTree().Root.PropagateNotification((int)NotificationWMCloseRequest);</literal_block>
                </div>
            </container>
            <paragraph>Sending this notification will inform all nodes about the program termination,
                but will not terminate the program itself <emphasis>unlike in 3.X</emphasis>. In order to achieve
                the previous behavior, <reference internal="True" refuri="../../classes/class_scenetree#class-scenetree-method-quit"><inline classes="std std-ref">SceneTree.quit</inline></reference> should
                be called after the notification.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
