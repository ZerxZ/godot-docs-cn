<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/3d/using_gridmaps.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-using-gridmaps"></target>
    <section ids="using-gridmaps doc-using-gridmaps" names="using\ gridmaps doc_using_gridmaps">
        <title>Using GridMaps</title>
        <section ids="introduction" names="introduction">
            <title>Introduction</title>
            <paragraph><reference internal="True" refuri="../../classes/class_gridmap#class-gridmap"><inline classes="std std-ref">Gridmaps</inline></reference> are a tool for creating 3D
                game levels, similar to the way <reference internal="True" refuri="../2d/using_tilemaps#doc-using-tilemaps"><inline classes="std std-ref">TileMap</inline></reference>
                works in 2D. You start with a predefined collection of 3D meshes (a
                <reference internal="True" refuri="../../classes/class_meshlibrary#class-meshlibrary"><inline classes="std std-ref">MeshLibrary</inline></reference>) that can be placed on a grid,
                as if you were building a level with an unlimited amount of Lego blocks.</paragraph>
            <paragraph>Collisions and navigation can also be added to the meshes, just like you
                would do with the tiles of a tilemap.</paragraph>
        </section>
        <section ids="example-project" names="example\ project">
            <title>Example project</title>
            <paragraph>To learn how GridMaps work, start by downloading the sample project:
                <reference name="gridmap_starter.zip" refuri="https://github.com/godotengine/godot-docs-project-starters/releases/download/latest-4.x/gridmap_starter.zip">gridmap_starter.zip</reference><target ids="gridmap-starter-zip" names="gridmap_starter.zip" refuri="https://github.com/godotengine/godot-docs-project-starters/releases/download/latest-4.x/gridmap_starter.zip"></target>.</paragraph>
            <paragraph>Unzip this project and add it to the Project Manager using the "Import"
                button. You may get a popup saying that it needs to be converted to a newer Godot
                version, click <strong>Convert project.godot</strong>.</paragraph>
        </section>
        <section ids="creating-a-meshlibrary" names="creating\ a\ meshlibrary">
            <title>Creating a MeshLibrary</title>
            <paragraph>To begin, you need a <reference internal="True" refuri="../../classes/class_meshlibrary#class-meshlibrary"><inline classes="std std-ref">MeshLibrary</inline></reference>, which is a collection
                of individual meshes that can be used in the gridmap. Open the "mesh_library_source.tscn"
                scene to see an example of how to set up the mesh library.</paragraph>
            <image candidates="{'*': 'tutorials/3d/img/gridmap_meshlibrary1.webp'}" original_uri="img/gridmap_meshlibrary1.webp" uri="tutorials/3d/img/gridmap_meshlibrary1.webp"></image>
            <paragraph>As you can see, this scene has a <reference internal="True" refuri="../../classes/class_node3d#class-node3d"><inline classes="std std-ref">Node3D</inline></reference> node as its root, and
                a number of <reference internal="True" refuri="../../classes/class_meshinstance3d#class-meshinstance3d"><inline classes="std std-ref">MeshInstance3D</inline></reference> node children.</paragraph>
            <paragraph>If you don't need any physics in your scene, then you're done. However, in most
                cases you'll want to assign collision bodies to the meshes.</paragraph>
        </section>
        <section ids="collisions" names="collisions">
            <title>Collisions</title>
            <paragraph>You can manually assign a <reference internal="True" refuri="../../classes/class_staticbody3d#class-staticbody3d"><inline classes="std std-ref">StaticBody3D</inline></reference> and
                <reference internal="True" refuri="../../classes/class_collisionshape3d#class-collisionshape3d"><inline classes="std std-ref">CollisionShape3D</inline></reference> to each mesh. Alternatively, you can use the "Mesh" menu
                to automatically create the collision body based on the mesh data.</paragraph>
            <image candidates="{'*': 'tutorials/3d/img/gridmap_create_body.webp'}" original_uri="img/gridmap_create_body.webp" uri="tutorials/3d/img/gridmap_create_body.webp"></image>
            <paragraph>Note that a "Convex" collision body will work better for simple meshes. For more
                complex shapes, select "Create Trimesh Static Body". Once each mesh has
                a physics body and collision shape assigned, your mesh library is ready to
                be used.</paragraph>
            <image candidates="{'*': 'tutorials/3d/img/gridmap_mesh_scene.webp'}" original_uri="img/gridmap_mesh_scene.webp" uri="tutorials/3d/img/gridmap_mesh_scene.webp"></image>
        </section>
        <section ids="materials" names="materials">
            <title>Materials</title>
            <paragraph>Only the materials from within the meshes are used when generating the mesh
                library. Materials set on the node will be ignored.</paragraph>
        </section>
        <section ids="navigationmeshes" names="navigationmeshes">
            <title>NavigationMeshes</title>
            <paragraph>Like all mesh instances, MeshLibrary items can be assigned a <reference internal="True" refuri="../../classes/class_navigationmesh#class-navigationmesh"><inline classes="std std-ref">NavigationMesh</inline></reference>
                resource, which can be created manually, or baked as described below.</paragraph>
            <paragraph>To create the NavigationMesh from a MeshLibrary scene export, place a
                <reference internal="True" refuri="../../classes/class_navigationregion3d#class-navigationregion3d"><inline classes="std std-ref">NavigationRegion3D</inline></reference> child node below the main MeshInstance3D for the GridMap
                item. Add a valid NavigationMesh resource to the NavigationRegion3D and some source
                geometry nodes below and bake the NavigationMesh.</paragraph>
            <note>
                <paragraph>With small grid cells it is often necessary to reduce the NavigationMesh properties
                    for agent radius and region minimum size.</paragraph>
            </note>
            <image candidates="{'*': 'tutorials/3d/img/meshlibrary_scene.png'}" original_uri="img/meshlibrary_scene.png" uri="tutorials/3d/img/meshlibrary_scene.png"></image>
            <paragraph>Nodes below the NavigationRegion3D are ignored for the MeshLibrary scene export, so
                additional nodes can be added as source geometry just for baking the navmesh.</paragraph>
            <warning>
                <paragraph>The baked cell size of the NavigationMesh must match the NavigationServer map cell
                    size to properly merge the navigation meshes of different grid cells.</paragraph>
            </warning>
        </section>
        <section ids="lightmaps" names="lightmaps">
            <title>Lightmaps</title>
            <paragraph>It is possible to bake lightmaps onto a GridMap. Lightmap UV2 data will be reused
                from meshes if already present. If UV2 data is not present, then it will be
                automatically generated on bake with a lightmap texel size of 0.1 units.
                To generate UV2 data with a different lightmap texel size, you can set the
                global illumination mode in the Import dock to <strong>Static Lightmaps</strong>
                and specify the texel size there. This option must be changed <emphasis>before</emphasis> the scene
                is converted to a MeshLibrary, as changing it later on will not affect
                the existing MeshLibrary data.</paragraph>
            <paragraph>Aside from this peculiarity, the lightmap baking process is the same as for any other 3D scene.
                See <reference internal="True" refuri="global_illumination/using_lightmap_gi#doc-using-lightmap-gi"><inline classes="std std-ref">Using Lightmap global illumination</inline></reference> for more information about lightmap baking.</paragraph>
        </section>
        <section ids="meshlibrary-format" names="meshlibrary\ format">
            <title>MeshLibrary format</title>
            <paragraph>To summarize the specific constraints of the MeshLibrary format, a MeshLibrary
                scene has a Node3D as the root node, and several child nodes which will become
                MeshLibrary items. Each child of the root node should:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Be a <reference internal="True" refuri="../../classes/class_meshinstance3d#class-meshinstance3d"><inline classes="std std-ref">MeshInstance3D</inline></reference>, which will become the MeshLibrary item. Only
                        this visual mesh will be exported.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Have a material, in the mesh's material slot, <emphasis>not</emphasis> the MeshInstance3D's
                        material slots.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Have up to one <reference internal="True" refuri="../../classes/class_staticbody3d#class-staticbody3d"><inline classes="std std-ref">StaticBody3D</inline></reference> child, for collision. The
                        StaticBody3D should have one or more <reference internal="True" refuri="../../classes/class_collisionshape3d#class-collisionshape3d"><inline classes="std std-ref">CollisionShape3D</inline></reference> children.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Have up to one <reference internal="True" refuri="../../classes/class_navigationregion3d#class-navigationregion3d"><inline classes="std std-ref">NavigationRegion3D</inline></reference> child, for navigation. The
                        NavigationRegion3D can have one or more additional <reference internal="True" refuri="../../classes/class_meshinstance3d#class-meshinstance3d"><inline classes="std std-ref">MeshInstance3D</inline></reference>
                        children, which can be baked for navigation, but won't be exported as a visual
                        mesh.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>Only this specific format is recognized. Other node types placed as children
                will not be recognized and exported. GridMap is not a general-purpose system for
                placing <emphasis>nodes</emphasis> on a grid, but rather a specific, optimized system, designed to
                place <emphasis>meshes</emphasis> with collisions and navigation.</paragraph>
        </section>
        <section ids="exporting-the-meshlibrary" names="exporting\ the\ meshlibrary">
            <title>Exporting the MeshLibrary</title>
            <paragraph>To export the library, click on <strong>Scene &gt; Export As... &gt; MeshLibrary...</strong>, and save it
                as a resource.</paragraph>
            <image candidates="{'*': 'tutorials/3d/img/gridmap_export.webp'}" original_uri="img/gridmap_export.webp" uri="tutorials/3d/img/gridmap_export.webp"></image>
            <paragraph>You can find an already exported MeshLibrary in the project named <literal>MeshLibrary.tres</literal>.</paragraph>
        </section>
        <section ids="using-gridmap" names="using\ gridmap">
            <title>Using GridMap</title>
            <paragraph>Create a new scene and add a GridMap node. Add the mesh library by dragging
                the resource file from the FileSystem dock and dropping it in the <strong>Mesh Library</strong>
                property in the Inspector.</paragraph>
            <image candidates="{'*': 'tutorials/3d/img/gridmap_mesh_library_inspector.webp'}" original_uri="img/gridmap_mesh_library_inspector.webp" uri="tutorials/3d/img/gridmap_mesh_library_inspector.webp"></image>
            <section ids="inspector-properties" names="inspector\ properties">
                <title>Inspector properties</title>
                <paragraph>The <strong>Physics Material</strong> setting allows you to override the physics material for
                    every mesh in the NavigationMesh.</paragraph>
                <paragraph>Under <strong>Cells</strong>, the <strong>Size</strong> property should be set to the size of your meshes. You
                    can leave it at the default value for the demo. Uncheck the <strong>Center Y</strong> property.</paragraph>
                <paragraph>The <strong>Collision</strong> options allow you to set the collision layer, collision mask, and
                    priority for the entire grid. For more information on how those work see the
                    <reference internal="True" refuri="../physics/index#doc-physics-index"><inline classes="std std-ref">Physics</inline></reference> section.</paragraph>
                <paragraph>Under <strong>Navigation</strong> is the "Bake Navigation" option. If enabled it creates a
                    navigation region for each cell that uses a mesh library item with a navigation
                    mesh.</paragraph>
                <paragraph>If you click on the MeshLibrary itself in the inspector you can adjust settings for
                    individual meshes, such as their navigation mesh, navigation layers, or if the mesh
                    casts shadows.</paragraph>
                <image candidates="{'*': 'tutorials/3d/img/gridmap_mesh_library_settings.webp'}" original_uri="img/gridmap_mesh_library_settings.webp" uri="tutorials/3d/img/gridmap_mesh_library_settings.webp"></image>
            </section>
            <section ids="gridmap-panel" names="gridmap\ panel">
                <title>GridMap panel</title>
                <paragraph>At the bottom of the editor is the GridMap panel, which should have opened
                    automatically when you added the GridMap node.</paragraph>
                <image candidates="{'*': 'tutorials/3d/img/gridmap_panel.webp'}" original_uri="img/gridmap_panel.webp" uri="tutorials/3d/img/gridmap_panel.webp"></image>
                <paragraph>From left to right in the toolbar:</paragraph>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph><strong>Transform</strong>: Adds a gizmo to the scene that allows you to change the
                            relative position and rotation of the gridmap in the scene.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Selection</strong>: While active you can select an area in the viewport, click and drag
                            to select more than one space on the grid.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Erase</strong>: While active, click in the viewport and delete meshes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Paint</strong>: While active, click in the viewport and add whatever mesh is currently
                            selected in the GridMap panel to the scene.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Pick</strong>: While active, clicking on a gridmap mesh in the viewport will cause
                            it to be selected in the GridMap panel.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Fill</strong>: Fill the area that has been selected in the viewport with whatever mesh
                            is selected in the GridMap bottom panel.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Move</strong>: Move whatever mesh or meshes are currently selected in the viewport.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Duplicate</strong>: Create a copy of whatever the selected mesh or meshes in the
                            GridMap are.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Delete</strong>: Similar to erase, but for the entire selected area.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Cursor Rotate X</strong>: While the paint tool is selected, this will rotate the mesh
                            that will be painted on the X-axis. This will also rotate selected areas if they
                            are being moved.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Cursor Rotate Y</strong>: While the paint tool is selected, this will rotate the mesh
                            that will be painted on the Y-axis. This will also rotate selected areas if they
                            are being moved.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Cursor Rotate Z</strong>: While the paint tool is selected, this will rotate the mesh
                            that will be painted on the Z-axis. This will also rotate selected areas if they
                            are being moved.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Change Grid Floor</strong>: Adjusts what floor is currently being worked on, can be
                            changed with the arrows or typing</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Filter Meshes</strong>: Used to search for a specific mesh in the bottom panel.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Zoom</strong>: Controls the zoom level on meshes in the bottom panel.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Layout toggles</strong>: These two buttons toggle between different layouts for meshes
                            in the bottom panel.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>Tools dropdown</strong>: This button opens a dropdown menu with a few more options.</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'tutorials/3d/img/gridmap_dropdown.webp'}" original_uri="img/gridmap_dropdown.webp" uri="tutorials/3d/img/gridmap_dropdown.webp"></image>
                <paragraph>Clicking on <strong>Settings</strong> in that dropdown brings up a window that allows you to
                    change the <strong>Pick Distance</strong>, which is the maximum distance at which tiles can be placed
                    on a GridMap, relative to the camera position (in meters).</paragraph>
            </section>
        </section>
        <section ids="using-gridmap-in-code" names="using\ gridmap\ in\ code">
            <title>Using GridMap in code</title>
            <paragraph>See <reference internal="True" refuri="../../classes/class_gridmap#class-gridmap"><inline classes="std std-ref">GridMap</inline></reference> for details on the node's methods and member variables.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
