<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/3d/global_illumination/reflection_probes.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-reflection-probes"></target>
    <section ids="reflection-probes doc-reflection-probes" names="reflection\ probes doc_reflection_probes">
        <title>Reflection probes</title>
        <paragraph>As stated in the <reference internal="True" refuri="../standard_material_3d#doc-standard-material-3d"><inline classes="std std-ref">Standard Material 3D and ORM Material 3D</inline></reference>, objects can show reflected and/or
            diffuse light. Reflection probes are used as a source of reflected <emphasis>and</emphasis> ambient
            light for objects inside their area of influence. They can be used to provide
            more accurate reflections than <reference internal="True" refuri="using_voxel_gi#doc-using-voxel-gi"><inline classes="std std-ref">VoxelGI</inline></reference> and
            <reference internal="True" refuri="using_sdfgi#doc-using-sdfgi"><inline classes="std std-ref">SDFGI</inline></reference> while being fairly cheap on system resources.</paragraph>
        <paragraph>Since reflection probes can also store ambient light, they can be used as a
            low-end alternative to VoxelGI and SDFGI when <reference internal="True" refuri="using_lightmap_gi#doc-using-lightmap-gi"><inline classes="std std-ref">baked lightmaps</inline></reference> aren't viable (e.g. in procedurally generated levels).</paragraph>
        <paragraph>Reflection probes can also be used at the same time as screen-space reflections
            to provide reflections for off-screen objects. In this case, Godot will blend
            together the screen-space reflections and reflections from reflection probes.</paragraph>
        <seealso>
            <paragraph>Not sure if ReflectionProbe is suited to your needs?
                See <reference internal="True" refuri="introduction_to_global_illumination#doc-introduction-to-global-illumination-comparison"><inline classes="std std-ref">Which global illumination technique should I use?</inline></reference>
                for a comparison of GI techniques available in Godot 4.</paragraph>
        </seealso>
        <section ids="visual-comparison" names="visual\ comparison">
            <title>Visual comparison</title>
            <figure align="center" ids="id1">
                <image alt="Reflection probe disabled. Environment sky is used as a fallback." candidates="{'*': 'tutorials/3d/global_illumination/img/gi_none.webp'}" original_uri="img/gi_none.webp" uri="tutorials/3d/global_illumination/img/gi_none.webp"></image>
                <caption>Reflection probe disabled. Environment sky is used as a fallback.</caption>
            </figure>
            <figure align="center" ids="id2">
                <image alt="Reflection probe enabled." candidates="{'*': 'tutorials/3d/global_illumination/img/gi_none_reflection_probe.webp'}" original_uri="img/gi_none_reflection_probe.webp" uri="tutorials/3d/global_illumination/img/gi_none_reflection_probe.webp"></image>
                <caption>Reflection probe enabled.</caption>
            </figure>
            <figure align="center" ids="id3">
                <image alt="Reflection probe enabled." candidates="{'*': 'tutorials/3d/global_illumination/img/gi_lightmap_gi_indirect_only_reflection_probe.webp'}" original_uri="img/gi_lightmap_gi_indirect_only_reflection_probe.webp" uri="tutorials/3d/global_illumination/img/gi_lightmap_gi_indirect_only_reflection_probe.webp"></image>
                <caption>Reflection probe enabled with LightmapGI used at the same time. The lightmap appears in the reflection.</caption>
            </figure>
            <paragraph>By combining reflection probes with screen-space reflections, you can get the
                best of both worlds: high-quality reflections for general room structure (that
                remain present when off-screen), while also having real-time reflections for
                small details.</paragraph>
            <figure align="center" ids="id4">
                <image alt="Reflections in a room using ReflectionProbe only." candidates="{'*': 'tutorials/3d/global_illumination/img/reflection_probes_reflection_probe.webp'}" original_uri="img/reflection_probes_reflection_probe.webp" uri="tutorials/3d/global_illumination/img/reflection_probes_reflection_probe.webp"></image>
                <caption>Reflections in a room using ReflectionProbe only. Notice how small details
                    don't have any reflections.</caption>
            </figure>
            <figure align="center" ids="id5">
                <image alt="Reflections in a room using screen-space reflections only." candidates="{'*': 'tutorials/3d/global_illumination/img/reflection_probes_ssr.webp'}" original_uri="img/reflection_probes_ssr.webp" uri="tutorials/3d/global_illumination/img/reflection_probes_ssr.webp"></image>
                <caption>Reflections in a room using screen-space reflections only. Notice how the
                    reflection on the sides of the room's walls is partly missing due to being
                    off-screen.</caption>
            </figure>
            <figure align="center" ids="id6">
                <image alt="Reflections in a room using ReflectionProbe and screen-space reflections together." candidates="{'*': 'tutorials/3d/global_illumination/img/reflection_probes_reflection_probe_ssr.webp'}" original_uri="img/reflection_probes_reflection_probe_ssr.webp" uri="tutorials/3d/global_illumination/img/reflection_probes_reflection_probe_ssr.webp"></image>
                <caption>Reflections in a room using ReflectionProbe and screen-space reflections together.
                    The screen-space reflections are blended with the reflection probe,
                    acting as a fallback in situations where the reflection probe fails to display
                    any reflection.</caption>
            </figure>
        </section>
        <section ids="setting-up-a-reflectionprobe" names="setting\ up\ a\ reflectionprobe">
            <title>Setting up a ReflectionProbe</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Add a <reference internal="True" refuri="../../../classes/class_reflectionprobe#class-reflectionprobe"><inline classes="std std-ref">ReflectionProbe</inline></reference> node.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Configure the ReflectionProbe's extents in the inspector to fit your scene. To
                        get reasonably accurate reflections, you should generally have one
                        ReflectionProbe node per room (sometimes more for large rooms).</paragraph>
                </list_item>
            </bullet_list>
            <tip>
                <paragraph>Remember that ReflectionProbe extents don't have to be square, and you can
                    even rotate the ReflectionProbe node to fit rooms that aren't aligned with
                    the X/Z grid. Use this to your advantage to better cover rooms without
                    having to place too many ReflectionProbe nodes.</paragraph>
            </tip>
        </section>
        <section ids="reflectionprobe-properties" names="reflectionprobe\ properties">
            <title>ReflectionProbe properties</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><strong>Update Mode:</strong> Controls when the reflection probe updates.
                        <strong>Once</strong> only renders the scene once every time the ReflectionProbe is moved.
                        This makes it much faster to render compared to the <strong>Always</strong> update mode,
                        which forces the probe to re-render everything around it every frame.
                        Leave this property on <strong>Once</strong> (default) unless you need the reflection probe
                        to update every frame.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Intensity:</strong> The brightness of the reflections and ambient lighting. This
                        usually doesn't need to be changed from its default value of <literal>1.0</literal>, but you
                        can decrease it <literal>1.0</literal> if you find that reflections look too strong.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Max Distance:</strong> Controls the maximum distance used by the ReflectionProbe's
                        internal camera. The distance is always at least equal to the <strong>Extents</strong>, but
                        this can be increased to make objects located outside the extents visible in
                        reflections. <emphasis>This property does not affect the maximum distance at which the
                            ReflectionProbe itself is visible.</emphasis></paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Extents:</strong> The area that will be affected by the ReflectionProbe's lighting
                        and reflections.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Origin Offset:</strong> The origin to use for the internal camera used for
                        reflection probe rendering. This must always be constrained within the
                        <strong>Extents</strong>. If needed, adjust this to prevent the reflection from being
                        obstructed by a solid object located exactly at the center of the
                        ReflectionProbe.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Box Projection:</strong> Controls whether parallax correction should be used when
                        rendering the reflection probe. This adjusts the reflection's appearance
                        depending on the camera's position (relative to the reflection probe). This
                        has a small performance cost, but the quality increase is often worth it in
                        box-shaped rooms. Note that this effect doesn't work quite as well in rooms
                        with less regular shapes (such as ellipse-shaped rooms).</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Interior:</strong> If enabled, ambient lighting will not be sourced from the
                        environment sky, and the background sky won't be rendered onto the reflection
                        probe.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Enable Shadows:</strong> Controls whether real-time light shadows should be
                        rendered within the reflection probe. Enable this to improve reflection
                        quality at the cost of performance. This should be left disabled for
                        reflection probes with the <strong>Always</strong> mode, as it's very expensive to render
                        reflections with shadows every frame. Fully <reference internal="True" refuri="using_lightmap_gi#doc-using-lightmap-gi"><inline classes="std std-ref">baked light</inline></reference>
                        shadows are not affected by this setting and will be rendered in the
                        reflection probe regardless.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Cull Mask:</strong> Controls which objects are visible in the reflection. This can
                        be used to improve performance by excluding small objects from the reflection.
                        This can also be used to prevent an object from having self-reflection
                        artifacts in situations where <strong>Origin Offset</strong> can't be used.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Mesh LOD Threshold:</strong> The automatic level of detail threshold to use for
                        rendering meshes within the reflection. This only affects meshes that have
                        automatic LODs generated for them. Higher values can improve performance by
                        using less detailed geometry, especially for objects that are far away from
                        the reflection's origin. The visual difference of using less detailed objects
                        is usually not very noticeable during gameplay, especially in rough
                        reflections.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>The Ambient category features several properties to adjust ambient lighting
                rendered by the ReflectionProbe:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><strong>Mode:</strong> If set to <strong>Disabled</strong>, no ambient light is added by the probe. If
                        set to <strong>Environment</strong>, the ambient light color is automatically sampled from
                        the environment sky (if <strong>Interior</strong> is disabled) and the reflection's average
                        color. If set to <strong>Constant Color</strong>, the color specified in the <strong>Color</strong>
                        property is used instead. The <strong>Constant Color</strong> mode can be used as an
                        approximation of area lighting.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Color:</strong> The color to use when the ambient light mode is set to <strong>Constant Mode</strong>.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Color Energy:</strong> The multiplier to use for the ambient light custom
                        <strong>Color</strong>. This only has an effect when the ambient light mode is <strong>Custom
                            Color</strong>.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="reflectionprobe-blending" names="reflectionprobe\ blending">
            <title>ReflectionProbe blending</title>
            <paragraph>To make transitions between reflection sources smoother, Godot supports automatic
                probe blending:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Up to 4 ReflectionProbes can be blended together at a given location.
                        A ReflectionProbe will also fade out smoothly back to environment lighting
                        when it isn't touching any other ReflectionProbe node.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>SDFGI and VoxelGI will blend in smoothly with ReflectionProbes if used.
                        This allows placing ReflectionProbes strategically to get more accurate (or fully real-time)
                        reflections where needed, while still having rough reflections available in the
                        VoxelGI or SDFGI's area of influence.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>To make several ReflectionProbes blend with each other, you need to have part of
                each ReflectionProbe overlap each other's area. The extents should only overlap
                as little possible with other reflection probes to improve rendering performance
                (typically a few units in 3D space).</paragraph>
        </section>
        <section ids="limitations" names="limitations">
            <title>Limitations</title>
            <paragraph>When using the Forward+ renderer, Godot uses a <emphasis>clustering</emphasis> approach for
                reflection probe rendering. As many reflection probes as desired can be added (as long as
                performance allows). However, there's still a default limit of 512 <emphasis>clustered
                    elements</emphasis> that can be present in the current camera view. A clustered element is
                an omni light, a spot light, a <reference internal="True" refuri="../using_decals#doc-using-decals"><inline classes="std std-ref">decal</inline></reference> or a
                <reference internal="True" refid="doc-reflection-probes"><inline classes="std std-ref">reflection probe</inline></reference>. This limit can be increased by adjusting
                <reference internal="True" refuri="../../../classes/class_projectsettings#class-projectsettings-property-rendering-limits-cluster-builder-max-clustered-elements"><inline classes="std std-ref">Max Clustered Elements</inline></reference>
                in <strong>Project Settings &gt; Rendering &gt; Limits &gt; Cluster Builder</strong>.</paragraph>
            <paragraph>When using the Mobile renderer, only 8 reflection probes can be applied on each
                individual Mesh <emphasis>resource</emphasis>. If there are more reflection probes affecting a single mesh,
                not all of them will be rendered on the mesh.</paragraph>
            <paragraph>Similarly, when using the Compatibility renderer, up to 2 reflection probes can
                be applied per mesh. If more than 2 reflection probes affect a single mesh,
                additional probes will not be rendered.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
