<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/3d/global_illumination/using_sdfgi.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-using-sdfgi"></target>
    <section ids="signed-distance-field-global-illumination-sdfgi doc-using-sdfgi" names="signed\ distance\ field\ global\ illumination\ (sdfgi) doc_using_sdfgi">
        <title>Signed distance field global illumination (SDFGI)</title>
        <paragraph>Signed distance field global illumination (SDFGI) is a novel technique available
            in Godot. It provides semi-real-time global illumination that scales to any
            world size and works with procedurally generated levels.</paragraph>
        <paragraph>SDFGI supports dynamic lights, but <emphasis>not</emphasis> dynamic occluders or dynamic emissive surfaces.
            Therefore, SDFGI provides better real-time ability than
            <reference internal="True" refuri="using_lightmap_gi#doc-using-lightmap-gi"><inline classes="std std-ref">baked lightmaps</inline></reference>, but worse real-time ability than
            <reference internal="True" refuri="using_voxel_gi#doc-using-voxel-gi"><inline classes="std std-ref">VoxelGI</inline></reference>.</paragraph>
        <paragraph>From a performance standpoint, SDFGI is one of the most demanding global illumination
            techniques in Godot. Like with VoxelGI, there are still many settings available to tweak
            its performance requirements at the cost of quality.</paragraph>
        <important>
            <paragraph>SDFGI is only supported when using the Forward+ renderer, not the Mobile or
                Compatibility renderers.</paragraph>
        </important>
        <seealso>
            <paragraph>Not sure if SDFGI is suited to your needs?
                See <reference internal="True" refuri="introduction_to_global_illumination#doc-introduction-to-global-illumination-comparison"><inline classes="std std-ref">Which global illumination technique should I use?</inline></reference>
                for a comparison of GI techniques available in Godot 4.</paragraph>
        </seealso>
        <section ids="visual-comparison" names="visual\ comparison">
            <title>Visual comparison</title>
            <figure ids="id1">
                <image alt="SDFGI disabled." candidates="{'*': 'tutorials/3d/global_illumination/img/gi_none.webp'}" original_uri="img/gi_none.webp" uri="tutorials/3d/global_illumination/img/gi_none.webp"></image>
                <caption>SDFGI disabled.</caption>
            </figure>
            <figure ids="id2">
                <image alt="SDFGI enabled." candidates="{'*': 'tutorials/3d/global_illumination/img/gi_sdfgi.webp'}" original_uri="img/gi_sdfgi.webp" uri="tutorials/3d/global_illumination/img/gi_sdfgi.webp"></image>
                <caption>SDFGI enabled.</caption>
            </figure>
        </section>
        <section ids="setting-up-sdfgi" names="setting\ up\ sdfgi">
            <title>Setting up SDFGI</title>
            <paragraph>In Godot, SDFGI is the global illumination technique with the fewest required
                steps to enable:</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Make sure your MeshInstance nodes have their <strong>Global Illumination &gt; Mode</strong>
                        property set to <strong>Static</strong> in the inspector.</paragraph>
                </list_item>
            </enumerated_list>
            <block_quote>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>For imported 3D scenes, the bake mode can be configured in the Import dock
                            after selecting the 3D scene file in the FileSystem dock.</paragraph>
                    </list_item>
                </bullet_list>
            </block_quote>
            <enumerated_list enumtype="arabic" prefix="" start="2" suffix=".">
                <list_item>
                    <paragraph>Add a WorldEnvironment node and create an Environment resource for it.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Edit the Environment resource, scroll down to the <strong>SDFGI</strong> section and unfold it.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Enable <strong>SDFGI &gt; Enabled</strong>. SDFGI will automatically follow the camera when it
                        moves, so you do not need to configure extents (unlike VoxelGI).</paragraph>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="environment-sdfgi-properties" names="environment\ sdfgi\ properties">
            <title>Environment SDFGI properties</title>
            <paragraph>In the Environment resource, there are several properties available to adjust
                SDFGI appearance and quality:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><strong>Use Occlusion:</strong> If enabled, SDFGI will throw additional rays to find and
                        reduce light leaks. This has a performance cost, so only enable this property
                        if you actually need it.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Read Sky Light:</strong> If enabled, the environment lighting is represented in the
                        global illumination. This should be enabled in outdoor scenes and disabled in
                        fully indoor scenes.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Bounce Feedback:</strong> By default, indirect lighting only bounces once when
                        using SDFGI. Setting this value above <literal>0.0</literal> will cause SDFGI to bounce more
                        than once, which provides more realistic indirect lighting at a small
                        performance cost. Sensible values are usually between <literal>0.3</literal> and <literal>1.0</literal>
                        depending on the scene. Note that in some scenes, values above <literal>0.5</literal> can
                        cause infinite feedback loops to happen, causing the scene to become extremely
                        bright in a few seconds' time.
                        If your indirect lighting looks "splotchy", consider increasing this value above
                        <literal>0.0</literal> to get more uniform-looking lighting. If your lighting ends up looking
                        too bright as a result, decrease <strong>Energy</strong> to compensate.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Cascades:</strong> Higher values result in more detailed GI information
                        (and/or greater maximum distance), but are significantly more expensive on the
                        CPU and GPU. The performance cost of having more cascades especially increases
                        when the camera moves fast, so consider decreasing this to <literal>4</literal> or lower
                        if your camera moves fast.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Min Cell Size:</strong> The minimum SDFGI cell size to use for the nearest, most detailed
                        cascade. Lower values result in more accurate indirect lighting and reflection
                        at the cost of lower performance.
                        Adjusting this setting also affects <strong>Cascade 0 Distance</strong> and <strong>Max Distance</strong> automatically.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Cascade 0 Distance:</strong> The distance at which the nearest, most detailed
                        cascade ends. Greater values make the nearest cascade transition less noticeable,
                        at the cost of reducing the level of detail in the nearest cascade.
                        Adjusting this setting also affects <strong>Min Cell Size</strong> and <strong>Max Distance</strong> automatically.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Max Distance:</strong> Controls how far away the signed distance field will be computed
                        (for the least detailed cascade). SDFGI will not have any effect past this distance.
                        This value should always be set below the Camera's Far value, as there is no benefit
                        in computing SDFGI past the viewing distance.
                        Adjusting this setting also affects <strong>Min Cell Size</strong> and <strong>Cascade 0 Distance</strong> automatically.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Y Scale:</strong> Controls how far apart SDFGI probes are spread <emphasis>vertically</emphasis>.
                        By default, vertical spread is the same as horizontal. However, since most
                        game scenes aren't highly vertical, setting the Y Scale to
                        <literal>75%</literal> or even <literal>50%</literal> can provide better quality and reduce light leaks
                        without impacting performance.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Energy:</strong> The brightness multiplier for SDFGI's indirect lighting.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Normal Bias:</strong> The normal bias to use for SDFGI's probe ray bounces.
                        Unlike <strong>Probe Bias</strong>, this only increases the value in relation to the
                        mesh's normals. This makes the bias adjustment more nuanced and avoids
                        increasing the bias too much for no reason. Increase this
                        value if you notice striping artifacts in indirect lighting or reflections.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Probe Bias:</strong> The bias to use for SDFGI's probe ray bounces. Increase this
                        value if you notice striping artifacts in indirect lighting or reflections.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="sdfgi-interaction-with-lights-and-objects" names="sdfgi\ interaction\ with\ lights\ and\ objects">
            <title>SDFGI interaction with lights and objects</title>
            <paragraph>The amount of indirect energy emitted by a light is governed by its color,
                energy <emphasis>and</emphasis> indirect energy properties. To make a specific light emit more
                or less indirect energy without affecting the amount of direct light emitted
                by the light, adjust the <strong>Indirect Energy</strong> property in the Light3D inspector.</paragraph>
            <paragraph>To ensure correct visuals when using SDFGI, you must configure your meshes
                and lights' global illumination properties according to their <emphasis>purpose</emphasis> in the
                scene (static or dynamic).</paragraph>
            <paragraph>There are 3 global illumination modes available for meshes:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><strong>Disabled:</strong> The mesh won't be taken into account in SDFGI generation.
                        The mesh will receive indirect lighting from the scene, but it will not
                        contribute indirect lighting to the scene.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Static (default):</strong> The mesh will be taken into account in SDFGI generation.
                        The mesh will both receive <emphasis>and</emphasis> contribute indirect lighting to the scene. If
                        the mesh is changed in any way after SDFGI is generated, the camera must move
                        away from the object then move back close to it for SDFGI to regenerate.
                        Alternatively, SDFGI can be toggled off and back on. If neither is done,
                        indirect lighting will look incorrect.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Dynamic (not supported with SDFGI):</strong> The mesh won't be taken into account in SDFGI generation.
                        The mesh will receive indirect lighting from the scene, but it will not
                        contribute indirect lighting to the scene.
                        <emphasis>This acts identical to the **Disabled*</emphasis> bake mode when using SDFGI.*</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>Additionally, there are 3 bake modes available for lights
                (DirectionalLight3D, OmniLight3D and SpotLight3D):</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><strong>Disabled:</strong> The light won't be taken into account for SDFGI baking.
                        The light won't contribute indirect lighting to the scene.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Static:</strong> The light will be taken into account for SDFGI baking. The light
                        will contribute indirect lighting to the scene. If the light is changed in any
                        way after baking, indirect lighting will look incorrect until the camera moves
                        away from the light and back (which causes SDFGI to be baked again). will look
                        incorrect. If in doubt, use this mode for level lighting.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Dynamic (default):</strong> The light won't be taken into account for SDFGI baking,
                        but it will still contribute indirect lighting to the scene in real-time.
                        This option is slower compared to <strong>Static</strong>. Only use the <strong>Dynamic</strong> global
                        illumination mode on lights that will change significantly during gameplay.</paragraph>
                </list_item>
            </bullet_list>
            <note>
                <paragraph>The amount of indirect energy emitted by a light depends on its color,
                    energy <emphasis>and</emphasis> indirect energy properties. To make a specific light emit more
                    or less indirect energy without affecting the amount of direct light emitted
                    by the light, adjust the <strong>Indirect Energy</strong> property in the Light3D inspector.</paragraph>
            </note>
            <seealso>
                <paragraph>See <reference internal="True" refuri="introduction_to_global_illumination#doc-introduction-to-global-illumination-gi-mode-recommendations"><inline classes="std std-ref">Which global illumination mode should I use on meshes and lights?</inline></reference>
                    for general usage recommendations.</paragraph>
            </seealso>
        </section>
        <section ids="adjusting-sdfgi-performance-and-quality" names="adjusting\ sdfgi\ performance\ and\ quality">
            <title>Adjusting SDFGI performance and quality</title>
            <paragraph>Since SDFGI is relatively demanding, it will perform best on systems with recent
                dedicated GPUs. On older dedicated GPUs and integrated graphics,
                tweaking the settings is necessary to achieve reasonable performance.</paragraph>
            <paragraph>In the Project Settings' <strong>Rendering &gt; Global Illumination</strong> section,
                SDFGI quality can also be adjusted in several ways:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><strong>Sdfgi &gt; Probe Ray Count:</strong> Higher values result in better quality,
                        at the cost of higher GPU usage. If this value is set too low,
                        this can cause surfaces to have visible "splotches" of indirect lighting on
                        them due to the number of rays thrown being very low.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Sdfgi &gt; Frames To Converge:</strong> Higher values result in better quality, but GI will take
                        more time to fully converge. The effect of this setting is especially noticeable when first
                        loading a scene, or when lights with a bake mode other than <strong>Disabled</strong> are moving fast.
                        If this value is set too low, this can cause surfaces to have visible "splotches"
                        of indirect lighting on them due to the number of rays thrown being very low.
                        If your scene's lighting doesn't have fast-moving lights that contribute to GI,
                        consider setting this to <literal>30</literal> to improve quality without impacting performance.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Sdfgi &gt; Frames To Update Light:</strong> Lower values result in moving lights being
                        reflected faster, at the cost of higher GPU usage. If your scene's lighting
                        doesn't have fast-moving lights that contribute to GI, consider setting this
                        to <literal>16</literal> to improve performance.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Gi &gt; Use Half Resolution:</strong> If enabled, both SDFGI and VoxelGI will have
                        their GI buffer rendering at halved resolution. For instance, when rendering
                        in 3840×2160, the GI buffer will be computed at a 1920×1080 resolution.
                        Enabling this option saves a lot of GPU time, but it can introduce visible
                        aliasing around thin details.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>SDFGI rendering performance also depends on the number of cascades and
                the cell size chosen in the Environment resource (see above).</paragraph>
        </section>
        <section ids="sdfgi-caveats" names="sdfgi\ caveats">
            <title>SDFGI caveats</title>
            <paragraph>SDFGI has some downsides due to its cascaded nature. When the camera moves,
                cascade shifts may be visible in indirect lighting. This can be alleviated
                by adjusting the cascade size, but also by adding fog (which will make distant
                cascade shifts less noticeable).</paragraph>
            <paragraph>Additionally, performance will suffer if the camera moves too fast.
                This can be fixed in two ways:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Ensuring the camera doesn't move too fast in any given situation.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Temporarily disabling SDFGI in the Environment resource if the camera needs
                        to be moved at a high speed, then enabling SDFGI once the camera speed slows down.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>When SDFGI is enabled, it will also take some time for global illumination
                to be fully converged (25 frames by default). This can create a noticeable transition
                effect while GI is still converging. To hide this, you can use a ColorRect node
                that spans the whole viewport and fade it out when switching scenes using an
                AnimationPlayer node.</paragraph>
            <paragraph>The signed distance field is only updated when the camera moves in and out of a
                cascade. This means that if geometry is modified in the distance, the global
                illumination appearance will be correct once the camera gets closer. However, if
                a nearby object with a bake mode set to <strong>Static</strong> or <strong>Dynamic</strong> is moved (such
                as a door), the global illumination will appear incorrect until the camera moves
                away from the object.</paragraph>
            <paragraph>SDFGI's sharp reflections are only visible on opaque materials. Transparent
                materials will only use rough reflections, even if the material's roughness is
                lower than 0.2.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
