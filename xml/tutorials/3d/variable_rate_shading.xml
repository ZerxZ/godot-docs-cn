<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/3d/variable_rate_shading.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-variable-rate-shading"></target>
    <section ids="variable-rate-shading doc-variable-rate-shading" names="variable\ rate\ shading doc_variable_rate_shading">
        <title>Variable rate shading</title>
        <section ids="what-is-variable-rate-shading" names="what\ is\ variable\ rate\ shading?">
            <title>What is variable rate shading?</title>
            <paragraph>In modern 3D rendering engines, shaders are much more complex compared to
                before. The advent of physically-based rendering, real-time global illumination
                and screen-space effects has increased the number of <emphasis>per-pixel</emphasis> shading that
                must be performed to render each frame. Additionally, screen resolutions also
                have increased a lot, with 1440p and 4K now being common target resolutions.
                As a result, the total shading cost in scene rendering usually represents
                a significant amount of the time taken to render each frame.</paragraph>
            <paragraph>Variable rate shading (VRS) is a method of decreasing this shading cost by
                reducing the resolution of <emphasis>per-pixel</emphasis> shading (also called <emphasis>fragment</emphasis> shading),
                while keeping the original resolution for rendering geometry. This means geometry
                edges remain as sharp as they would without VRS. VRS can be combined with any
                <reference internal="True" refuri="3d_antialiasing#doc-3d-antialiasing"><inline classes="std std-ref">3D antialiasing</inline></reference> technique (MSAA, FXAA, TAA, SSAA).</paragraph>
            <paragraph>VRS allows specifying the shading quality in a local manner, which makes it
                possible to have certain parts of the viewport receive more detailed shading
                than others. This is particularly useful in virtual reality (VR) to achieve
                <emphasis>foveated rendering</emphasis>, where the center of the viewport is more detailed than the
                edges.</paragraph>
            <paragraph>Here's a scene rendered with rate shading disabled then enabled, using the
                density map linked at the bottom of this page:</paragraph>
            <figure align="center" ids="id1">
                <image alt="Variable rate shading disabled in textured scene" candidates="{'*': 'tutorials/3d/img/variable_rate_shading_textured_disabled.webp'}" original_uri="img/variable_rate_shading_textured_disabled.webp" uri="tutorials/3d/img/variable_rate_shading_textured_disabled.webp"></image>
                <caption>Variable rate shading disabled in textured scene</caption>
            </figure>
            <figure align="center" ids="id2">
                <image alt="Variable rate shading enabled in textured scene (lower quality, but higher performance)" candidates="{'*': 'tutorials/3d/img/variable_rate_shading_textured_enabled.webp'}" original_uri="img/variable_rate_shading_textured_enabled.webp" uri="tutorials/3d/img/variable_rate_shading_textured_enabled.webp"></image>
                <caption>Variable rate shading enabled in textured scene (lower quality, but higher performance)</caption>
            </figure>
            <paragraph>When used in scenes with low-frequency detail (such as scenes with a
                stylized/low-poly aesthetic), it's possible to achieve similar performance gains,
                but with less reduction in visual quality:</paragraph>
            <figure align="center" ids="id3">
                <image alt="Variable rate shading disabled in untextured scene" candidates="{'*': 'tutorials/3d/img/variable_rate_shading_untextured_disabled.webp'}" original_uri="img/variable_rate_shading_untextured_disabled.webp" uri="tutorials/3d/img/variable_rate_shading_untextured_disabled.webp"></image>
                <caption>Variable rate shading disabled in untextured scene</caption>
            </figure>
            <figure align="center" ids="id4">
                <image alt="Variable rate shading enabled in untextured scene (lower quality, but higher performance)" candidates="{'*': 'tutorials/3d/img/variable_rate_shading_untextured_enabled.webp'}" original_uri="img/variable_rate_shading_untextured_enabled.webp" uri="tutorials/3d/img/variable_rate_shading_untextured_enabled.webp"></image>
                <caption>Variable rate shading enabled in untextured scene (lower quality, but higher performance)</caption>
            </figure>
        </section>
        <section ids="hardware-support" names="hardware\ support">
            <title>Hardware support</title>
            <paragraph>Variable rate shading is only supported on specific GPUs:</paragraph>
            <paragraph><strong>Desktop:</strong></paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>NVIDIA Turing and newer (including GTX 1600 series)</paragraph>
                </list_item>
                <list_item>
                    <paragraph>AMD RDNA2 and newer (both integrated and dedicated GPUs – including Steam Deck)</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Intel Arc Alchemist and newer <strong>(dedicated GPUs only)</strong></paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>Intel integrated graphics do not support variable rate shading.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
            </bullet_list>
            <paragraph><strong>Mobile SoCs:</strong></paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Snapdragon 888 and newer</paragraph>
                </list_item>
                <list_item>
                    <paragraph>MediaTek Dimensity 9000 and newer</paragraph>
                </list_item>
                <list_item>
                    <paragraph>ARM Mali-G615 and newer</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>As of January 2023, Apple and Raspberry Pi GPUs do not support variable rate shading.</paragraph>
        </section>
        <section ids="using-variable-rate-shading-in-godot" names="using\ variable\ rate\ shading\ in\ godot">
            <title>Using variable rate shading in Godot</title>
            <note>
                <paragraph>Both Forward+ and Mobile renderers support variable rate
                    shading. VRS can be used in both pancake (non-XR) and XR display modes.</paragraph>
                <paragraph>The Compatibility renderer does <strong>not</strong> support variable rate shading.
                    For XR, you can use <reference internal="True" refuri="../xr/openxr_settings#doc-openxr-settings-foveation-level"><inline classes="std std-ref">foveation level</inline></reference>
                    as an alternative.</paragraph>
            </note>
            <paragraph>In the advanced Project Settings, the <strong>Rendering &gt; VRS</strong> section offers settings
                to control variable rate shading on the root viewport:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><strong>Mode:</strong> Controls the variable rate shading mode. <strong>Disabled</strong> disables
                        variable rate shading. <strong>Texture</strong> uses a manually authored texture to set
                        shading density (see the property below). <strong>XR</strong> automatically generates a
                        texture suited for foveated rendering in virtual/augmented reality.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><strong>Texture:</strong> The texture to use to control shading density on the root
                        viewport. Only used if <strong>Mode</strong> is <strong>Texture</strong>.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>For custom viewports, the VRS mode and texture must be set manually to the
                <reference internal="True" refuri="../../classes/class_viewport#class-viewport"><inline classes="std std-ref">Viewport</inline></reference> node.</paragraph>
            <note>
                <paragraph>On unsupported hardware, there is no visual difference when variable rate
                    shading is enabled. You can check whether hardware supports variable rate
                    shading by running the editor or project with the <literal>--verbose</literal>
                    <reference internal="True" refuri="../editor/command_line_tutorial#doc-command-line-tutorial"><inline classes="std std-ref">command line argument</inline></reference>.</paragraph>
            </note>
            <section ids="creating-a-vrs-density-map" names="creating\ a\ vrs\ density\ map">
                <title>Creating a VRS density map</title>
                <paragraph>If using the <strong>Texture</strong> VRS mode, you <emphasis>must</emphasis> set a texture to be used as a
                    density map. Otherwise, no effect will be visible.</paragraph>
                <paragraph>You can create your own VRS density map manually using an image editor, or
                    generate it using another method (e.g. on the CPU using the Image class, or on
                    the GPU using a shader). However, beware of performance implications when
                    generating a VRS image dynamically. If opting for dynamic generation, make sure
                    the VRS image generation process is fast enough to avoid outweighing the
                    performance gains from VRS.</paragraph>
                <paragraph>The texture must follow these rules:</paragraph>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>The texture <emphasis>must</emphasis> use a lossless compression format so that colors can be
                            matched precisely.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>The following VRS densities are mapped to various colors, with brighter colors
                            representing a lower level of shading precision:</paragraph>
                    </list_item>
                </bullet_list>
                <table>
                    <tgroup cols="3">
                        <colspec colwidth="22"></colspec>
                        <colspec colwidth="32"></colspec>
                        <colspec colwidth="33"></colspec>
                        <thead>
                            <row>
                                <entry>
                                    <paragraph>Density</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Color</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Comment</paragraph>
                                </entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph>1×1 (highest detail)</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(0, 0, 0) - #000000</literal></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>1×2</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(0, 85, 0) - #005500</literal></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>2×1</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(85, 0, 0) - #550000</literal></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>2×2</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(85, 85, 0) - #555500</literal></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>2×4</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(85, 170, 0) - #55aa00</literal></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>4×2</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(170, 85, 0) - #aa5500</literal></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>4×4</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(170, 170, 0) - #aaaa00</literal></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>4×8</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(170, 255, 0) - #aaff00</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Not supported on most hardware.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>8×4</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(255, 170, 0) - #ffaa00</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Not supported on most hardware.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>8×8 (lowest detail)</paragraph>
                                </entry>
                                <entry>
                                    <paragraph><literal>rgb(255, 255, 0) - #ffff00</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Not supported on most hardware.</paragraph>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
                <paragraph>For example, this VRS density texture provides the highest shading density in
                    the center of the viewport, and the lowest shading density in the corners:</paragraph>
                <figure align="center" ids="id5">
                    <image alt="Example VRS density map texture, simulating foveated rendering" candidates="{'*': 'tutorials/3d/img/variable_rate_shading_texture_example.webp'}" original_uri="img/variable_rate_shading_texture_example.webp" uri="tutorials/3d/img/variable_rate_shading_texture_example.webp"></image>
                    <caption>Example VRS density map texture, simulating foveated rendering</caption>
                </figure>
                <paragraph>There are no size or aspect ratio requirements for the VRS density texture.
                    However, there is no benefit to using a VRS density map that is larger than the
                    viewport resolution divided by the GPU's <emphasis>tile size</emphasis>. The tile size is what
                    determines the smallest area of pixels where the shading density can be changed
                    separately from other tiles. On most GPUs, this tile size is 8×8 pixels. You can
                    view the tile size by running Godot with the <literal>--verbose</literal> command line
                    argument, as it's printed in the VRS debugging information.</paragraph>
                <paragraph>Therefore, sticking to a relatively low resolution such as 256×256 (square) or
                    480×270 (16:9) is recommended. Depending on your use cases, a square texture may
                    be more suited compared to a texture that matches the most common viewport
                    aspect ratio in your project (such as 16:9).</paragraph>
                <tip>
                    <paragraph>When using variable rate shading, you can use a negative
                        <reference internal="True" refuri="resolution_scaling#doc-resolution-scaling-mipmap-bias"><inline classes="std std-ref">texture mipmap LOD bias</inline></reference>
                        to reduce blurriness in areas with reduced shading rate.</paragraph>
                    <paragraph>Note that the texture LOD bias is set globally, so this will also affect
                        areas of the viewport with full shading rate. Don't use values that are too
                        low, or textures will appear grainy.</paragraph>
                </tip>
            </section>
            <section ids="performance-comparison" names="performance\ comparison">
                <title>Performance comparison</title>
                <paragraph>To give an idea of how much VRS can improve performance in theory, here's a
                    performance comparison with the textured example scene shown at the top of this
                    page. The VRS density map example present on this page is used.</paragraph>
                <paragraph>Results were captured on a GeForce RTX 4090 with the NVIDIA 525.60.11 driver.</paragraph>
                <table>
                    <tgroup cols="4">
                        <colspec colwidth="21"></colspec>
                        <colspec colwidth="14"></colspec>
                        <colspec colwidth="13"></colspec>
                        <colspec colwidth="25"></colspec>
                        <thead>
                            <row>
                                <entry>
                                    <paragraph>Resolution</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>VRS disabled</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>VRS enabled</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Performance improvement</paragraph>
                                </entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph>1920×1080 (Full HD)</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>2832 FPS</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>3136 FPS</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>+10.7%</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>2560×1440 (QHD)</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>2008 FPS</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>2256 FPS</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>+12.3%</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>3840×2160 (4K)</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>1236 FPS</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>1436 FPS</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>+16.2%</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>7680×4320 (8K)</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>384 FPS</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>473 FPS</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>+23.1%</paragraph>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
                <paragraph>In terms of performance improvements, variable rate shading is more beneficial
                    at higher target resolutions. The reduction in visual quality is also less
                    noticeable at high resolutions.</paragraph>
                <note>
                    <paragraph>For non-VR games, you will probably have to use a less aggressive VRS texture
                        than what was used in this example. As a result, the effective performance
                        gains will be lower.</paragraph>
                </note>
                <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
            </section>
        </section>
    </section>
</document>
