<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/scripting/cpp/core_types.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-godot-cpp-core-types"></target>
    <section ids="core-functions-and-types doc-godot-cpp-core-types" names="core\ functions\ and\ types doc_godot_cpp_core_types">
        <title>Core functions and types</title>
        <paragraph>godot-cpp's API is designed to be as similar as possible to Godot's internal API.</paragraph>
        <paragraph>This means that, in general, you can use the <reference internal="True" refuri="../../../engine_details/architecture/index#doc-engine-architecture"><inline classes="std std-ref">Engine details</inline></reference> section to learn how to
            work with godot-cpp. In addition, it can often be useful to browse the <reference name="engine's code" refuri="https://github.com/godotengine/godot">engine's code</reference>
            for examples for how to work with Godot's API.</paragraph>
        <paragraph>That being said, there are some differences to be aware of, which are documented here.</paragraph>
        <section ids="common-functions-and-macros" names="common\ functions\ and\ macros">
            <title>Common functions and macros</title>
            <paragraph>Please refer to <reference internal="True" refuri="../../../engine_details/architecture/common_engine_methods_and_macros#doc-common-engine-methods-and-macros"><inline classes="std std-ref">Common engine methods and macros</inline></reference> for information on this. The functions and macros documented
                there are also available in godot-cpp.</paragraph>
        </section>
        <section ids="core-types" names="core\ types">
            <title>Core types</title>
            <paragraph>Godot's <reference internal="True" refuri="../../../engine_details/architecture/core_types#doc-core-types"><inline classes="std std-ref">Core types</inline></reference> are also available in godot-cpp, and the same recommendations apply
                as described in that article. The types are regularly synchronized with the Godot codebase.</paragraph>
            <paragraph>In your own code, you can also use <reference name="C++ STL types" refuri="https://en.cppreference.com/w/cpp/container.html">C++ STL types</reference>, or types from
                any library you choose, but they won't be compatible with Godot's APIs.</paragraph>
            <section ids="packed-arrays" names="packed\ arrays">
                <title>Packed arrays</title>
                <paragraph>While in Godot, the <literal>Packed*Array</literal> types are aliases of <literal>Vector</literal>, in godot-cpp, they're their own types, using the
                    Godot bindings. This is because <literal>Packed*Array</literal> are exposed to Godot and limited to only Godot types, whereas <literal>Vector</literal>
                    can hold any C++ type which Godot might not be able to understand.</paragraph>
                <paragraph>In general, the <literal>Packed*Array</literal> types work the same way as their <literal>Vector</literal> aliases, however, there are some notable
                    differences.</paragraph>
                <section ids="data-access" names="data\ access">
                    <title>Data access</title>
                    <paragraph><literal>Vector</literal> keeps its data entirely within the GDExtension, whereas the <literal>Packed*Array</literal> types keep their data on the
                        Godot side. This means that any time a <literal>Packed*Array</literal> is accessed, it needs to call into Godot.</paragraph>
                    <paragraph>To efficiently read or write a large amount of data into a <literal>Packed*Array</literal>, you should call <literal>.ptr()</literal> (for reading)
                        or <literal>.ptrw()</literal> (for writing) to get a pointer directly to the array's memory:</paragraph>
                    <literal_block force="False" highlight_args="{}" language="cpp" linenos="False" xml:space="preserve">// BAD!
void my_bad_function(const PackedByteArray &amp;p_array) {
    for (int i = 0; i &lt; p_array.size(); i++) {
        // Each time this runs it needs to call into Godot.
        uint8_t byte = p_array[i];

        // .. do something with the byte.
    }
}

// GOOD :-)
void my_good_function(const PackedByteArray &amp;p_array) {
    const uint8_t *array_ptr = p_array.ptr();
    for (int i = 0; i &lt; p_array.size(); i++) {
        // This directly accesses the memory!
        uint8_t byte = array_ptr[i];

        // .. do something with the byte.
    }
}</literal_block>
                </section>
                <section ids="copying" names="copying">
                    <title>Copying</title>
                    <paragraph><literal>Variant</literal> wrappers for <literal>Packed*Array</literal> treat them as pass-by-reference, while the <literal>Packed*Array</literal>
                        types themselves are pass-by-value (implemented as copy-on-write).</paragraph>
                    <paragraph>In addition, it may be of interest that GDScript calls use the <literal>Variant</literal> call interface: Any <literal>Packed*Array</literal>
                        arguments to your functions will be passed in a <literal>Variant</literal>, and unpacked from there. This can create copies of the
                        types, so the argument you receive may be a copy of the argument that the function was called with. In practice, this
                        means you cannot rely on that the argument passed to you can be modified at the caller's site.</paragraph>
                </section>
            </section>
        </section>
        <section ids="variant-class" names="variant\ class">
            <title>Variant class</title>
            <paragraph>Please refer to <reference internal="True" refuri="../../../engine_details/architecture/variant_class#doc-variant-class"><inline classes="std std-ref">Variant class</inline></reference> to learn about how to work with <literal>Variant</literal>.</paragraph>
            <paragraph>Most importantly, you should be aware that all functions exposed through the GDExtension API must be compatible with
                <literal>Variant</literal>.</paragraph>
        </section>
        <section ids="object-class" names="object\ class">
            <title>Object class</title>
            <paragraph>Please refer to <reference internal="True" refuri="../../../engine_details/architecture/object_class#doc-object-class"><inline classes="std std-ref">Object class</inline></reference> to learn how to register and work with your own <literal>Object</literal> types.</paragraph>
            <paragraph>We are not aware of any major differences between the godot-cpp <literal>Object</literal> API and Godot's internal <literal>Object</literal> API,
                except that some methods are available in Godot's internal API that are not available in godot-cpp.</paragraph>
            <paragraph>You should be aware that the pointer to your godot-cpp <literal>Object</literal> is different from the pointer that Godot uses
                internally. This is because the godot-cpp version is an extension instance, allocated separately from the original
                <literal>Object</literal>. However, in practice, this difference is usually not noticeable.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
