<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/scripting/cpp/gdextension_docs_system.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-godot-cpp-docs-system"></target>
    <section ids="adding-documentation doc-godot-cpp-docs-system" names="adding\ documentation doc_godot_cpp_docs_system">
        <title>Adding documentation</title>
        <note>
            <paragraph>Adding documentation for GDExtensions is only possible for Godot 4.3 and later. The support can be integrated into your project
                regardless because the snippet will check if you use the appropriate godot-cpp version.
                If you set the <literal>compatibility_minimum</literal> to 4.2 and you load a project with the extension through a 4.2 editor, the
                documentation page for that class will be empty. The extension itself will still work.</paragraph>
        </note>
        <paragraph>The GDExtension documentation system works in a similar manner to the built-in engine documentation. It uses a series of
            XML files (one per class) to document the exposed constructors, properties, methods, constants, signals, and theme items of each class.</paragraph>
        <note>
            <paragraph>We are assuming you are using the project files explained in the <reference internal="True" refuri="gdextension_cpp_example#doc-godot-cpp-getting-started"><inline classes="std std-ref">example project</inline></reference>
                with the following structure:</paragraph>
        </note>
        <literal_block force="False" highlight_args="{}" language="none" linenos="False" xml:space="preserve">gdextension_cpp_example/  # GDExtension directory
|
+--demo/                  # game example/demo to test the extension
|   |
|   +--main.tscn
|   |
|   +--bin/
|       |
|       +--gdexample.gdextension
|
+--godot-cpp/             # C++ bindings
|
+--src/                   # source code of the extension we are building
|   |
|   +--register_types.cpp
|   +--register_types.h
|   +--gdexample.cpp
|   +--gdexample.h</literal_block>
        <paragraph>Inside the Godot demo project directory of your GDExtension directory, run the following terminal command:</paragraph>
        <literal_block force="False" highlight_args="{}" language="none" linenos="False" xml:space="preserve"># Replace "godot" with the full path to a Godot editor binary
# if Godot is not installed in your `PATH`.
godot --doctool ../ --gdextension-docs</literal_block>
        <paragraph>This command calls upon the Godot editor binary to generate documentation via the <literal>--doctool</literal>
            and <literal>--gdextension-docs</literal> commands. The <literal>../</literal> addition is to let Godot know where the GDExtension
            SConstruct file is located. By calling this command, Godot generates a <literal>doc_classes</literal> directory inside the
            project directory in which it generates XML files for the GDExtension classes. Those files
            can then be edited to add information about member variables, methods, signals, and more.</paragraph>
        <paragraph>To add the now edited documentation to the GDExtension and let the editor load it,
            you need to add the following lines to your SConstruct file:</paragraph>
        <literal_block force="False" highlight_args="{}" language="py" linenos="False" xml:space="preserve">if env["target"] in ["editor", "template_debug"]:
    try:
        doc_data = env.GodotCPPDocData("src/gen/doc_data.gen.cpp", source=Glob("doc_classes/*.xml"))
        sources.append(doc_data)
    except AttributeError:
        print("Not including class reference as we're targeting a pre-4.3 baseline.")</literal_block>
        <paragraph>The if-statement checks if we are compiling the GDExtension library with the <literal>editor</literal> and <literal>template_debug</literal>
            flags. SCons then tries to load all the XML files inside the <literal>doc_classes</literal> directory and appends them
            to the <literal>sources</literal> variable which already includes all the source files of your extension. If it fails
            it means we are currently trying to compile the library when the <literal>godot_cpp</literal> is set to a version before 4.3.</paragraph>
        <paragraph>After loading the extension in a 4.3 Godot editor or later and open the documentation of your extension class
            either by <literal classes="kbd">Ctrl + Click</literal> in the script editor or the Editor help dialog you will see something like this:</paragraph>
        <image candidates="{'*': 'tutorials/scripting/cpp/img/gdextension_docs_generation.webp'}" original_uri="img/gdextension_docs_generation.webp" uri="tutorials/scripting/cpp/img/gdextension_docs_generation.webp"></image>
        <section ids="documentation-styling" names="documentation\ styling">
            <title>Documentation styling</title>
            <paragraph>To style specific parts of text you can use BBCode tags similarly to how they can be used in <reference internal="True" refuri="../../ui/bbcode_in_richtextlabel#doc-bbcode-in-richtextlabel"><inline classes="std std-ref">RichTextLabels</inline></reference>.
                You can set text as bold, italic, underlined, colored, codeblocks etc. by embedding them in tags like this:</paragraph>
            <literal_block force="False" highlight_args="{}" language="none" linenos="False" xml:space="preserve">[b]this text will be shown as bold[/b]</literal_block>
            <paragraph>Currently, the supported tags for the GDExtension documentation system are:</paragraph>
            <table classes="colwidths-given wrap-normal" width="100%">
                <tgroup cols="2">
                    <colspec colwidth="60"></colspec>
                    <colspec colwidth="40"></colspec>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph>Tag</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Example</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>b</strong></line>
                                    <line>Makes <literal>{text}</literal> use the bold (or bold italics) font of <literal>RichTextLabel</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[b]{text}[/b]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>i</strong></line>
                                    <line>Makes <literal>{text}</literal> use the italics (or bold italics) font of <literal>RichTextLabel</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[i]{text}[/i]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>u</strong></line>
                                    <line>Makes <literal>{text}</literal> underlined.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[u]{text}[/u]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>s</strong></line>
                                    <line>Makes <literal>{text}</literal> strikethrough.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[s]{text}[/s]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>kbd</strong></line>
                                    <line>Makes <literal>{text}</literal> use a grey beveled background, indicating a keyboard shortcut.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[kbd]{text}[/kbd]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>code</strong></line>
                                    <line>Makes inline <literal>{text}</literal> use the mono font and styles the text color and background like code.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[code]{text}[/code]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>codeblocks</strong></line>
                                    <line>Makes multiline <literal>{text}</literal> use the mono font and styles the text color and background like code.</line>
                                    <line>The addition of the <literal>[gdscript]</literal> tag highlights the GDScript specific syntax.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[codeblocks]</literal></line>
                                    <line><literal>[gdscript]</literal></line>
                                    <line><literal>{text}</literal></line>
                                    <line><literal>[/gdscript]</literal></line>
                                    <line><literal>[/codeblocks]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>center</strong></line>
                                    <line>Makes <literal>{text}</literal> horizontally centered.</line>
                                    <line>Same as <literal>[p align=center]</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[center]{text}[/center]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>url</strong></line>
                                    <line>Creates a hyperlink (underlined and clickable text). Can contain optional <literal>{text}</literal> or display <literal>{link}</literal> as is.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[url]{link}[/url]</literal></line>
                                    <line><literal>[url={link}]{text}[/url]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>img</strong></line>
                                    <line>Inserts an image from the <literal>{path}</literal> (can be any valid <reference internal="True" refuri="../../../classes/class_texture2d#class-texture2d"><inline classes="std std-ref">Texture2D</inline></reference> resource).</line>
                                    <line>If <literal>{width}</literal> is provided, the image will try to fit that width maintaining
                                        the aspect ratio.</line>
                                    <line>If both <literal>{width}</literal> and <literal>{height}</literal> are provided, the image will be scaled
                                        to that size.</line>
                                    <line>Add <literal>%</literal> to the end of <literal>{width}</literal> or <literal>{height}</literal> value to specify it as percentages of the control width instead of pixels.</line>
                                    <line>If <literal>{valign}</literal> configuration is provided, the image will try to align to the
                                        surrounding text, see <reference internal="True" refuri="../../ui/bbcode_in_richtextlabel#doc-bbcode-in-richtextlabel-image-and-table-alignment"><inline classes="std std-ref">Image and table vertical alignment</inline></reference>.</line>
                                    <line>Supports configuration options, see <reference internal="True" refuri="../../ui/bbcode_in_richtextlabel#doc-bbcode-in-richtextlabel-image-options"><inline classes="std std-ref">Image options</inline></reference>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[img]{path}[/img]</literal></line>
                                    <line><literal>[img={width}]{path}[/img]</literal></line>
                                    <line><literal>[img={width}x{height}]{path}[/img]</literal></line>
                                    <line><literal>[img={valign}]{path}[/img]</literal></line>
                                    <line><literal>[img {options}]{path}[/img]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>color</strong></line>
                                    <line>Changes the color of <literal>{text}</literal>. Color must be provided by a common name (see
                                        <reference internal="True" refuri="../../ui/bbcode_in_richtextlabel#doc-bbcode-in-richtextlabel-named-colors"><inline classes="std std-ref">Named colors</inline></reference>) or using the HEX format (e.g.
                                        <literal>#ff00ff</literal>, see <reference internal="True" refuri="../../ui/bbcode_in_richtextlabel#doc-bbcode-in-richtextlabel-hex-colors"><inline classes="std std-ref">Hexadecimal color codes</inline></reference>).</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[color={code/name}]{text}[/color]</literal></paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </section>
        <section ids="publishing-documentation-online" names="publishing\ documentation\ online">
            <title>Publishing documentation online</title>
            <paragraph>You may want to publish an online reference for your GDExtension, similar to this website.
                The most important step is to build reStructuredText (<literal>.rst</literal>) files from your XML class reference:</paragraph>
            <literal_block force="False" highlight_args="{}" language="bash" linenos="False" xml:space="preserve"># You need a version.py file, so download it first.
curl -sSLO https://raw.githubusercontent.com/godotengine/godot/refs/heads/master/version.py

# Edit version.py according to your project before proceeding.
# Then, run the rst generator. You'll need to have Python installed for this command to work.
curl -sSL https://raw.githubusercontent.com/godotengine/godot/master/doc/tools/make_rst.py | python3 - -o "docs/classes" -l "en" doc_classes</literal_block>
            <paragraph>Your <literal>.rst</literal> files will now be available in <literal>docs/classes/</literal>. From here, you can use
                any documentation builder that supports reStructuredText syntax to create a website from them.</paragraph>
            <paragraph><reference name="godot-docs" refuri="https://github.com/godotengine/godot-docs">godot-docs</reference><target ids="godot-docs" names="godot-docs" refuri="https://github.com/godotengine/godot-docs"></target> uses <reference name="Sphinx" refuri="https://www.sphinx-doc.org/en/master/">Sphinx</reference><target ids="sphinx" names="sphinx" refuri="https://www.sphinx-doc.org/en/master/"></target>. You can use the repository as a basis to build your own documentation system. The following guide describes the basic steps, but they are not exhaustive: You will need a bit of personal insight to make it work.</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Add <reference name="godot-docs" refuri="https://github.com/godotengine/godot-docs">godot-docs</reference><target dupnames="godot-docs" ids="id1" refuri="https://github.com/godotengine/godot-docs"></target> as a submodule to your <literal>docs/</literal> folder.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Copy over its <literal>conf.py</literal>, <literal>index.rst</literal>, <literal>.readthedocs.yaml</literal> files into <literal>/docs/</literal>. You may later decide to copy over and edit more of godot-docs' files, like <literal>_templates/layout.html</literal>.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Modify these files according to your project. This mostly involves adjusting paths to point to the <literal>godot-docs</literal> subfolder, as well as strings to reflect it's your project rather than Godot you're building the docs for.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create an account on <reference name="readthedocs.org" refuri="http://readthedocs.org">readthedocs.org</reference><target ids="readthedocs-org" names="readthedocs.org" refuri="http://readthedocs.org"></target>. Import your project, and modify its base <literal>.readthedocs.yaml</literal> file path to <literal>/docs/.readthedocs.yaml</literal>.</paragraph>
                </list_item>
            </enumerated_list>
            <paragraph>Once you have completed all these steps, your documentation should be available at <literal>&lt;repo-name&gt;.readthedocs.io</literal>.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
