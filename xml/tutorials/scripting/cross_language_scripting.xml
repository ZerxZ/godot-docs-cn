<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/scripting/cross_language_scripting.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-cross-language-scripting"></target>
    <section ids="cross-language-scripting doc-cross-language-scripting" names="cross-language\ scripting doc_cross_language_scripting">
        <title>Cross-language scripting</title>
        <paragraph>Godot allows you to mix and match scripting languages to suit your needs.
            This means a single project can define nodes in both C# and GDScript.
            This page will go through the possible interactions between two nodes written
            in different languages.</paragraph>
        <paragraph>The following two scripts will be used as references throughout this page.</paragraph>
        <container classes="sphinx-tabs" type="tab-element">
            <div aria-label="Tabbed content" role="tablist">
                <button aria-controls="panel-0-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                <button aria-controls="panel-0-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
            </div>
            <div aria-labelledby="tab-0-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">extends Node

var my_property: String = "my gdscript value":
    get:
        return my_property
    set(value):
        my_property = value

signal my_signal
signal my_signal_with_params(msg: String, n: int)

func print_node_name(node: Node) -&gt; void:
    print(node.get_name())

func print_array(arr: Array) -&gt; void:
    for element in arr:
        print(element)

func print_n_times(msg: String, n: int) -&gt; void:
    for i in range(n):
        print(msg)

func my_signal_handler():
    print("The signal handler was called!")

func my_signal_with_params_handler(msg: String, n: int):
    print_n_times(msg, n)</literal_block>
            </div>
            <div aria-labelledby="tab-0-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-0-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">using Godot;

public partial class MyCSharpNode : Node
{
    public string MyProperty { get; set; } = "my c# value";

    [Signal] public delegate void MySignalEventHandler();
    [Signal] public delegate void MySignalWithParamsEventHandler(string msg, int n);

    public void PrintNodeName(Node node)
    {
        GD.Print(node.Name);
    }

    public void PrintArray(string[] arr)
    {
        foreach (string element in arr)
        {
            GD.Print(element);
        }
    }

    public void PrintNTimes(string msg, int n)
    {
        for (int i = 0; i &lt; n; ++i)
        {
            GD.Print(msg);
        }
    }

    public void MySignalHandler()
    {
        GD.Print("The signal handler was called!");
    }

    public void MySignalWithParamsHandler(string msg, int n)
    {
        PrintNTimes(msg, n);
    }
}</literal_block>
            </div>
        </container>
        <section ids="instantiating-nodes" names="instantiating\ nodes">
            <title>Instantiating nodes</title>
            <paragraph>If you're not using nodes from the scene tree, you'll probably want to
                instantiate nodes directly from the code.</paragraph>
            <section ids="instantiating-c-nodes-from-gdscript" names="instantiating\ c#\ nodes\ from\ gdscript">
                <title>Instantiating C# nodes from GDScript</title>
                <paragraph>Using C# from GDScript doesn't need much work. Once loaded
                    (see <reference internal="True" refuri="gdscript/gdscript_basics#doc-gdscript-classes-as-resources"><inline classes="std std-ref">Classes as resources</inline></reference>), the script can be instantiated
                    with <reference internal="True" refuri="../../classes/class_csharpscript#class-csharpscript-method-new"><inline classes="std std-ref">new()</inline></reference>.</paragraph>
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">var MyCSharpScript = load("res://Path/To/MyCSharpNode.cs")
var my_csharp_node = MyCSharpScript.new()</literal_block>
                <warning>
                    <paragraph>When creating <literal>.cs</literal> scripts, you should always keep in mind that the class
                        Godot will use is the one named like the <literal>.cs</literal> file itself. If that class
                        does not exist in the file, you'll see the following error:
                        <literal>Invalid call. Nonexistent function `new` in base</literal>.</paragraph>
                    <paragraph>For example, MyCoolNode.cs should contain a class named MyCoolNode.</paragraph>
                    <paragraph>The C# class needs to derive a Godot class, for example <literal>GodotObject</literal>.
                        Otherwise, the same error will occur.</paragraph>
                    <paragraph>You also need to check your <literal>.cs</literal> file is referenced in the project's
                        <literal>.csproj</literal> file. Otherwise, the same error will occur.</paragraph>
                </warning>
            </section>
            <section ids="instantiating-gdscript-nodes-from-c" names="instantiating\ gdscript\ nodes\ from\ c#">
                <title>Instantiating GDScript nodes from C#</title>
                <paragraph>From the C# side, everything work the same way. Once loaded, the GDScript can
                    be instantiated with <reference internal="True" refuri="../../classes/class_gdscript#class-gdscript-method-new"><inline classes="std std-ref">GDScript.New()</inline></reference>.</paragraph>
                <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">var myGDScript = GD.Load&lt;GDScript&gt;("res://path/to/my_gd_script.gd");
var myGDScriptNode = (GodotObject)myGDScript.New(); // This is a GodotObject.</literal_block>
                <paragraph>Here we are using an <reference internal="True" refuri="../../classes/class_object#class-object"><inline classes="std std-ref">Object</inline></reference>, but you can use type conversion like
                    explained in <reference internal="True" refuri="c_sharp/c_sharp_features#doc-c-sharp-features-type-conversion-and-casting"><inline classes="std std-ref">Type conversion and casting</inline></reference>.</paragraph>
            </section>
        </section>
        <section ids="accessing-fields" names="accessing\ fields">
            <title>Accessing fields</title>
            <section ids="accessing-c-fields-from-gdscript" names="accessing\ c#\ fields\ from\ gdscript">
                <title>Accessing C# fields from GDScript</title>
                <paragraph>Accessing C# fields from GDScript is straightforward, you shouldn't have
                    anything to worry about.</paragraph>
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve"># Output: "my c# value".
print(my_csharp_node.MyProperty)
my_csharp_node.MyProperty = "MY C# VALUE"
# Output: "MY C# VALUE".
print(my_csharp_node.MyProperty)</literal_block>
            </section>
            <section ids="accessing-gdscript-fields-from-c" names="accessing\ gdscript\ fields\ from\ c#">
                <title>Accessing GDScript fields from C#</title>
                <paragraph>As C# is statically typed, accessing GDScript from C# is a bit more
                    convoluted. You will have to use <reference internal="True" refuri="../../classes/class_object#class-object-method-get"><inline classes="std std-ref">GodotObject.Get()</inline></reference>
                    and <reference internal="True" refuri="../../classes/class_object#class-object-method-set"><inline classes="std std-ref">GodotObject.Set()</inline></reference>. The first argument is the name of the field you want to access.</paragraph>
                <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">// Output: "my gdscript value".
GD.Print(myGDScriptNode.Get("my_property"));
myGDScriptNode.Set("my_property", "MY GDSCRIPT VALUE");
// Output: "MY GDSCRIPT VALUE".
GD.Print(myGDScriptNode.Get("my_property"));</literal_block>
                <paragraph>Keep in mind that when setting a field value you should only use types the
                    GDScript side knows about.
                    Essentially, you want to work with built-in types as described in
                    <reference internal="True" refuri="gdscript/gdscript_basics#doc-gdscript-builtin-types"><inline classes="std std-ref">Built-in types</inline></reference> or classes extending <reference internal="True" refuri="../../classes/class_object#class-object"><inline classes="std std-ref">Object</inline></reference>.</paragraph>
            </section>
        </section>
        <section ids="calling-methods" names="calling\ methods">
            <title>Calling methods</title>
            <section ids="calling-c-methods-from-gdscript" names="calling\ c#\ methods\ from\ gdscript">
                <title>Calling C# methods from GDScript</title>
                <paragraph>Again, calling C# methods from GDScript should be straightforward. The
                    marshalling process will do its best to cast the arguments to match
                    function signatures.
                    If that's impossible, you'll see the following error: <literal>Invalid call. Nonexistent function `FunctionName`</literal>.</paragraph>
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve"># Output: "my_gd_script_node" (or name of node where this code is placed).
my_csharp_node.PrintNodeName(self)
# This line will fail.
# my_csharp_node.PrintNodeName()

# Outputs "Hello there!" twice, once per line.
my_csharp_node.PrintNTimes("Hello there!", 2)

# Output: "a", "b", "c" (one per line).
my_csharp_node.PrintArray(["a", "b", "c"])
# Output: "1", "2", "3"  (one per line).
my_csharp_node.PrintArray([1, 2, 3])</literal_block>
            </section>
            <section ids="calling-gdscript-methods-from-c" names="calling\ gdscript\ methods\ from\ c#">
                <title>Calling GDScript methods from C#</title>
                <paragraph>To call GDScript methods from C# you'll need to use
                    <reference internal="True" refuri="../../classes/class_object#class-object-method-call"><inline classes="std std-ref">GodotObject.Call()</inline></reference>. The first argument is the
                    name of the method you want to call. The following arguments will be passed
                    to said method.</paragraph>
                <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">// Output: "MyCSharpNode" (or name of node where this code is placed).
myGDScriptNode.Call("print_node_name", this);
// This line will fail silently and won't error out.
// myGDScriptNode.Call("print_node_name");

// Outputs "Hello there!" twice, once per line.
myGDScriptNode.Call("print_n_times", "Hello there!", 2);

string[] arr = ["a", "b", "c"];
// Output: "a", "b", "c" (one per line).
myGDScriptNode.Call("print_array", arr);
// Output: "1", "2", "3"  (one per line).
myGDScriptNode.Call("print_array", new int[] { 1, 2, 3 });
// Note how the type of each array entry does not matter
// as long as it can be handled by the marshaller.</literal_block>
                <target refid="connecting-to-signals-cross-language"></target>
            </section>
        </section>
        <section ids="connecting-to-signals connecting-to-signals-cross-language" names="connecting\ to\ signals connecting_to_signals_cross_language">
            <title>Connecting to signals</title>
            <section ids="connecting-to-c-signals-from-gdscript" names="connecting\ to\ c#\ signals\ from\ gdscript">
                <title>Connecting to C# signals from GDScript</title>
                <paragraph>Connecting to a C# signal from GDScript is the same as connecting to a signal
                    defined in GDScript:</paragraph>
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">my_csharp_node.MySignal.connect(my_signal_handler)

my_csharp_node.MySignalWithParams.connect(my_signal_with_params_handler)</literal_block>
            </section>
            <section ids="connecting-to-gdscript-signals-from-c" names="connecting\ to\ gdscript\ signals\ from\ c#">
                <title>Connecting to GDScript signals from C#</title>
                <paragraph>Connecting to a GDScript signal from C# only works with the <literal>Connect</literal> method
                    because no C# static types exist for signals defined by GDScript:</paragraph>
                <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">myGDScriptNode.Connect("my_signal", Callable.From(MySignalHandler));

myGDScriptNode.Connect("my_signal_with_params", Callable.From&lt;string, int&gt;(MySignalWithParamsHandler));</literal_block>
            </section>
        </section>
        <section ids="inheritance" names="inheritance">
            <title>Inheritance</title>
            <paragraph>A GDScript file may not inherit from a C# script. Likewise, a C# script may not
                inherit from a GDScript file. Due to how complex this would be to implement,
                this limitation is unlikely to be lifted in the future. See
                <reference name="this GitHub issue" refuri="https://github.com/godotengine/godot/issues/38352">this GitHub issue</reference>
                for more information.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
