<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.17.1 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/scripting/c_sharp/c_sharp_variant.rst" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-c-sharp-variant"></target>
    <section ids="c-variant doc-c-sharp-variant" names="c#\ variant doc_c_sharp_variant">
        <title>C# Variant</title>
        <paragraph>对于 Variant 的详细解释，请参阅 <reference internal="True" refuri="../../../classes/class_variant#class-variant"><inline classes="std std-ref">Variant</inline></reference> 文档页面。</paragraph>
        <paragraph><literal>Godot.Variant</literal> 用于表示 Godot 的原生 <reference internal="True" refuri="../../../classes/class_variant#class-variant"><inline classes="std std-ref">Variant</inline></reference> 类型。任何与 Variant 兼容的类型都可以和它进行转换。我们建议仅在与无类型的引擎 API 交互时使用 <literal>Godot.Variant</literal> 。尽可能利用 C# 的类型安全性。</paragraph>
        <paragraph>任何 <literal>Variant.As{TYPE}</literal> 方法或通用的 <literal>Variant.As&lt;T&gt;</literal> 方法都可以用来将 <literal>Godot.Variant</literal> 转换为 C# 类型。由于 <literal>Godot.Variant</literal> 类型包含了所有支持类型的隐式转换，直接调用这些方法通常是不必要的。</paragraph>
        <paragraph>使用 <literal>CreateFrom</literal> 方法的重载或通用的 <literal>Variant.From&lt;T&gt;</literal> 方法将 C# 类型转换为 <literal>Godot.Variant</literal> 。</paragraph>
        <note>
            <paragraph>由于 C# 中的 Variant 类型是一个结构体，它不能为空。要创建一个 “null” Variant，使用 <literal>default</literal> 关键字或无参数构造函数。</paragraph>
        </note>
        <section ids="variant-compatible-types" names="variant-compatible\ types variant\ 兼容类型">
            <title>Variant 兼容类型</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>除了 <literal>decimal</literal> 、 <literal>nint</literal> 和 <literal>nuint</literal> 之外，所有的 <reference name="内置值类型" refuri="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/built-in-types-table">内置值类型</reference><target ids="id1" names="内置值类型" refuri="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/built-in-types-table"></target> 。</paragraph>
                </list_item>
                <list_item>
                    <paragraph><literal>String</literal> 。</paragraph>
                </list_item>
                <list_item>
                    <paragraph>从 <reference internal="True" refuri="../../../classes/class_object#class-object"><inline classes="std std-ref">GodotObject</inline></reference> 派生的类。</paragraph>
                </list_item>
                <list_item>
                    <paragraph>在 <literal>Godot.Collections</literal> 命名空间中定义的集合类型。</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>Variant 类型的完整列表及其对应的 C# 类型：</paragraph>
            <table>
                <tgroup cols="2">
                    <colspec colwidth="23"></colspec>
                    <colspec colwidth="59"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph>Variant.Type</paragraph>
                            </entry>
                            <entry>
                                <paragraph>C# 类型</paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><literal>Nil</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>null</literal> （不是类型）</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Bool</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>bool</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Int</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>long</literal> （Godot 在 Variant 中存储 64 位整数）</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Float</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>double</literal> （Godot 在 Variant 中存储 64 位浮点数）</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>String</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>string</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Vector2</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Vector2</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Vector2I</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Vector2I</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Rect2</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Rect2</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Rect2I</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Rect2I</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Vector3</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Vector3</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Vector3I</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Vector3I</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Transform2D</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Transform2D</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Vector4</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Vector4</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Vector4I</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Vector4I</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Plane</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Plane</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Quaternion</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Quaternion</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Aabb</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Aabb</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Basis</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Basis</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Transform3D</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Transform3D</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Projection</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Projection</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Color</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Color</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>StringName</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.StringName</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>NodePath</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.NodePath</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Rid</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Rid</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Object</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.GodotObject</literal> 或其他派生类型。</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Callable</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Callable</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Signal</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Signal</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Dictionary</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Collections.Dictionary</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>Array</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Collections.Array</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedByteArray</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>byte[]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedInt32Array</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>int[]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedInt64Array</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>long[]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedFloat32Array</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>float[]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedFloat64Array</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>double[]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedStringArray</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>string[]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedVector2Array</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Vector2[]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedVector3Array</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Vector3[]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>PackedColorArray</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>Godot.Color[]</literal></paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <warning>
                <paragraph>Godot 在 Variant 中使用 64 位的整数和浮点数。较小的整数和浮点数类型，如 <literal>int</literal> ， <literal>short</literal> 和 <literal>float</literal> ，也是支持的，因为它们可以放入更大的类型中。请注意，这里会进行隐式转换，所以使用错误的类型可能会导致精度损失。</paragraph>
            </warning>
            <warning>
                <paragraph>枚举类型由于其底层类型是整数类型，因此都与 <literal>Godot.Variant</literal> 兼容。但是，隐式转换不存在，枚举类型必须在转换为/从 <literal>Godot.Variant</literal> 之前手动转换为其底层的整数类型，或者使用通用的 <literal>Variant.As&lt;T&gt;</literal> 和 <literal>Variant.From&lt;T&gt;</literal> 方法来转换它们。</paragraph>
                <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">enum MyEnum { A, B, C }

Variant variant1 = (int)MyEnum.A;
MyEnum enum1 = (MyEnum)(int)variant1;

Variant variant2 = Variant.From(MyEnum.A);
MyEnum enum2 = variant2.As&lt;MyEnum&gt;();</literal_block>
            </warning>
        </section>
        <section ids="using-variant-in-a-generic-context" names="using\ variant\ in\ a\ generic\ context 在泛型上下文中使用\ variant">
            <title>在泛型上下文中使用 Variant</title>
            <paragraph>在使用泛型时，你可能希望限制泛型 <literal>T</literal> 类型仅为 Variant 兼容类型之一。这可以通过使用 <literal>[MustBeVariant]</literal> 特性来实现。</paragraph>
            <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">public void MethodThatOnlySupportsVariants&lt;[MustBeVariant] T&gt;(T onlyVariant)
{
    // Do something with the Variant-compatible value.
}</literal_block>
            <paragraph>结合泛型 <literal>Variant.From&lt;T&gt;</literal> 可以让你从一个泛型 <literal>T</literal> 类型的实例中获取一个 <literal>Godot.Variant</literal> 的实例。然后它可以用在任何只支持 <literal>Godot.Variant</literal> 结构体的 API 中。</paragraph>
            <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">public void Method1&lt;[MustBeVariant] T&gt;(T variantCompatible)
{
    Variant variant = Variant.From(variantCompatible);
    Method2(variant);
}

public void Method2(Variant variant)
{
    // Do something with variant.
}</literal_block>
            <paragraph>为了调用一个带有泛型参数的方法，该参数用 <literal>[MustBeVariant]</literal> 特性标注，值必须是 Variant 兼容类型或者带有 <literal>[MustBeVariant]</literal> 特性标注的泛型 <literal>T</literal> 类型。</paragraph>
            <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">public class ObjectDerivedClass : GodotObject { }

public class NonObjectDerivedClass { }

public void Main&lt;[MustBeVariant] T1, T2&gt;(T1 someGeneric1, T2 someGeneric2)
{
    MyMethod(42); // Works because `int` is a Variant-compatible type.
    MyMethod(new ObjectDerivedClass()); // Works because any type that derives from `GodotObject` is a Variant-compatible type.
    MyMethod(new NonObjectDerivedClass()); // Does NOT work because the type is not Variant-compatible.
    MyMethod(someGeneric1); // Works because `T1` is annotated with the `[MustBeVariant]` attribute.
    MyMethod(someGeneric2); // Does NOT work because `T2` is NOT annotated with the `[MustBeVariant]` attribute.
}

public void MyMethod&lt;[MustBeVariant] T&gt;(T variant)
{
    // Do something with variant.
}</literal_block>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/zh_CN/?utm_source=widget"><image alt="翻译状态" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/zh_CN/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/zh_CN/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
