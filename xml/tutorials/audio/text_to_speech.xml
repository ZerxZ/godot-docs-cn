<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/audio/text_to_speech.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-text-to-speech"></target>
    <section ids="text-to-speech doc-text-to-speech" names="text\ to\ speech doc_text_to_speech">
        <title>Text to speech</title>
        <section ids="basic-usage" names="basic\ usage">
            <title>Basic Usage</title>
            <paragraph>Basic usage of text-to-speech involves the following one-time steps:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Enable TTS in the Godot editor for your project</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Query the system for a list of usable voices</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Store the ID of the voice you want to use</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>By default, the Godot project-level setting for text-to-speech is disabled, to avoid unnecessary overhead. To enable it:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Go to <strong>Project &gt; Project Settings</strong></paragraph>
                </list_item>
                <list_item>
                    <paragraph>Make sure the <strong>Advanced Settings</strong> toggle is enabled</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Click on <strong>Audio &gt; General</strong></paragraph>
                </list_item>
                <list_item>
                    <paragraph>Ensure the <strong>Text to Speech</strong> option is checked</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Restart Godot if prompted to do so.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>Text-to-speech uses a specific voice. Depending on the user's system, they might have multiple voices installed. Once you have the voice ID, you can use it to speak some text:</paragraph>
            <container classes="sphinx-tabs" type="tab-element">
                <div aria-label="Tabbed content" role="tablist">
                    <button aria-controls="panel-0-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                    <button aria-controls="panel-0-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
                </div>
                <div aria-labelledby="tab-0-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve"># One-time steps.
# Pick a voice. Here, we arbitrarily pick the first English voice.
var voices = DisplayServer.tts_get_voices_for_language("en")
var voice_id = voices[0]

# Say "Hello, world!".
DisplayServer.tts_speak("Hello, world!", voice_id)

# Say a longer sentence, and then interrupt it.
# Note that this method is asynchronous: execution proceeds to the next line immediately,
# before the voice finishes speaking.
var long_message = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur"
DisplayServer.tts_speak(long_message, voice_id)

# Immediately stop the current text mid-sentence and say goodbye instead.
DisplayServer.tts_stop()
DisplayServer.tts_speak("Goodbye!", voice_id)</literal_block>
                </div>
                <div aria-labelledby="tab-0-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-0-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">// One-time steps.
// Pick a voice. Here, we arbitrarily pick the first English voice.
string[] voices = DisplayServer.TtsGetVoicesForLanguage("en");
string voiceId = voices[0];

// Say "Hello, world!".
DisplayServer.TtsSpeak("Hello, world!", voiceId);

// Say a longer sentence, and then interrupt it.
// Note that this method is asynchronous: execution proceeds to the next line immediately,
// before the voice finishes speaking.
string longMessage = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur";
DisplayServer.TtsSpeak(longMessage, voiceId);

// Immediately stop the current text mid-sentence and say goodbye instead.
DisplayServer.TtsStop();
DisplayServer.TtsSpeak("Goodbye!", voiceId);</literal_block>
                </div>
            </container>
        </section>
        <section ids="requirements-for-functionality" names="requirements\ for\ functionality">
            <title>Requirements for functionality</title>
            <paragraph>Godot includes text-to-speech functionality. You can find these under the <reference internal="True" refuri="../../classes/class_displayserver#class-displayserver"><inline classes="std std-ref">DisplayServer class</inline></reference>.</paragraph>
            <paragraph>Godot depends on system libraries for text-to-speech functionality. These libraries are installed by default on Windows, macOS, Web, Android and iOS, but not on all Linux distributions. If they are not present, text-to-speech functionality will not work. Specifically, the <literal>tts_get_voices()</literal> method will return an empty list, indicating that there are no usable voices.</paragraph>
            <paragraph>Both Godot users on Linux and end-users on Linux running Godot games need to ensure that their system includes the system libraries for text-to-speech to work. Please consult the table below or your own distribution's documentation to determine what libraries you need to install.</paragraph>
            <section ids="distro-specific-one-liners" names="distro-specific\ one-liners">
                <title>Distro-specific one-liners</title>
                <table>
                    <tgroup cols="2">
                        <colspec colwidth="18"></colspec>
                        <colspec colwidth="107"></colspec>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph><strong>Arch Linux</strong></paragraph>
                                </entry>
                                <entry>
                                    <literal_block force="False" language="gdscript" linenos="False" xml:space="preserve">pacman -S speech-dispatcher festival espeakup</literal_block>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
            </section>
        </section>
        <section ids="troubleshooting" names="troubleshooting">
            <title>Troubleshooting</title>
            <paragraph>If you get the error <title_reference>Invalid get index '0' (on base: 'PackedStringArray').</title_reference> for the line <title_reference>var voice_id = voices[0]</title_reference>, check if there are any items in <title_reference>voices</title_reference>. If not:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>All users: make sure you enabled <strong>Text to Speech</strong> in project settings</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Linux users: ensure you installed the system-specific libraries for text to speech</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="best-practices" names="best\ practices">
            <title>Best practices</title>
            <paragraph>The best practices for text-to-speech, in terms of the ideal player experience for blind players, is to send output to the player's screen reader. This preserves the choice of language, speed, pitch, etc. that the user set, as well as allows advanced features like allowing players to scroll backward and forward through text. As of now, Godot doesn't provide this level of integration.</paragraph>
            <paragraph>With the current state of the Godot text-to-speech APIs, best practices include:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Develop the game with text-to-speech enabled, and ensure that everything sounds correct</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Allow players to control which voice to use, and save/persist that selection across game sessions</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Allow players to control the speech rate, and save/persist that selection across game sessions</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>This provides your blind players with the most flexibility and comfort available when not using a screen reader, and minimizes the chance of frustrating and alienating them.</paragraph>
        </section>
        <section ids="caveats-and-other-information" names="caveats\ and\ other\ information">
            <title>Caveats and Other Information</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Expect delays when you call <title_reference>tts_speak</title_reference> and <title_reference>tts_stop</title_reference>. The actual delay time varies depending on both the OS and on your machine's specifications. This is especially critical on Android and Web, where some of the voices depend on web services, and the actual time to playback depends on server load, network latency, and other factors.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Non-English text works if the correct voices are installed and used. On Windows, you can consult the instructions in <reference name="this article" refuri="https://www.ghacks.net/2018/08/11/unlock-all-windows-10-tts-voices-system-wide-to-get-more-of-them/">this article</reference> to enable additional language voices on Windows.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Non-ASCII characters, such as umlaut, are pronounced correctly if you select the correct voice.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Blind players use a number of screen readers, including JAWS, NVDA, VoiceOver, Narrator, and more.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Windows text-to-speech APIs generally perform better than their equivalents on other systems (e.g. <title_reference>tts_stop</title_reference> followed by <title_reference>tts_speak</title_reference> immediately speaks the new message).</paragraph>
                </list_item>
            </bullet_list>
            <target ids="this-article" names="this\ article" refuri="https://www.ghacks.net/2018/08/11/unlock-all-windows-10-tts-voices-system-wide-to-get-more-of-them/"></target>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
