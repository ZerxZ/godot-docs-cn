<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.17.1 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/tutorials/ui/bbcode_in_richtextlabel.rst" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-bbcode-in-richtextlabel"></target>
    <section ids="bbcode-in-richtextlabel doc-bbcode-in-richtextlabel" names="bbcode\ in\ richtextlabel richtextlabel\ 中的\ bbcode doc_bbcode_in_richtextlabel">
        <title>RichTextLabel 中的 BBCode</title>
        <section ids="introduction" names="introduction 前言">
            <title>前言</title>
            <paragraph><reference internal="True" refuri="../../classes/class_label#class-label"><inline classes="std std-ref">Label</inline></reference> nodes are great for displaying basic text, but they have limitations.
                If you want to change the color of the text, or its alignment, you can only do that to
                the entire label. You can't make a part of the text have another color, or have a part
                of the text centered. To get around these limitations, you would use a <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel"><inline classes="std std-ref">RichTextLabel</inline></reference>.</paragraph>
            <paragraph><reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel"><inline classes="std std-ref">RichTextLabel</inline></reference> allows for complex formatting of text using a markup syntax or
                the built-in API. It uses BBCodes for the markup syntax, a system of tags that designate
                formatting rules for a part of the text. You may be familiar with them if you ever used
                forums (also known as <title_reference>bulletin boards</title_reference>, hence the "BB" in "BBCode").</paragraph>
            <paragraph>Unlike Label, RichTextLabel also comes with its own vertical scrollbar. This
                scrollbar is automatically displayed if the text does not fit within the
                control's size. The scrollbar can be disabled by unchecking the
                <strong>Scroll Active</strong> property in the RichTextLabel inspector.</paragraph>
            <paragraph>Note that the BBCode tags can also be used to some extent in the XML source of
                the class reference. For more information, see <reference internal="True" refuri="../../contributing/documentation/class_reference_primer#doc-class-reference-primer"><inline classes="std std-ref">类参考入门</inline></reference>.</paragraph>
            <seealso>
                <paragraph>You can see how BBCode in RichTextLabel works in action using the
                    <reference name="Rich Text Label with BBCode demo project" refuri="https://github.com/godotengine/godot-demo-projects/tree/master/gui/rich_text_bbcode">Rich Text Label with BBCode demo project</reference>.</paragraph>
            </seealso>
        </section>
        <section ids="using-bbcode" names="using\ bbcode 使用\ bbcode">
            <title>使用 BBCode</title>
            <paragraph>By default, <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel"><inline classes="std std-ref">RichTextLabel</inline></reference> functions like a normal <reference internal="True" refuri="../../classes/class_label#class-label"><inline classes="std std-ref">Label</inline></reference>.
                It has the <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel-property-text"><inline classes="std std-ref">property_text</inline></reference> property, which you can
                edit to have uniformly formatted text. To be able to use BBCode for rich text formatting,
                you need to turn on the BBCode mode by setting <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel-property-bbcode-enabled"><inline classes="std std-ref">bbcode_enabled</inline></reference>.
                After that, you can edit the <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel-property-text"><inline classes="std std-ref">text</inline></reference>
                property using available tags. Both properties are located at the top of the inspector
                after selecting a RichTextLabel node.</paragraph>
            <image candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_inspector.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_inspector.webp"></image>
            <paragraph>For example, <literal>BBCode [color=green]test[/color]</literal> would render the word "test" with
                a green color.</paragraph>
            <image candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_basic_example.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_basic_example.webp"></image>
            <paragraph>Most BBCodes consist of 3 parts: the opening tag, the content and the closing
                tag. The opening tag delimits the start of the formatted part, and can also
                carry some configuration options. Some opening tags, like the <literal>color</literal> one
                shown above, also require a value to work. Other opening tags may accept
                multiple options (separated by spaces within the opening tag). The closing tag
                delimits the end of the formatted part. In some cases, both the closing tag and
                the content can be omitted.</paragraph>
            <paragraph>Unlike BBCode in HTML, leading/trailing whitespace is not removed by a
                RichTextLabel upon display. Duplicate spaces are also displayed as-is in the
                final output. This means that when displaying a code block in a RichTextLabel,
                you don't need to use a preformatted text tag.</paragraph>
            <literal_block force="False" highlight_args="{}" language="none" linenos="False" xml:space="preserve">[tag]content[/tag]
[tag=value]content[/tag]
[tag option1=value1 option2=value2]content[/tag]
[tag][/tag]
[tag]</literal_block>
            <note>
                <paragraph>RichTextLabel doesn't support entangled BBCode tags. For example, instead of
                    using:</paragraph>
                <literal_block force="False" language="gdscript" linenos="False" xml:space="preserve">[b]bold[i]bold italic[/b]italic[/i]</literal_block>
                <paragraph>请使用：</paragraph>
                <literal_block force="False" language="gdscript" linenos="False" xml:space="preserve">[b]bold[i]bold italic[/i][/b][i]italic[/i]</literal_block>
            </note>
            <target refid="doc-bbcode-in-richtextlabel-handling-user-input-safely"></target>
        </section>
        <section ids="handling-user-input-safely doc-bbcode-in-richtextlabel-handling-user-input-safely" names="handling\ user\ input\ safely 安全地处理用户输入 doc_bbcode_in_richtextlabel_handling_user_input_safely">
            <title>安全地处理用户输入</title>
            <paragraph>In a scenario where users may freely input text (such as chat in a multiplayer
                game), you should make sure users cannot use arbitrary BBCode tags that will be
                parsed by RichTextLabel. This is to avoid inappropriate use of formatting, which
                can be problematic if <literal>[url]</literal> tags are handled by your RichTextLabel (as players
                may be able to create clickable links to phishing sites or similar).</paragraph>
            <paragraph>Using RichTextLabel's <literal>[lb]</literal> and/or <literal>[rb]</literal> tags, we can replace the opening and/or
                closing brackets of any BBCode tag in a message with those escaped tags. This
                prevents users from using BBCode that will be parsed as tags – instead, the
                BBCode will be displayed as text.</paragraph>
            <figure align="center" ids="id1">
                <image alt="Example of unescaped user input resulting in BBCode injection (2nd line) and escaped user input (3rd line)" candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_escaping_user_input.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_escaping_user_input.webp"></image>
                <caption>Example of unescaped user input resulting in BBCode injection (2nd line) and escaped user input (3rd line)</caption>
            </figure>
            <paragraph>创建一个 Node 节点并附加下面的脚本：</paragraph>
            <literal_block force="False" language="gdscript" linenos="False" xml:space="preserve">extends RichTextLabel

func _ready():
    append_chat_line("Player 1", "Hello world!")
    append_chat_line("Player 2", "Hello [color=red]BBCode injection[/color] (no escaping)!")
    append_chat_line_escaped("Player 2", "Hello [color=red]BBCode injection[/color] (with escaping)!")


# Returns escaped BBCode that won't be parsed by RichTextLabel as tags.
func escape_bbcode(bbcode_text):
    # We only need to replace opening brackets to prevent tags from being parsed.
    return bbcode_text.replace("[", "[lb]")


# Appends the user's message as-is, without escaping. This is dangerous!
func append_chat_line(username, message):
    append_text("%s: [color=green]%s[/color]\n" % [username, message])


# Appends the user's message with escaping.
# Remember to escape both the player name and message contents.
func append_chat_line_escaped(username, message):
    append_text("%s: [color=green]%s[/color]\n" % [escape_bbcode(username), escape_bbcode(message)])</literal_block>
        </section>
        <section ids="stripping-bbcode-tags" names="stripping\ bbcode\ tags 剥离\ bbcode\ 标签">
            <title>剥离 BBCode 标签</title>
            <paragraph>For certain use cases, it can be desired to remove BBCode tags from the string.
                This is useful when displaying the RichTextLabel's text in another Control that
                does not support BBCode (such as a tooltip):</paragraph>
            <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">extends RichTextLabel

func _ready():
    var regex = RegEx.new()
    regex.compile("\\[.*?\\]")
    var text_without_tags = regex.sub(text, "", true)
    # `text_without_tags` contains the text with all BBCode tags removed.</literal_block>
            <note>
                <paragraph>Removing BBCode tags entirely isn't advised for user input, as it can
                    modify the displayed text without users understanding why part of their
                    message was removed.
                    <reference internal="True" refid="doc-bbcode-in-richtextlabel-handling-user-input-safely"><inline classes="std std-ref">Escaping user input</inline></reference>
                    should be preferred instead.</paragraph>
            </note>
        </section>
        <section ids="performance" names="performance 性能">
            <title>性能</title>
            <paragraph>In most cases, you can use BBCode directly as-is since text formatting is rarely
                a heavy task. However, with particularly large RichTextLabels (such as console
                logs spanning thousands of lines), you may encounter stuttering during gameplay
                when the RichTextLabel's text is updated.</paragraph>
            <paragraph>There are several ways to alleviate this:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Use the <literal>append_text()</literal> function instead of appending to the <literal>text</literal>
                        property. This function will only parse BBCode for the added text, rather than
                        parsing BBCode from the entire <literal>text</literal> property.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Use <literal>push_[tag]()</literal> and <literal>pop()</literal> functions to add tags to RichTextLabel instead of
                        using BBCode.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Enable the <strong>Threading &gt; Threaded</strong> property in RichTextLabel. This won't
                        speed up processing, but it will prevent the main thread from blocking, which
                        avoids stuttering during gameplay. Only enable threading if it's actually
                        needed in your project, as threading has some overhead.</paragraph>
                </list_item>
            </bullet_list>
            <target refid="doc-bbcode-in-richtextlabel-use-functions"></target>
        </section>
        <section ids="using-push-tag-and-pop-functions-instead-of-bbcode doc-bbcode-in-richtextlabel-use-functions" names="using\ push_[tag]()\ and\ pop()\ functions\ instead\ of\ bbcode 使用\ push_[标签]()\ 和\ pop()\ 函数代替\ bbcode doc_bbcode_in_richtextlabel_use_functions">
            <title>使用 push_[标签]() 和 pop() 函数代替 BBCode</title>
            <paragraph>If you don't want to use BBCode for performance reasons, you can use functions
                provided by RichTextLabel to create formatting tags without writing BBCode in
                the text.</paragraph>
            <paragraph>Every BBCode tag (including effects) has a <literal>push_[tag]()</literal> function (where
                <literal>[tag]</literal> is the tag's name). There are also a few convenience functions
                available, such as <literal>push_bold_italics()</literal> that combines both <literal>push_bold()</literal>
                and <literal>push_italics()</literal> into a single tag. See the
                <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel"><inline classes="std std-ref">RichTextLabel class reference</inline></reference> for a complete list of
                <literal>push_[tag]()</literal> functions.</paragraph>
            <paragraph>The <literal>pop()</literal> function is used to end <emphasis>any</emphasis> tag. Since BBCode is a tag <emphasis>stack</emphasis>,
                using <literal>pop()</literal> will close the most recently started tags first.</paragraph>
            <paragraph>The following script will result in the same visual output as using
                <literal>BBCode [color=green]test [i]example[/i][/color]</literal>:</paragraph>
            <literal_block force="False" language="gdscript" linenos="False" xml:space="preserve">extends RichTextLabel

func _ready():
    append_text("BBCode ")  # Trailing space separates words from each other.
    push_color(Color.GREEN)
    append_text("test ")  # Trailing space separates words from each other.
    push_italics()
    append_text("example")
    pop()  # Ends the tag opened by `push_italics()`.
    pop()  # Ends the tag opened by `push_color()`.</literal_block>
            <warning>
                <paragraph>Do <strong>not</strong> set the <literal>text</literal> property directly when using formatting functions.
                    Appending to the <literal>text</literal> property will erase all modifications made to the
                    RichTextLabel using the <literal>append_text()</literal>, <literal>push_[tag]()</literal> and <literal>pop()</literal>
                    functions.</paragraph>
            </warning>
        </section>
        <section ids="reference" names="reference 参考">
            <title>参考</title>
            <table classes="colwidths-given wrap-normal" width="100%">
                <tgroup cols="2">
                    <colspec colwidth="60"></colspec>
                    <colspec colwidth="40"></colspec>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph>标签</paragraph>
                            </entry>
                            <entry>
                                <paragraph>示例</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>b</strong></line>
                                    <line>Makes <literal>{text}</literal> use the bold (or bold italics) font of <literal>RichTextLabel</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[b]{text}[/b]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>i</strong></line>
                                    <line>Makes <literal>{text}</literal> use the italics (or bold italics) font of <literal>RichTextLabel</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[i]{text}[/i]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>u</strong></line>
                                    <line>在 <literal>{text}</literal> 上显示下划线。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[u]{text}[/u]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>s</strong></line>
                                    <line>在 <literal>{text}</literal> 上显示删除线。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[s]{text}[/s]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>code</strong></line>
                                    <line>让 <literal>{text}</literal> 使用 <literal>RichTextLabel</literal> 的等宽字体。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[code]{text}[/code]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>p</strong></line>
                                    <line>Adds new paragraph with <literal>{text}</literal>. Supports configuration options,
                                        see <reference internal="True" refid="doc-bbcode-in-richtextlabel-paragraph-options"><inline classes="std std-ref">段落选项</inline></reference>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[p]{text}[/p]</literal></line>
                                    <line><literal>[p {options}]{text}[/p]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>center</strong></line>
                                    <line>Makes <literal>{text}</literal> horizontally centered.</line>
                                    <line>Same as <literal>[p align=center]</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[center]{text}[/center]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>left</strong></line>
                                    <line>Makes <literal>{text}</literal> horizontally left-aligned.</line>
                                    <line>Same as <literal>[p align=left]</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[left]{text}[/left]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>right</strong></line>
                                    <line>Makes <literal>{text}</literal> horizontally right-aligned.</line>
                                    <line>Same as <literal>[p align=right]</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[right]{text}[/right]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>fill</strong></line>
                                    <line>Makes <literal>{text}</literal> fill the full width of <literal>RichTextLabel</literal>.</line>
                                    <line>Same as <literal>[p align=fill]</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[fill]{text}[/fill]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>indent</strong></line>
                                    <line>Indents <literal>{text}</literal> once.
                                        The indentation width is the same as with <literal>[ul]</literal> or <literal>[ol]</literal>, but without a bullet point.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[indent]{text}[/indent]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>url</strong></line>
                                    <line>Creates a hyperlink (underlined and clickable text). Can contain optional
                                        <literal>{text}</literal> or display <literal>{link}</literal> as is.</line>
                                    <line><strong>Must be handled with the "meta_clicked" signal to have an effect,</strong> see <reference internal="True" refid="doc-bbcode-in-richtextlabel-handling-url-tag-clicks"><inline classes="std std-ref">处理 [url] 标签点击</inline></reference>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[url]{link}[/url]</literal></line>
                                    <line><literal>[url={link}]{text}[/url]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>hint</strong></line>
                                    <line>Creates a tooltip hint that is displayed when hovering the text with the mouse.
                                        Tooltip text should not be quoted (quotes will appear as-is in the tooltip otherwise).</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[hint={tooltip text displayed on hover}]{text}[/hint]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>img</strong></line>
                                    <line>Inserts an image from the <literal>{path}</literal> (can be any valid <reference internal="True" refuri="../../classes/class_texture2d#class-texture2d"><inline classes="std std-ref">Texture2D</inline></reference> resource).</line>
                                    <line>If <literal>{width}</literal> is provided, the image will try to fit that width maintaining
                                        the aspect ratio.</line>
                                    <line>If both <literal>{width}</literal> and <literal>{height}</literal> are provided, the image will be scaled
                                        to that size.</line>
                                    <line>If <literal>{valign}</literal> configuration is provided, the image will try to align to the
                                        surrounding text, see <reference internal="True" refid="doc-bbcode-in-richtextlabel-image-alignment"><inline classes="std std-ref">图像的垂直对齐</inline></reference>.</line>
                                    <line>Supports configuration options, see <reference internal="True" refid="doc-bbcode-in-richtextlabel-image-options"><inline classes="std std-ref">图像选项</inline></reference>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[img]{path}[/img]</literal></line>
                                    <line><literal>[img={width}]{path}[/img]</literal></line>
                                    <line><literal>[img={width}x{height}]{path}[/img]</literal></line>
                                    <line><literal>[img={valign}]{path}[/img]</literal></line>
                                    <line><literal>[img {options}]{path}[/img]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>font</strong></line>
                                    <line>Makes <literal>{text}</literal> use a font resource from the <literal>{path}</literal>.</line>
                                    <line>Supports configuration options, see <reference internal="True" refid="doc-bbcode-in-richtextlabel-font-options"><inline classes="std std-ref">字体选项</inline></reference>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[font={path}]{text}[/font]</literal></line>
                                    <line><literal>[font {options}]{text}[/font]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>font_size</strong></line>
                                    <line>Use custom font size for <literal>{text}</literal>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[font_size={size}]{text}[/font_size]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>dropcap</strong></line>
                                    <line>Use a different font size and color for <literal>{text}</literal>, while making the tag's contents
                                        span multiple lines if it's large enough.</line>
                                    <line>A <reference name="drop cap" refuri="https://www.computerhope.com/jargon/d/dropcap.htm">drop cap</reference> is typically one
                                        uppercase character, but <literal>[dropcap]</literal> supports containing multiple characters.
                                        <literal>margins</literal> values are comma-separated and can be positive, zero or negative.
                                        Negative top and bottom margins are particularly useful to allow the rest of
                                        the paragraph to display below the dropcap.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[dropcap font_size={size} color={color} margins={left},{top},{right},{bottom}]{text}[/dropcap]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>opentype_features</strong></line>
                                    <line>为 <literal>{text}</literal> 启用自定义 OpenType 字体特性。<literal>{list}</literal> 中的特性必须以英文逗号分隔。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[opentype_features={list}]</literal></line>
                                    <line><literal>{text}</literal></line>
                                    <line><literal>[/opentype_features]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>lang</strong></line>
                                    <line>Overrides the language for <literal>{text}</literal> that is set by the <strong>BiDi &gt; Language</strong> property
                                        in <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel"><inline classes="std std-ref">RichTextLabel</inline></reference>. <literal>{code}</literal> must be an ISO <reference internal="True" refuri="../i18n/locales#doc-locales"><inline classes="std std-ref">language code</inline></reference>.
                                        This can be used to enforce the use of a specific script for a language without
                                        starting a new paragraph. Some font files may contain script-specific substitutes,
                                        in which case they will be used.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[lang={code}]{text}[/lang]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>color</strong></line>
                                    <line>修改 <literal>{text}</literal> 的颜色。设置的颜色必须使用通用名称（见 <reference internal="True" refid="doc-bbcode-in-richtextlabel-named-colors"><inline classes="std std-ref">具名颜色</inline></reference>）或十六进制格式（例如 <literal>#ff00ff</literal>，见 <reference internal="True" refid="doc-bbcode-in-richtextlabel-hex-colors"><inline classes="std std-ref">十六进制颜色代码</inline></reference>）。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[color={code/name}]{text}[/color]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>bgcolor</strong></line>
                                    <line>在 <literal>{text}</literal> 背后绘制的颜色。可以用来高亮文本。接受的值和 <literal>color</literal> 标签一致。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[bgcolor={code/name}]{text}[/bgcolor]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>fgcolor</strong></line>
                                    <line>在 <literal>{text}</literal> 前方绘制的颜色。使用不透明的前景色可以“遮盖”文本。接受的值和 <literal>color</literal> 标签一致。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[fgcolor={code/name}]{text}[/fgcolor]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>outline_size</strong></line>
                                    <line>为 <literal>{text}</literal> 使用自定义字体轮廓大小。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[outline_size={size}]</literal></line>
                                    <line><literal>{text}</literal></line>
                                    <line><literal>[/outline_size]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>outline_color</strong></line>
                                    <line>为 <literal>{text}</literal> 使用自定义轮廓颜色。接受的值和 <literal>color</literal> 标签一致。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[outline_color={code/name}]</literal></line>
                                    <line><literal>{text}</literal></line>
                                    <line><literal>[/outline_color]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>table</strong></line>
                                    <line>创建列数为 <literal>{number}</literal> 的表格。定义表格中的单元格请使用 <literal>cell</literal> 标签。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[table={number}]{cells}[/table]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>cell</strong></line>
                                    <line>向表格中添加一个文本为 <literal>{text}</literal> 的单元格。</line>
                                    <line>If <literal>{ratio}</literal> is provided, the cell will try to expand to that value proportionally
                                        to other cells and their ratio values.</line>
                                    <line>Supports configuration options, see <reference internal="True" refid="doc-bbcode-in-richtextlabel-cell-options"><inline classes="std std-ref">单元格选项</inline></reference>.</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[cell]{text}[/cell]</literal></line>
                                    <line><literal>[cell={ratio}]{text}[/cell]</literal></line>
                                    <line><literal>[cell {options}]{text}[/cell]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>ul</strong></line>
                                    <line>添加无序列表。列表项 <literal>{item}</literal> 必须以一行一个的形式提供。</line>
                                    <line>项目符号可以使用 <literal>{bullet}</literal> 参数自定义，见 <reference internal="True" refid="doc-bbcode-in-richtextlabel-unordered-list-bullet"><inline classes="std std-ref">无序列表项目符号</inline></reference>。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[ul]{items}[/ul]</literal></line>
                                    <line><literal>[ul bullet={bullet}]{items}[/ul]</literal></line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>ol</strong></line>
                                    <line>添加有序（编号）列表，类型由 <literal>{type}</literal> 给定（见 <reference internal="True" refid="doc-bbcode-in-richtextlabel-list-types"><inline classes="std std-ref">有序列表类型</inline></reference>）。列表项 <literal>{items}</literal> 必须以一行一个的形式提供。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <paragraph><literal>[ol type={type}]{items}[/ol]</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line><strong>lb</strong>、<strong>rb</strong></line>
                                    <line>分别添加 <literal>[</literal> 和 <literal>]</literal>。用于转义 BBCode 标记。</line>
                                    <line>这些是自闭合标签，不需要手动关闭（不存在 <literal>[/lb]</literal> 和 <literal>[/rb]</literal> 这种关闭标签）。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[lb]b[rb]text[lb]/b[rb]</literal> 会被显示为 <literal>[b]text[/b]</literal>。</line>
                                </line_block>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <line_block>
                                    <line>部分 Unicode 控制字符可以使用对应的自闭合标签添加。</line>
                                    <line>相比于直接在文本中粘贴这些控制字符，</line>
                                    <line>这种方法更方便维护。</line>
                                </line_block>
                            </entry>
                            <entry>
                                <line_block>
                                    <line><literal>[lrm]</literal> (left-to-right mark), <literal>[rlm]</literal> (right-to-left mark), <literal>[lre]</literal> (left-to-right embedding),</line>
                                    <line><literal>[rle]</literal> (right-to-left embedding), <literal>[lro]</literal> (left-to-right override), <literal>[rlo]</literal> (right-to-left override),</line>
                                    <line><literal>[pdf]</literal> (pop directional formatting), <literal>[alm]</literal> (Arabic letter mark), <literal>[lri]</literal> (left-to-right isolate),</line>
                                    <line><literal>[rli]</literal> (right-to-left isolate), <literal>[fsi]</literal> (first strong isolate), <literal>[pdi]</literal> (pop directional isolate),</line>
                                    <line><literal>[zwj]</literal> (zero-width joiner), <literal>[zwnj]</literal> (zero-width non-joiner), <literal>[wj]</literal> (word joiner),</line>
                                    <line><literal>[shy]</literal> (soft hyphen)</line>
                                </line_block>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <note>
                <paragraph>Tags for bold (<literal>[b]</literal>) and italics (<literal>[i]</literal>) formatting work best if the
                    appropriate custom fonts are set up in the RichTextLabelNode's theme
                    overrides. If no custom bold or italic fonts are defined,
                    <reference name="faux bold and italic fonts" refuri="https://fonts.google.com/knowledge/glossary/faux_fake_pseudo_synthesized">faux bold and italic fonts</reference>
                    will be generated by Godot. These fonts rarely look good in comparison to hand-made bold/italic font variants.</paragraph>
                <paragraph>The monospaced (<literal>[code]</literal>) tag <strong>only</strong> works if a custom font is set up in
                    the RichTextLabel node's theme overrides. Otherwise, monospaced text will use the regular font.</paragraph>
                <paragraph>目前还没有用于控制文本垂直居中的BBCode标签.</paragraph>
                <paragraph>Options can be skipped for all tags.</paragraph>
            </note>
            <target refid="doc-bbcode-in-richtextlabel-paragraph-options"></target>
            <section ids="paragraph-options doc-bbcode-in-richtextlabel-paragraph-options" names="paragraph\ options 段落选项 doc_bbcode_in_richtextlabel_paragraph_options">
                <title>段落选项</title>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph><strong>align</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph><literal>left</literal>、<literal>center</literal>、<literal>right</literal>、<literal>fill</literal></paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph><literal>left</literal></paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>文本水平对齐。</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>bidi_override</strong>、<strong>st</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="75"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph><literal>default</literal>、<literal>uri</literal>、<literal>file</literal>、<literal>email</literal>、<literal>list</literal>、<literal>none</literal>、<literal>custom</literal></paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph><literal>default</literal></paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>Structured text override.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>direction</strong>、<strong>dir</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph><literal>ltr</literal>、<literal>rtl</literal>、<literal>auto</literal></paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>Base BiDi direction.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>language</strong>、<strong>lang</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>ISO 语言代码。见 <reference internal="True" refuri="../i18n/locales#doc-locales"><inline classes="std std-ref">区域设置代码</inline></reference></paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>Locale override. Some font files may contain script-specific substitutes, in which case they will be used.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>tab_stops</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="52"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>List of floating-point numbers, e.g. <literal>10.0,30.0</literal></paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>Width of the space character in the font</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>Overrides the horizontal offsets for each tab character. When the end of the
                            list is reached, the tab stops will loop over. For example, if you set
                            <literal>tab_stops</literal> to <literal>10.0,30.0</literal>, the first tab will be at <literal>10</literal> pixels, the
                            second tab will be at <literal>10 + 30 = 40</literal> pixels, and the third tab will be at
                            <literal>10 + 30 + 10 = 50</literal> pixels from the origin of the RichTextLabel.</paragraph>
                    </list_item>
                </bullet_list>
                <target refid="doc-bbcode-in-richtextlabel-handling-url-tag-clicks"></target>
            </section>
            <section ids="handling-url-tag-clicks doc-bbcode-in-richtextlabel-handling-url-tag-clicks" names="handling\ [url]\ tag\ clicks 处理\ [url]\ 标签点击 doc_bbcode_in_richtextlabel_handling_url_tag_clicks">
                <title>处理 <literal>[url]</literal> 标签点击</title>
                <paragraph>默认情况下， <literal>[url]</literal> 标签在单击时不执行任何操作.这是为了允许灵活使用 <literal>[url]</literal> 标签，而不是限制它们在Web浏览器中打开URL.</paragraph>
                <paragraph>To handle clicked <literal>[url]</literal> tags, connect the <literal>RichTextLabel</literal> node's
                    <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel-signal-meta-clicked"><inline classes="std std-ref">meta_clicked</inline></reference> signal to a script function.</paragraph>
                <paragraph>例如，将如下方法连接到 <literal>meta_clicked</literal> 上即可在用户的默认网页浏览器中打开被点击的 URL：</paragraph>
                <literal_block force="False" language="gdscript" linenos="False" xml:space="preserve"># This assumes RichTextLabel's `meta_clicked` signal was connected to
# the function below using the signal connection dialog.
func _richtextlabel_on_meta_clicked(meta):
    # `meta` is not guaranteed to be a String, so convert it to a String
    # to avoid script errors at run-time.
    OS.shell_open(str(meta))</literal_block>
                <paragraph>要支持更高级的用法，也可以在 <literal>[url]</literal> 标签的选项中存储 JSON，然后在处理 <literal>meta_clicked</literal> 信号的函数中解析。例如：</paragraph>
                <literal_block force="False" highlight_args="{}" language="none" linenos="False" xml:space="preserve">[url={"example": "value"}]JSON[/url]</literal_block>
                <target refid="doc-bbcode-in-richtextlabel-image-options"></target>
            </section>
            <section ids="image-options doc-bbcode-in-richtextlabel-image-options" names="image\ options 图像选项 doc_bbcode_in_richtextlabel_image_options">
                <title>图像选项</title>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph><strong>color</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>颜色名称或十六进制格式的颜色</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>图像的着色颜色（调制）。</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>height</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>数字，单位为像素</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>图像的目标高度。</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>width</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>数字，单位为像素</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>图像的目标宽度。</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>region</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>x,y,width,height in pixels</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>图像的区域框。可用于显示精灵表中的单个图像。</paragraph>
                    </list_item>
                </bullet_list>
                <target refid="doc-bbcode-in-richtextlabel-image-alignment"></target>
            </section>
            <section ids="image-vertical-alignment doc-bbcode-in-richtextlabel-image-alignment" names="image\ vertical\ alignment 图像的垂直对齐 doc_bbcode_in_richtextlabel_image_alignment">
                <title>图像的垂直对齐</title>
                <paragraph>When a vertical alignment value is provided with the <literal>[img]</literal> tag the image
                    will try to align itself against the surrounding text. Alignment is performed
                    using a vertical point of the image and a vertical point of the text. There are
                    3 possible points on the image (<literal>top</literal>, <literal>center</literal>, and <literal>bottom</literal>) and 4
                    possible points on the text (<literal>top</literal>, <literal>center</literal>, <literal>baseline</literal>, and <literal>bottom</literal>),
                    which can be used in any combination.</paragraph>
                <paragraph>To specify both points, use their full or short names as a value of the image tag:</paragraph>
                <literal_block force="False" highlight_args="{}" language="none" linenos="False" xml:space="preserve">[img=top,bottom]
[img=center,center]</literal_block>
                <paragraph>You can also specify just one value (<literal>top</literal>, <literal>center</literal>, or <literal>bottom</literal>) to make
                    use of a corresponding preset (<literal>top-top</literal>, <literal>center-center</literal>, and <literal>bottom-bottom</literal>
                    respectively).</paragraph>
                <paragraph>Short names for the values are <literal>t</literal> (<literal>top</literal>), <literal>c</literal> (<literal>center</literal>), <literal>l</literal> (<literal>baseline</literal>),
                    and <literal>b</literal> (<literal>bottom</literal>).</paragraph>
                <target refid="doc-bbcode-in-richtextlabel-font-options"></target>
            </section>
            <section ids="font-options doc-bbcode-in-richtextlabel-font-options" names="font\ options 字体选项 doc_bbcode_in_richtextlabel_font_options">
                <title>字体选项</title>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph><strong>name</strong>、<strong>n</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>有效的 Font 资源路径。</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>字体资源路径。</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>size</strong>、<strong>s</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>数字，单位为像素。</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>自定义字体大小。</paragraph>
                    </list_item>
                </bullet_list>
                <target refid="doc-bbcode-in-richtextlabel-named-colors"></target>
            </section>
            <section ids="named-colors doc-bbcode-in-richtextlabel-named-colors" names="named\ colors 具名颜色 doc_bbcode_in_richtextlabel_named_colors">
                <title>具名颜色</title>
                <paragraph>For tags that allow specifying a color by name you can use names of the constants from
                    the built-in <reference internal="True" refuri="../../classes/class_color#class-color"><inline classes="std std-ref">Color</inline></reference> class. Named classes can be specified in a number of
                    styles using different casings: <literal>DARK_RED</literal>, <literal>DarkRed</literal>, and <literal>darkred</literal> will give
                    the same exact result.</paragraph>
                <target refid="doc-bbcode-in-richtextlabel-hex-colors"></target>
            </section>
            <section ids="hexadecimal-color-codes doc-bbcode-in-richtextlabel-hex-colors" names="hexadecimal\ color\ codes 十六进制颜色代码 doc_bbcode_in_richtextlabel_hex_colors">
                <title>十六进制颜色代码</title>
                <paragraph>For opaque RGB colors, any valid 6-digit hexadecimal code is supported, e.g.
                    <literal>[color=#ffffff]white[/color]</literal>. Shorthand RGB color codes such as <literal>#6f2</literal>
                    (equivalent to <literal>#66ff22</literal>) are also supported.</paragraph>
                <paragraph>For transparent RGB colors, any RGBA 8-digit hexadecimal code can be used,
                    e.g. <literal>[color=#ffffff88]translucent white[/color]</literal>. Note that the alpha channel
                    is the <strong>last</strong> component of the color code, not the first one. Short RGBA
                    color codes such as <literal>#6f28</literal> (equivalent to <literal>#66ff2288</literal>) are supported as well.</paragraph>
                <target refid="doc-bbcode-in-richtextlabel-cell-options"></target>
            </section>
            <section ids="cell-options doc-bbcode-in-richtextlabel-cell-options" names="cell\ options 单元格选项 doc_bbcode_in_richtextlabel_cell_options">
                <title>单元格选项</title>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph><strong>expand</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>整数</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>1</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>Cell expansion ratio. This defines which cells will try to expand to
                            proportionally to other cells and their expansion ratios.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>border</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>颜色名称或十六进制格式的颜色</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>单元格边框颜色。</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>bg</strong></paragraph>
                        <table>
                            <tgroup cols="2">
                                <colspec colwidth="11"></colspec>
                                <colspec colwidth="44"></colspec>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>值</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>颜色名称或十六进制格式的颜色</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><title_reference>默认</title_reference></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>继承</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                        <paragraph>Cell background color. For alternating odd/even row backgrounds,
                            you can use <literal>bg=odd_color,even_color</literal>.</paragraph>
                    </list_item>
                </bullet_list>
                <target refid="doc-bbcode-in-richtextlabel-unordered-list-bullet"></target>
            </section>
            <section ids="unordered-list-bullet doc-bbcode-in-richtextlabel-unordered-list-bullet" names="unordered\ list\ bullet 无序列表项目符号 doc_bbcode_in_richtextlabel_unordered_list_bullet">
                <title>无序列表项目符号</title>
                <paragraph>By default, the <literal>[ul]</literal> tag uses the <literal>U+2022</literal> "Bullet" Unicode glyph as the
                    bullet character. This behavior is similar to web browsers. The bullet character
                    can be customized using <literal>[ul bullet={bullet}]</literal>. If provided, this <literal>{bullet}</literal>
                    parameter must be a <emphasis>single</emphasis> character with no enclosing quotes (for example,
                    <literal>[bullet=*]</literal>). Additional characters are ignored. The bullet character's
                    width does not affect the list's formatting.</paragraph>
                <paragraph>See <reference name="Bullet (typography) on Wikipedia" refuri="https://en.wikipedia.org/wiki/Bullet_(typography)">Bullet (typography) on Wikipedia</reference>
                    for a list of common bullet characters that you can paste directly in the <literal>bullet</literal> parameter.</paragraph>
                <target refid="doc-bbcode-in-richtextlabel-list-types"></target>
            </section>
            <section ids="ordered-list-types doc-bbcode-in-richtextlabel-list-types" names="ordered\ list\ types 有序列表类型 doc_bbcode_in_richtextlabel_list_types">
                <title>有序列表类型</title>
                <paragraph>Ordered lists can be used to automatically mark items with numbers
                    or letters in ascending order. This tag supports the following
                    type options:</paragraph>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph><literal>1</literal> - Numbers, using language specific numbering system if possible.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>a</literal>, <literal>A</literal> - Lower and upper case Latin letters.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>i</literal>, <literal>I</literal> - Lower and upper case Roman numerals.</paragraph>
                    </list_item>
                </bullet_list>
            </section>
        </section>
        <section ids="text-effects" names="text\ effects 文本效果">
            <title>文本效果</title>
            <paragraph>BBCode can also be used to create different text effects that can optionally be
                animated. Five customizable effects are provided out of the box, and you can
                easily create your own. By default, animated effects will pause
                <reference internal="True" refuri="../scripting/pausing_games#doc-pausing-games"><inline classes="std std-ref">when the SceneTree is paused</inline></reference>. You can change this
                behavior by adjusting the RichTextLabel's <strong>Process &gt; Mode</strong> property.</paragraph>
            <paragraph>All examples below mention the default values for options in the listed tag format.</paragraph>
            <note>
                <paragraph>Text effects that move characters' position may result in characters being
                    clipped by the RichTextLabel node bounds.</paragraph>
                <paragraph>You can resolve this by disabling <strong>Control &gt; Layout &gt; Clip Contents</strong> in
                    the inspector after selecting the RichTextLabel node, or ensuring there is
                    enough margin added around the text by using line breaks above and below the
                    line using the effect.</paragraph>
            </note>
            <section ids="pulse" names="pulse 脉冲">
                <title>脉冲</title>
                <image candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_effect_pulse.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_effect_pulse.webp"></image>
                <paragraph>Pulse creates an animated pulsing effect that multiplies each character's
                    opacity and color. It can be used to bring attention to specific text. Its tag
                    format is <literal>[pulse freq=1.0 color=#ffffff40 ease=-2.0]{text}[/pulse]</literal>.</paragraph>
                <paragraph><literal>freq</literal> controls the frequency of the half-pulsing cycle (higher is faster). A
                    full pulsing cycle takes <literal>2 * (1.0 / freq)</literal> seconds. <literal>color</literal> is the target
                    color multiplier for blinking. The default mostly fades out text, but not
                    entirely. <literal>ease</literal> is the easing function exponent to use. Negative values
                    provide in-out easing, which is why the default is <literal>-2.0</literal>.</paragraph>
            </section>
            <section ids="wave" names="wave 波浪">
                <title>波浪</title>
                <image candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_effect_wave.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_effect_wave.webp"></image>
                <paragraph>Wave makes the text go up and down. Its tag format is
                    <literal>[wave amp=50.0 freq=5.0 connected=1]{text}[/wave]</literal>.</paragraph>
                <paragraph><literal>amp</literal> controls how high and low the effect goes, and <literal>freq</literal> controls how
                    fast the text goes up and down. A <literal>freq</literal> value of <literal>0</literal> will result in no
                    visible waves, and negative <literal>freq</literal> values won't display any waves either. If
                    <literal>connected</literal> is <literal>1</literal> (default), glyphs with ligatures will be moved together.
                    If <literal>connected</literal> is <literal>0</literal>, each glyph is moved individually even if they are
                    joined by ligatures. This can work around certain rendering issues with font
                    ligatures.</paragraph>
            </section>
            <section ids="tornado" names="tornado 旋风">
                <title>旋风</title>
                <image candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_effect_tornado.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_effect_tornado.webp"></image>
                <paragraph>Tornado makes the text move around in a circle. Its tag format is
                    <literal>[tornado radius=10.0 freq=1.0 connected=1]{text}[/tornado]</literal>.</paragraph>
                <paragraph><literal>radius</literal> is the radius of the circle that controls the offset, <literal>freq</literal> is how
                    fast the text moves in a circle. A <literal>freq</literal> value of <literal>0</literal> will pause the
                    animation, while negative <literal>freq</literal> will play the animation backwards. If
                    <literal>connected</literal> is <literal>1</literal> (default), glyphs with ligatures will be moved together.
                    If <literal>connected</literal> is <literal>0</literal>, each glyph is moved individually even if they are
                    joined by ligatures. This can work around certain rendering issues with font
                    ligatures.</paragraph>
            </section>
            <section ids="shake" names="shake 抖动">
                <title>抖动</title>
                <image candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_effect_shake.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_effect_shake.webp"></image>
                <paragraph>Shake makes the text shake. Its tag format is
                    <literal>[shake rate=20.0 level=5 connected=1]{text}[/shake]</literal>.</paragraph>
                <paragraph><literal>rate</literal> controls how fast the text shakes, <literal>level</literal> controls how far the text
                    is offset from the origin. If <literal>connected</literal> is <literal>1</literal> (default), glyphs with
                    ligatures will be moved together. If <literal>connected</literal> is <literal>0</literal>, each glyph is moved
                    individually even if they are joined by ligatures. This can work around certain
                    rendering issues with font ligatures.</paragraph>
            </section>
            <section ids="fade" names="fade 渐隐">
                <title>渐隐</title>
                <image candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_effect_fade.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_effect_fade.webp"></image>
                <paragraph>Fade creates a static fade effect that multiplies each character's opacity.
                    Its tag format is <literal>[fade start=4 length=14]{text}[/fade]</literal>.</paragraph>
                <paragraph><literal>start</literal> controls the starting position of the falloff relative to where the fade
                    command is inserted, <literal>length</literal> controls over how many characters should the fade
                    out take place.</paragraph>
            </section>
            <section ids="rainbow" names="rainbow 彩虹">
                <title>彩虹</title>
                <image candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_effect_rainbow.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_effect_rainbow.webp"></image>
                <paragraph>Rainbow gives the text a rainbow color that changes over time. Its tag format is
                    <literal>[rainbow freq=1.0 sat=0.8 val=0.8]{text}[/rainbow]</literal>.</paragraph>
                <paragraph><literal>freq</literal> is the number of full rainbow cycles per second, <literal>sat</literal> is the
                    saturation of the rainbow, <literal>val</literal> is the value of the rainbow. A <literal>freq</literal> value
                    of <literal>0</literal> will pause the animation, while negative <literal>freq</literal> will play the
                    animation backwards.</paragraph>
                <paragraph>Font outlines are <emphasis>not</emphasis> affected by the rainbow effect (they keep their original color).
                    Existing font colors are overridden by the rainbow effect. However, CanvasItem's
                    <strong>Modulate</strong> and <strong>Self Modulate</strong> properties will affect how the rainbow effect
                    looks, as modulation multiplies its final colors.</paragraph>
            </section>
        </section>
        <section ids="custom-bbcode-tags-and-text-effects" names="custom\ bbcode\ tags\ and\ text\ effects 自定义\ bbcode\ 标签和文本效果">
            <title>自定义 BBCode 标签和文本效果</title>
            <paragraph>可以通过扩展 <reference internal="True" refuri="../../classes/class_richtexteffect#class-richtexteffect"><inline classes="std std-ref">RichTextEffect</inline></reference> 资源类型来创建自己的 BBCode 标签。首先扩展 <reference internal="True" refuri="../../classes/class_richtexteffect#class-richtexteffect"><inline classes="std std-ref">RichTextEffect</inline></reference> 资源类型并为脚本提供 <literal>class_name</literal>，这样就能够在检查器中选择该效果。如果想在编辑器中运行这些自定义效果，请在 GDScript 文件中添加 <literal>@tool</literal> 注解。RichTextLabel 不需要附加脚本，也不需要在 <literal>tool</literal> 模式下运行。注册效果的方法是将这个新建的效果在检查器中加入到 <strong>Markup &gt; Custom Effects</strong> 数组中，或者在代码中使用 <reference internal="True" refuri="../../classes/class_richtextlabel#class-richtextlabel-method-install-effect"><inline classes="std std-ref">install_effect()</inline></reference> 方法：</paragraph>
            <figure align="center" ids="id2">
                <image alt="Selecting a custom RichTextEffect after saving a script that extends RichTextEffect with a ``class_name``" candidates="{'*': 'tutorials/ui/img/bbcode_in_richtextlabel_selecting_custom_richtexteffect.webp'}" uri="tutorials/ui/img/bbcode_in_richtextlabel_selecting_custom_richtexteffect.webp"></image>
                <caption>Selecting a custom RichTextEffect after saving a script that extends RichTextEffect with a <literal>class_name</literal></caption>
            </figure>
            <warning>
                <paragraph>If the custom effect is not registered within the RichTextLabel's
                    <strong>Markup &gt; Custom Effects</strong> property, no effect will be visible and the original
                    tag will be left as-is.</paragraph>
            </warning>
            <paragraph>只需要扩展一个函数: <literal>_process_custom_fx(char_fx)</literal> , 或者可以通过添加成员名称 <literal>bbcode</literal> 来提供自定义BBCode标识符, 该代码将自动检查bbcode属性, 或使用文件名来决定BBCode标签应该是什么.</paragraph>
            <section ids="process-custom-fx" names="_process_custom_fx">
                <title><literal>_process_custom_fx</literal></title>
                <paragraph>This is where the logic of each effect takes place and is called once per glyph
                    during the draw phase of text rendering. This passes in a <reference internal="True" refuri="../../classes/class_charfxtransform#class-charfxtransform"><inline classes="std std-ref">CharFXTransform</inline></reference>
                    object, which holds a few variables to control how the associated glyph is rendered:</paragraph>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph><literal>identity身份</literal> 指定正在处理哪个自定义效果, 应该用它来控制代码流程.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>outline</literal> is <literal>true</literal> if effect is called for drawing text outline.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>range</literal> tells you how far into a given custom effect block you are in as an
                            index.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>elapsed_time</literal> 是文本效果运行的总时间.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>visible</literal> will tell you whether the glyph is visible or not and will also allow you
                            to hide a given portion of text.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>offset</literal> is an offset position relative to where the given glyph should render under
                            normal circumstances.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>color</literal> is the color of a given glyph.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>glyph_index</literal> and <literal>font</literal> is glyph being drawn and font data resource used to draw it.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Finally, <literal>env</literal> is a <reference internal="True" refuri="../../classes/class_dictionary#class-dictionary"><inline classes="std std-ref">Dictionary</inline></reference> of parameters assigned to a given custom
                            effect. You can use <reference internal="True" refuri="../../classes/class_dictionary#class-dictionary-method-get"><inline classes="std std-ref">get()</inline></reference> with an optional default value
                            to retrieve each parameter, if specified by the user. For example <literal>[custom_fx spread=0.5
color=#FFFF00]test[/custom_fx]</literal> would have a float <literal>spread</literal> and Color <literal>color</literal>
                            parameters in its <literal>env</literal> Dictionary. See below for more usage examples.</paragraph>
                    </list_item>
                </bullet_list>
                <paragraph>The last thing to note about this function is that it is necessary to return a boolean
                    <literal>true</literal> value to verify that the effect processed correctly. This way, if there's a problem
                    with rendering a given glyph, it will back out of rendering custom effects entirely until
                    the user fixes whatever error cropped up in their custom effect logic.</paragraph>
                <paragraph>以下是一些自定义效果的示例:</paragraph>
            </section>
            <section ids="ghost" names="ghost 幽灵">
                <title>幽灵</title>
                <literal_block force="False" language="gdscript" linenos="False" xml:space="preserve">@tool
extends RichTextEffect
class_name RichTextGhost

# Syntax: [ghost freq=5.0 span=10.0][/ghost]

# Define the tag name.
var bbcode = "ghost"

func _process_custom_fx(char_fx):
    # Get parameters, or use the provided default value if missing.
    var speed = char_fx.env.get("freq", 5.0)
    var span = char_fx.env.get("span", 10.0)

    var alpha = sin(char_fx.elapsed_time * speed + (char_fx.range.x / span)) * 0.5 + 0.5
    char_fx.color.a = alpha
    return true</literal_block>
            </section>
            <section ids="matrix" names="matrix 矩阵">
                <title>矩阵</title>
                <literal_block force="False" language="gdscript" linenos="False" xml:space="preserve">@tool
extends RichTextEffect
class_name RichTextMatrix

# Syntax: [matrix clean=2.0 dirty=1.0 span=50][/matrix]

# Define the tag name.
var bbcode = "matrix"

# Gets TextServer for retrieving font information.
func get_text_server():
    return TextServerManager.get_primary_interface()

func _process_custom_fx(char_fx):
    # Get parameters, or use the provided default value if missing.
    var clear_time = char_fx.env.get("clean", 2.0)
    var dirty_time = char_fx.env.get("dirty", 1.0)
    var text_span = char_fx.env.get("span", 50)

    var value = char_fx.glyph_index

    var matrix_time = fmod(char_fx.elapsed_time + (char_fx.range.x / float(text_span)), \
                           clear_time + dirty_time)

    matrix_time = 0.0 if matrix_time &lt; clear_time else \
                  (matrix_time - clear_time) / dirty_time

    if matrix_time &gt; 0.0:
        value = int(1 * matrix_time * (126 - 65))
        value %= (126 - 65)
        value += 65
    char_fx.glyph_index = get_text_server().font_get_glyph_index(char_fx.font, 1, value, 0)
    return true</literal_block>
                <paragraph>这将增加一些新的BBCode命令, 可以像这样使用:</paragraph>
                <literal_block force="False" highlight_args="{}" language="none" linenos="False" xml:space="preserve">[center][ghost]This is a custom [matrix]effect[/matrix][/ghost] made in
[pulse freq=5.0 height=2.0][pulse color=#00FFAA freq=2.0]GDScript[/pulse][/pulse].[/center]</literal_block>
                <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/zh_CN/?utm_source=widget"><image alt="翻译状态" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/zh_CN/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/zh_CN/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
            </section>
        </section>
    </section>
</document>
