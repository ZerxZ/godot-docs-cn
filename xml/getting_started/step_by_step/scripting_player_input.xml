<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/getting_started/step_by_step/scripting_player_input.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <comment xml:space="preserve">Intention: only introduce one necessary input method at this point. The
Inputs section of the docs should provide more guides comparing the various
tools you have to manage the complexity of user input.</comment>
    <target refid="doc-scripting-player-input"></target>
    <section ids="listening-to-player-input doc-scripting-player-input" names="listening\ to\ player\ input doc_scripting_player_input">
        <title>Listening to player input</title>
        <paragraph>Building upon the previous lesson, <reference internal="True" refuri="scripting_first_script#doc-scripting-first-script"><inline classes="std std-ref">Creating your first script</inline></reference>, let's look
            at another important feature of any game: giving control to the player.
            To add this, we need to modify our <literal>sprite_2d.gd</literal> code.</paragraph>
        <image candidates="{'*': 'getting_started/step_by_step/img/scripting_first_script_moving_with_input.gif'}" original_uri="img/scripting_first_script_moving_with_input.gif" uri="getting_started/step_by_step/img/scripting_first_script_moving_with_input.gif"></image>
        <paragraph>You have two main tools to process the player's input in Godot:</paragraph>
        <enumerated_list enumtype="arabic" prefix="" suffix=".">
            <list_item>
                <paragraph>The built-in input callbacks, mainly <literal>_unhandled_input()</literal>. Like
                    <literal>_process()</literal>, it's a built-in virtual function that Godot calls every time
                    the player presses a key. It's the tool you want to use to react to events
                    that don't happen every frame, like pressing <literal classes="kbd">Space</literal> to jump. To learn
                    more about input callbacks, see <reference internal="True" refuri="../../tutorials/inputs/inputevent#doc-inputevent"><inline classes="std std-ref">Using InputEvent</inline></reference>.</paragraph>
            </list_item>
            <list_item>
                <paragraph>The <literal>Input</literal> singleton. A singleton is a globally accessible object. Godot
                    provides access to several in scripts. It's the right tool to check for input
                    every frame.</paragraph>
            </list_item>
        </enumerated_list>
        <paragraph>We're going to use the <literal>Input</literal> singleton here as we need to know if the player
            wants to turn or move every frame.</paragraph>
        <paragraph>For turning, we should use a new variable: <literal>direction</literal>. In our <literal>_process()</literal>
            function, replace the <literal>rotation += angular_speed * delta</literal> line with the
            code below.</paragraph>
        <container classes="sphinx-tabs" type="tab-element">
            <div aria-label="Tabbed content" role="tablist">
                <button aria-controls="panel-0-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                <button aria-controls="panel-0-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-0-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
            </div>
            <div aria-labelledby="tab-0-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">var direction = 0
if Input.is_action_pressed("ui_left"):
    direction = -1
if Input.is_action_pressed("ui_right"):
    direction = 1

rotation += angular_speed * direction * delta</literal_block>
            </div>
            <div aria-labelledby="tab-0-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-0-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">var direction = 0;
if (Input.IsActionPressed("ui_left"))
{
    direction = -1;
}
if (Input.IsActionPressed("ui_right"))
{
    direction = 1;
}

Rotation += _angularSpeed * direction * (float)delta;</literal_block>
            </div>
        </container>
        <paragraph>Our <literal>direction</literal> local variable is a multiplier representing the direction in
            which the player wants to turn. A value of <literal>0</literal> means the player isn't pressing
            the left or the right arrow key. A value of <literal>1</literal> means the player wants to turn
            right, and <literal>-1</literal> means they want to turn left.</paragraph>
        <paragraph>To produce these values, we introduce conditional statements and the use of <literal>Input</literal>.
            A conditional statement starts with the <literal>if</literal> keyword in GDScript and ends with a colon. The
            condition is specifically the expression between the keyword and the colon at
            the end of the line.</paragraph>
        <paragraph>To check if a key was pressed this frame, we call <literal>Input.is_action_pressed()</literal>.
            The method takes a text string representing an input action and returns <literal>true</literal>
            if the action is pressed, <literal>false</literal> otherwise.</paragraph>
        <paragraph>The two actions we use above, "ui_left" and "ui_right", are predefined in every
            Godot project. They respectively trigger when the player presses the left and
            right arrows on the keyboard or left and right on a gamepad's D-pad.</paragraph>
        <note>
            <paragraph>You can see and edit input actions in your project by going to
                <inline classes="role-menu role-ui">Project &gt; Project Settings</inline> and clicking on the <inline classes="role-ui">Input Map</inline> tab.</paragraph>
        </note>
        <paragraph>Finally, we use the <literal>direction</literal> as a multiplier when we update the node's
            <literal>rotation</literal>: <literal>rotation += angular_speed * direction * delta</literal>.</paragraph>
        <paragraph>Comment out the lines <literal>var velocity = Vector2.UP.rotated(rotation) * speed</literal> and <literal>position += velocity * delta</literal> like this:</paragraph>
        <container classes="sphinx-tabs" type="tab-element">
            <div aria-label="Tabbed content" role="tablist">
                <button aria-controls="panel-1-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-1-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                <button aria-controls="panel-1-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-1-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
            </div>
            <div aria-labelledby="tab-1-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-1-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">#var velocity = Vector2.UP.rotated(rotation) * speed

#position += velocity * delta</literal_block>
            </div>
            <div aria-labelledby="tab-1-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-1-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">//var velocity = Vector2.Up.Rotated(Rotation) * _speed;

//Position += velocity * (float)delta;</literal_block>
            </div>
        </container>
        <paragraph>This will ignore the code that moved the icon's position in a circle without user input from the previous exercise.</paragraph>
        <paragraph>If you run the scene with this code, the icon should rotate when you press
            <literal classes="kbd">Left</literal> and <literal classes="kbd">Right</literal>.</paragraph>
        <section ids="moving-when-pressing-up" names='moving\ when\ pressing\ "up"'>
            <title>Moving when pressing "up"</title>
            <paragraph>To only move when pressing a key, we need to modify the code that calculates the
                velocity. Uncomment the code and replace the line starting with <literal>var velocity</literal> with the code below.</paragraph>
            <container classes="sphinx-tabs" type="tab-element">
                <div aria-label="Tabbed content" role="tablist">
                    <button aria-controls="panel-2-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                    <button aria-controls="panel-2-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
                </div>
                <div aria-labelledby="tab-2-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-2-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">var velocity = Vector2.ZERO
if Input.is_action_pressed("ui_up"):
    velocity = Vector2.UP.rotated(rotation) * speed</literal_block>
                </div>
                <div aria-labelledby="tab-2-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">var velocity = Vector2.Zero;
if (Input.IsActionPressed("ui_up"))
{
    velocity = Vector2.Up.Rotated(Rotation) * _speed;
}</literal_block>
                </div>
            </container>
            <paragraph>We initialize the <literal>velocity</literal> with a value of <literal>Vector2.ZERO</literal>, another
                constant of the built-in <literal>Vector</literal> type representing a 2D vector of length 0.</paragraph>
            <paragraph>If the player presses the "ui_up" action, we then update the velocity's value,
                causing the sprite to move forward.</paragraph>
        </section>
        <section ids="complete-script" names="complete\ script">
            <title>Complete script</title>
            <paragraph>Here is the complete <literal>sprite_2d.gd</literal> file for reference.</paragraph>
            <container classes="sphinx-tabs" type="tab-element">
                <div aria-label="Tabbed content" role="tablist">
                    <button aria-controls="panel-3-R0RTY3JpcHQ=" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button>
                    <button aria-controls="panel-3-QyM=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button>
                </div>
                <div aria-labelledby="tab-3-R0RTY3JpcHQ=" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-3-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="gdscript" linenos="False" xml:space="preserve">extends Sprite2D

var speed = 400
var angular_speed = PI


func _process(delta):
    var direction = 0
    if Input.is_action_pressed("ui_left"):
        direction = -1
    if Input.is_action_pressed("ui_right"):
        direction = 1

    rotation += angular_speed * direction * delta

    var velocity = Vector2.ZERO
    if Input.is_action_pressed("ui_up"):
        velocity = Vector2.UP.rotated(rotation) * speed

    position += velocity * delta</literal_block>
                </div>
                <div aria-labelledby="tab-3-QyM=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-QyM=" name="QyM=" role="tabpanel" tabindex="0">
                    <literal_block force="False" highlight_args="{}" language="csharp" linenos="False" xml:space="preserve">using Godot;

public partial class MySprite2D : Sprite2D
{
    private float _speed = 400;
    private float _angularSpeed = Mathf.Pi;

    public override void _Process(double delta)
    {
        var direction = 0;
        if (Input.IsActionPressed("ui_left"))
        {
            direction = -1;
        }
        if (Input.IsActionPressed("ui_right"))
        {
            direction = 1;
        }

        Rotation += _angularSpeed * direction * (float)delta;

        var velocity = Vector2.Zero;
        if (Input.IsActionPressed("ui_up"))
        {
            velocity = Vector2.Up.Rotated(Rotation) * _speed;
        }

        Position += velocity * (float)delta;
    }
}</literal_block>
                </div>
            </container>
            <paragraph>If you run the scene, you should now be able to rotate with the left and right
                arrow keys and move forward by pressing <literal classes="kbd">Up</literal>.</paragraph>
            <image candidates="{'*': 'getting_started/step_by_step/img/scripting_first_script_moving_with_input.gif'}" original_uri="img/scripting_first_script_moving_with_input.gif" uri="getting_started/step_by_step/img/scripting_first_script_moving_with_input.gif"></image>
        </section>
        <section ids="summary" names="summary">
            <title>Summary</title>
            <paragraph>In summary, every script in Godot represents a class and extends one of the
                engine's built-in classes. The node types your classes inherit from give you
                access to properties, such as <literal>rotation</literal> and <literal>position</literal> in our sprite's case.
                You also inherit many functions, which we didn't get to use in this example.</paragraph>
            <paragraph>In GDScript, the variables you put at the top of the file are your class's
                properties, also called member variables. Besides variables, you can define
                functions, which, for the most part, will be your classes' methods.</paragraph>
            <paragraph>Godot provides several virtual functions you can define to connect your class
                with the engine. These include <literal>_process()</literal>, to apply changes to the node
                every frame, and <literal>_unhandled_input()</literal>, to receive input events like key and
                button presses from the users. There are quite a few more.</paragraph>
            <paragraph>The <literal>Input</literal> singleton allows you to react to the player's input anywhere in
                your code. In particular, you'll get to use it in the <literal>_process()</literal> loop.</paragraph>
            <paragraph>In the next lesson, <reference internal="True" refuri="signals#doc-signals"><inline classes="std std-ref">Using signals</inline></reference>, we'll build upon the relationship between
                scripts and nodes by having our nodes trigger code in scripts.</paragraph>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
