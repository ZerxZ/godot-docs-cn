<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/engine_details/development/compiling/cross-compiling_for_ios_on_linux.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-cross-compiling-for-ios-on-linux"></target>
    <section ids="cross-compiling-for-ios-on-linux doc-cross-compiling-for-ios-on-linux" names="cross-compiling\ for\ ios\ on\ linux doc_cross-compiling_for_ios_on_linux">
        <title>Cross-compiling for iOS on Linux</title>
        <paragraph>The procedure for this is somewhat complex and requires a lot of steps,
            but once you have the environment properly configured you can
            compile Godot for iOS anytime you want.</paragraph>
        <section ids="disclaimer" names="disclaimer">
            <title>Disclaimer</title>
            <paragraph>While it is possible to compile for iOS on a Linux environment, Apple is
                very restrictive about the tools to be used (especially hardware-wise),
                allowing pretty much only their products to be used for development. So
                this is <strong>not official</strong>. However, in 2010 Apple said they relaxed some of the
                <reference name="App Store review guidelines" refuri="https://developer.apple.com/app-store/review/guidelines/">App Store review guidelines</reference>
                to allow any tool to be used, as long as the resulting binary does not
                download any code, which means it should be OK to use the procedure
                described here and cross-compiling the binary.</paragraph>
        </section>
        <section ids="requirements" names="requirements">
            <title>Requirements</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><reference name="XCode with the iOS SDK" refuri="https://developer.apple.com/download/all/?q=Xcode">XCode with the iOS SDK</reference>
                        (you must be logged into an Apple ID to download Xcode).</paragraph>
                </list_item>
                <list_item>
                    <paragraph><reference name="Clang &gt;= 3.5" refuri="https://clang.llvm.org">Clang &gt;= 3.5</reference> for your development
                        machine installed and in the <literal>PATH</literal>. It has to be version &gt;= 3.5
                        to target <literal>arm64</literal> architecture.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><reference name="xar" refuri="https://mackyle.github.io/xar/">xar</reference> and <reference name="pbzx" refuri="https://github.com/NiklasRosenstein/pbzx">pbzx</reference>
                        (required to extract the <literal>.xip</literal> archive Xcode comes in).</paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>For building xar and pbzx, you may want to follow
                                <reference name="this guide" refuri="https://gist.github.com/phracker/1944ce190e01963c550566b749bd2b54">this guide</reference>.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph><reference name="cctools-port" refuri="https://github.com/tpoechtrager/cctools-port">cctools-port</reference>
                        for the needed build tools. The procedure for building is quite
                        peculiar and is described below.</paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>This also has some extra dependencies: automake, autogen, libtool.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
            </bullet_list>
        </section>
        <section ids="configuring-the-environment" names="configuring\ the\ environment">
            <title>Configuring the environment</title>
            <section ids="preparing-the-sdk" names="preparing\ the\ sdk">
                <title>Preparing the SDK</title>
                <paragraph>Extract the Xcode <literal>.xip</literal> file you downloaded from Apple's developer website:</paragraph>
                <literal_block force="False" language="shell" linenos="False" xml:space="preserve">mkdir xcode
xar -xf /path/to/Xcode_X.x.xip -C xcode
pbzx -n Content | cpio -i

[...]
######### Blocks</literal_block>
                <paragraph>Note that for the commands below, you will need to replace the version (<literal>x.x</literal>)
                    with whatever iOS SDK version you're using. If you don't know your iPhone SDK
                    version, you can see the JSON file inside of
                    <literal>Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs</literal>.</paragraph>
                <paragraph>Extract the iOS SDK:</paragraph>
                <literal_block force="False" language="shell" linenos="False" xml:space="preserve">export IOS_SDK_VERSION="x.x"
mkdir -p iPhoneSDK/iPhoneOS${IOS_SDK_VERSION}.sdk
cp -r xcode/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/* iPhoneSDK/iPhoneOS${IOS_SDK_VERSION}.sdk
cp -r xcode/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/* iPhoneSDK/iPhoneOS${IOS_SDK_VERSION}.sdk/usr/include/c++
fusermount -u xcode</literal_block>
                <paragraph>Pack the SDK so that cctools can use it:</paragraph>
                <literal_block force="False" language="shell" linenos="False" xml:space="preserve">cd iPhoneSDK
tar -cf - * | xz -9 -c - &gt; iPhoneOS${IOS_SDK_VERSION}.sdk.tar.xz</literal_block>
            </section>
            <section ids="toolchain" names="toolchain">
                <title>Toolchain</title>
                <paragraph>Build cctools:</paragraph>
                <literal_block force="False" language="shell" linenos="False" xml:space="preserve">git clone https://github.com/tpoechtrager/cctools-port.git
cd cctools-port/usage_examples/ios_toolchain
./build.sh /path/iPhoneOS${IOS_SDK_VERSION}.sdk.tar.xz arm64</literal_block>
                <paragraph>Copy the tools to a nicer place. Note that the SCons scripts for
                    building will look under <literal>usr/bin</literal> inside the directory you provide
                    for the toolchain binaries, so you must copy to such subdirectory, akin
                    to the following commands:</paragraph>
                <literal_block force="False" language="shell" linenos="False" xml:space="preserve">mkdir -p "$HOME/iostoolchain/usr"
cp -r target/bin "$HOME/iostoolchain/usr/"</literal_block>
                <paragraph>Now you should have the iOS toolchain binaries in
                    <literal>$HOME/iostoolchain/usr/bin</literal>.</paragraph>
            </section>
        </section>
        <section ids="compiling-godot-for-iphone" names="compiling\ godot\ for\ iphone">
            <title>Compiling Godot for iPhone</title>
            <paragraph>Once you've done the above steps, you should keep two things in your
                environment: the built toolchain and the iPhoneOS SDK directory. Those
                can stay anywhere you want since you have to provide their paths to the
                SCons build command.</paragraph>
            <paragraph>For the iPhone platform to be detected, you need the <literal>OSXCROSS_IOS</literal>
                environment variable defined to anything.</paragraph>
            <literal_block force="False" language="shell" linenos="False" xml:space="preserve">export OSXCROSS_IOS="anything"</literal_block>
            <paragraph>Now you can compile for iPhone using SCons like the standard Godot
                way, with some additional arguments to provide the correct paths:</paragraph>
            <literal_block force="False" language="shell" linenos="False" xml:space="preserve">scons platform=ios arch=arm64 target=template_release IOS_SDK_PATH="/path/to/iPhoneSDK" IOS_TOOLCHAIN_PATH="/path/to/iostoolchain" ios_triple="arm-apple-darwin11-"</literal_block>
            <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
        </section>
    </section>
</document>
