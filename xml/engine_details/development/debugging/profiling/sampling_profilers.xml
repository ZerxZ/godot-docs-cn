<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/engine_details/development/debugging/profiling/sampling_profilers.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-sampling-profilers"></target>
    <section ids="sampling-profilers doc-sampling-profilers" names="sampling\ profilers doc_sampling_profilers">
        <title>Sampling profilers</title>
        <section ids="recommended-profilers" names="recommended\ profilers">
            <title>Recommended profilers</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><reference name="VerySleepy" refuri="http://www.codersnotes.com/sleepy/">VerySleepy</reference> (Windows only)</paragraph>
                </list_item>
                <list_item>
                    <paragraph><reference name="HotSpot" refuri="https://github.com/KDAB/hotspot">HotSpot</reference> (Linux only)</paragraph>
                </list_item>
                <list_item>
                    <paragraph><reference name="Xcode Instruments" refuri="https://developer.apple.com/xcode/">Xcode Instruments</reference> (macOS only)</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>These profilers may not be the most powerful or flexible options, but their
                standalone operation and limited feature set tends to make them easier to use.</paragraph>
        </section>
        <section ids="setting-up-godot" names="setting\ up\ godot">
            <title>Setting up Godot</title>
            <paragraph>To get useful profiling information, it is <strong>absolutely required</strong> to use a Godot
                build that includes debugging symbols. Official binaries do not include debugging
                symbols, since these would make the download size significantly larger.</paragraph>
            <paragraph>To get profiling data that best matches the production environment (but with debugging symbols),
                you should compile binaries with the <literal>production=yes debug_symbols=yes</literal> SCons options.</paragraph>
            <paragraph>It is possible to run a profiler on less optimized builds (e.g. <literal>target=template_debug</literal> without LTO),
                but results will naturally be less representative of real world conditions.</paragraph>
            <warning>
                <paragraph>Do <emphasis>not</emphasis> strip debugging symbols on the binaries using the <literal>strip</literal> command
                    after compiling the binaries. Otherwise, you will no longer get useful
                    profiling information when running a profiler.</paragraph>
            </warning>
        </section>
        <section ids="benchmarking-startup-shutdown-times" names="benchmarking\ startup/shutdown\ times">
            <title>Benchmarking startup/shutdown times</title>
            <paragraph>If you're looking into optimizing Godot's startup/shutdown performance,
                you can tell the profiler to use the <literal>--quit</literal> command line option on the Godot binary.
                This will exit Godot just after it's done starting.
                The <literal>--quit</literal> option works with <literal>--editor</literal>, <literal>--project-manager</literal>, and
                <literal>--path &lt;path to project directory&gt;</literal> (which runs a project directly).</paragraph>
            <seealso>
                <paragraph>See <reference internal="True" refuri="../../../../tutorials/editor/command_line_tutorial#doc-command-line-tutorial"><inline classes="std std-ref">Command line tutorial</inline></reference> for more command line arguments
                    supported by Godot.</paragraph>
            </seealso>
        </section>
        <section ids="profiler-specific-instructions" names="profiler-specific\ instructions">
            <title>Profiler-specific instructions</title>
            <section ids="verysleepy" names="verysleepy">
                <title>VerySleepy</title>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Start the Godot editor or your project first.
                            If you start the Project Manager, make sure to edit or run a project first.
                            Otherwise, the profiler will not track the child process since the Project Manager
                            will spawn a child process for every project edited or run.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Open VerySleepy and select the Godot executable in the list of processes on the left:</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_verysleepy_select_process.png'}" original_uri="img/cpp_profiler_verysleepy_select_process.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_verysleepy_select_process.png"></image>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Click the <strong>Profile All</strong> button on the right to start profiling.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Perform the actions you wish to profile in the editor or project. When you're done, click <strong>Stop</strong> (<emphasis>not</emphasis> Abort).</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Wait for the results window to appear.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Once the results window appears, filter the view to remove external modules (such as the graphics driver).
                            You can filter by module by finding a line whose <strong>Module</strong> matches the Godot
                            executable name, right-clicking that line then choosing
                            <strong>Filter Module to &lt;Godot executable name&gt;</strong> in the dropdown that appears.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Your results window should now look something like this:</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_verysleepy_results_filtered.png'}" original_uri="img/cpp_profiler_verysleepy_results_filtered.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_verysleepy_results_filtered.png"></image>
            </section>
            <section ids="hotspot" names="hotspot">
                <title>HotSpot</title>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Open HotSpot. Click <strong>Record Data</strong>:</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_hotspot_welcome.png'}" original_uri="img/cpp_profiler_hotspot_welcome.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_hotspot_welcome.png"></image>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>In the next window, specify the path to the Godot binary that includes debug symbols.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Specify command line arguments to run a specific project, with or without the editor.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>The path to the working directory can be anything if an absolute path is used
                            for the <literal>--path</literal> command line argument. Otherwise, it must be set so that
                            the relative path to the project is valid.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Make sure <strong>Elevate Privileges</strong> is checked if you have administrative privileges.
                            While not essential for profiling Godot, this will ensure all events can be captured.
                            Otherwise, some events may be missing from the capture.
                            Your settings should now look something like this:</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_hotspot_record.png'}" original_uri="img/cpp_profiler_hotspot_record.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_hotspot_record.png"></image>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Click <strong>Start Recording</strong> and perform the actions you wish to profile in the editor/project.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Quit the editor/project normally or use the <strong>Stop Profiling</strong> button in HotSpot
                            to stop profiling early. Stopping profiling early can result in cleaner profiles
                            if you're not interested in the engine's shutdown procedure.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Click <strong>View Results</strong> and wait for the profiling visualization to be generated:</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_hotspot_view_results.png'}" original_uri="img/cpp_profiler_hotspot_view_results.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_hotspot_view_results.png"></image>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Use the tabs at the top to navigate between the different views. These views
                            show the same data, but in different ways. The <strong>Flame Graph</strong> tab is a good
                            way to see which functions take up the most time at a glance. These functions
                            are therefore the most important ones to optimize, since optimizing them will
                            improve performance the most.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>At the bottom of all tabs except <strong>Summary</strong>, you will also see a list of CPU threads
                            started by the engine along with the CPU utilization for each thread.
                            This lets you see threads that can be a bottleneck at a given point in time.</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_hotspot_flame_graph.png'}" original_uri="img/cpp_profiler_hotspot_flame_graph.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_hotspot_flame_graph.png"></image>
                <note>
                    <paragraph>If you don't want the startup procedure to be included in the profile, you
                        can also attach HotSpot to a running process by clicking <strong>Record Data</strong>
                        then setting the <strong>Launch Application</strong> dropdown option to <strong>Attach To
                            Process(es)</strong>.</paragraph>
                    <paragraph>This process attachment-based workflow is similar to the one used by VerySleepy.</paragraph>
                </note>
            </section>
            <section ids="xcode-instruments" names="xcode\ instruments">
                <title>Xcode Instruments</title>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Open Xcode. Select <strong>Open Developer Tool</strong> - <strong>Instruments</strong> from the <strong>Xcode</strong> app menu:</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Double-click on <strong>Time Profiler</strong> in the <strong>Instruments</strong> window:</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_xcode_menu.png'}" original_uri="img/cpp_profiler_xcode_menu.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_xcode_menu.png"></image>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>In the Time Profiler window, click on the <strong>Target</strong> menu, select <strong>Choose target...</strong>
                            and specify the path to the Godot binary, command line arguments, and environment variables
                            in the next window.</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_time_profiler.png'}" original_uri="img/cpp_profiler_time_profiler.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_time_profiler.png"></image>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>You can also attach the Time Profiler to a running process by selecting it from the <strong>Target</strong>
                            menu.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Click the <strong>Start an immediate mode recording</strong> button to start profiling.</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_time_profiler_record.png'}" original_uri="img/cpp_profiler_time_profiler_record.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_time_profiler_record.png"></image>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Perform the actions you wish to profile in the editor or project. When you're done,
                            click the <strong>Stop</strong> button.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Wait for the results to appear.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>At the bottom of the window you will see a call tree for all CPU threads started, and
                            the <strong>Heaviest Stack Trace</strong> overview.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Select <strong>Hide system libraries</strong> in the <strong>Call Tree</strong> menu (at the bottom of the window) to
                            remove external modules.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>You can use the timeline at the top of the window to display details for the specific time period.</paragraph>
                    </list_item>
                </bullet_list>
                <image candidates="{'*': 'engine_details/development/debugging/profiling/img/cpp_profiler_time_profiler_result.png'}" original_uri="img/cpp_profiler_time_profiler_result.png" uri="engine_details/development/debugging/profiling/img/cpp_profiler_time_profiler_result.png"></image>
                <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/?utm_source=widget"><image alt="Translation status" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/-/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
            </section>
        </section>
    </section>
</document>
