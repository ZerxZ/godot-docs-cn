<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.17.1 -->
<document source="/home/runner/work/godot-docs-cn/godot-docs-cn/godot-docs/docs/contributing/documentation/building_the_manual.rst" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="doc-building-the-manual"></target>
    <section ids="building-the-manual-with-sphinx doc-building-the-manual" names="building\ the\ manual\ with\ sphinx 使用\ sphinx\ 构建手册 doc_building_the_manual">
        <title>使用 Sphinx 构建手册</title>
        <paragraph>本页面描述使用 Sphinx 文档引擎构建本地 Godot 手册的方法。你可以用它来获得本地的 HTML 文件以及诸如 PDF、EPUB、LaTeX 形式的文档。</paragraph>
        <paragraph>在开始之前，请确保你已完成以下步骤：</paragraph>
        <bullet_list bullet="-">
            <list_item>
                <paragraph><reference name="Git" refuri="https://git-scm.com/">Git</reference><target ids="git" names="git" refuri="https://git-scm.com/"></target></paragraph>
            </list_item>
            <list_item>
                <paragraph><reference name="make" refuri="https://www.gnu.org/software/make/">make</reference><target ids="make" names="make" refuri="https://www.gnu.org/software/make/"></target> (unless you're using Windows)</paragraph>
            </list_item>
            <list_item>
                <paragraph><reference name="Python" refuri="https://www.python.org/">Python</reference><target ids="python" names="python" refuri="https://www.python.org/"></target> 3</paragraph>
            </list_item>
        </bullet_list>
        <note>
            <paragraph>Python 3 should come with the <literal>pip3</literal> command. You may need to write
                <literal>python3 -m pip</literal> (Unix) or  <literal>py -m pip</literal> (Windows) instead of <literal>pip3</literal>.
                If both approaches fail, <reference name="make sure that you have pip3 installed" refuri="https://pip.pypa.io/en/stable/installation/">make sure that you have pip3 installed</reference>.</paragraph>
        </note>
        <enumerated_list enumtype="arabic" prefix="" suffix=".">
            <list_item>
                <paragraph><emphasis>（可选）</emphasis> 设置虚拟环境。 虚拟环境可防止 <literal>requirements.txt</literal> 中的 Python 包与系统上安装的其他 Python 包之间的潜在冲突。</paragraph>
                <enumerated_list enumtype="loweralpha" prefix="" suffix=".">
                    <list_item>
                        <paragraph>创建虚拟环境：</paragraph>
                        <container classes="sphinx-tabs" type="tab-element">
                            <div aria-label="Tabbed content" role="tablist">
                                <button aria-controls="panel-0-V2luZG93cw==" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-0-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button>
                                <button aria-controls="panel-0-T3RoZXIgcGxhdGZvcm1z" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-0-T3RoZXIgcGxhdGZvcm1z" name="T3RoZXIgcGxhdGZvcm1z" role="tab" tabindex="-1">Other platforms</button>
                            </div>
                            <div aria-labelledby="tab-0-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" ids="panel-0-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
                                <literal_block force="False" highlight_args="{}" language="pwsh" linenos="False" xml:space="preserve">py -m venv godot-docs-venv</literal_block>
                            </div>
                            <div aria-labelledby="tab-0-T3RoZXIgcGxhdGZvcm1z" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-0-T3RoZXIgcGxhdGZvcm1z" name="T3RoZXIgcGxhdGZvcm1z" role="tabpanel" tabindex="0">
                                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">python3 -m venv godot-docs-venv</literal_block>
                            </div>
                        </container>
                    </list_item>
                    <list_item>
                        <paragraph>启动虚拟环境：</paragraph>
                        <container classes="sphinx-tabs" type="tab-element">
                            <div aria-label="Tabbed content" role="tablist">
                                <button aria-controls="panel-1-V2luZG93cw==" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-1-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button>
                                <button aria-controls="panel-1-T3RoZXIgcGxhdGZvcm1z" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-1-T3RoZXIgcGxhdGZvcm1z" name="T3RoZXIgcGxhdGZvcm1z" role="tab" tabindex="-1">Other platforms</button>
                            </div>
                            <div aria-labelledby="tab-1-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" ids="panel-1-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
                                <literal_block force="False" highlight_args="{}" language="pwsh" linenos="False" xml:space="preserve">godot-docs-venv\Scripts\activate.bat</literal_block>
                            </div>
                            <div aria-labelledby="tab-1-T3RoZXIgcGxhdGZvcm1z" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-1-T3RoZXIgcGxhdGZvcm1z" name="T3RoZXIgcGxhdGZvcm1z" role="tabpanel" tabindex="0">
                                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">source godot-docs-venv/bin/activate</literal_block>
                            </div>
                        </container>
                    </list_item>
                    <list_item>
                        <paragraph><emphasis>（可选）</emphasis> 更新预安装的软件包：</paragraph>
                        <container classes="sphinx-tabs" type="tab-element">
                            <div aria-label="Tabbed content" role="tablist">
                                <button aria-controls="panel-2-V2luZG93cw==" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-2-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button>
                                <button aria-controls="panel-2-T3RoZXIgcGxhdGZvcm1z" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-2-T3RoZXIgcGxhdGZvcm1z" name="T3RoZXIgcGxhdGZvcm1z" role="tab" tabindex="-1">Other platforms</button>
                            </div>
                            <div aria-labelledby="tab-2-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" ids="panel-2-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
                                <literal_block force="False" highlight_args="{}" language="pwsh" linenos="False" xml:space="preserve">py -m pip install --upgrade pip setuptools</literal_block>
                            </div>
                            <div aria-labelledby="tab-2-T3RoZXIgcGxhdGZvcm1z" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-2-T3RoZXIgcGxhdGZvcm1z" name="T3RoZXIgcGxhdGZvcm1z" role="tabpanel" tabindex="0">
                                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">pip3 install --upgrade pip setuptools</literal_block>
                            </div>
                        </container>
                    </list_item>
                </enumerated_list>
            </list_item>
            <list_item>
                <paragraph>克隆（clone）文档仓库：</paragraph>
                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">git clone https://github.com/godotengine/godot-docs.git</literal_block>
            </list_item>
            <list_item>
                <paragraph>将目录切换到文档仓库：</paragraph>
                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">cd godot-docs</literal_block>
            </list_item>
            <list_item>
                <paragraph>Install the required packages:</paragraph>
                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">pip3 install -r requirements.txt</literal_block>
            </list_item>
            <list_item>
                <paragraph>构建文档：</paragraph>
                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">make html</literal_block>
                <note>
                    <paragraph>在 Windows 上，该命令将运行 <literal>make.bat</literal> 而不是 GNU Make（或其他替代方案）。</paragraph>
                </note>
                <paragraph>或者你也可以手动调用 sphinx-build 程序来构建文档：</paragraph>
                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">sphinx-build -b html ./ _build/html</literal_block>
            </list_item>
        </enumerated_list>
        <paragraph>因为 <literal>classes/</literal> 文件夹里包含了上百个文件，所以编译的过程会花上一些时间。详见 <reference internal="True" refid="doc-building-the-manual-performance"><inline classes="std std-ref">性能提示</inline></reference>。</paragraph>
        <paragraph>完成后就可以在网页浏览器里打开 <literal>_build/html/index.html</literal> 查看文档了。</paragraph>
        <section ids="dealing-with-errors" names="dealing\ with\ errors 处理错误">
            <title>处理错误</title>
            <paragraph>如果你遇到了错误，可以试试以下命令：</paragraph>
            <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">make SPHINXBUILD=~/.local/bin/sphinx-build html</literal_block>
            <paragraph>If you get a <literal>MemoryError</literal> or <literal>EOFError</literal>, you can remove the <literal>classes/</literal> folder and
                run <literal>make</literal> again.
                This will drop the class references from the final HTML documentation but will keep the
                rest intact.</paragraph>
            <important>
                <paragraph>一旦删除 <literal>classes/</literal> 文件夹，在处理 Pull Request（拉取请求）时请勿使用 <literal>git add .</literal>，否则整个 <literal>classes/</literal> 文件夹的删除都会记录进你的提交之中。详情见 <title_reference>#3157 &lt;https://github.com/godotengine/godot-docs/issues/3157&gt;</title_reference>。</paragraph>
            </important>
            <target refid="doc-building-the-manual-performance"></target>
        </section>
        <section ids="hints-for-performance doc-building-the-manual-performance" names="hints\ for\ performance 性能提示 doc_building_the_manual:performance">
            <title>性能提示</title>
            <section ids="ram-usage" names="ram\ usage 内存占用">
                <title>内存占用</title>
                <paragraph>磁盘交换会拖慢文档构建的速度，关闭后需要至少 8 GB 的内存。如果你有至少 16 GB 的内存，可以这样加速编译：</paragraph>
                <container classes="sphinx-tabs" type="tab-element">
                    <div aria-label="Tabbed content" role="tablist">
                        <button aria-controls="panel-3-V2luZG93cw==" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-3-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button>
                        <button aria-controls="panel-3-T3RoZXIgcGxhdGZvcm1z" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-3-T3RoZXIgcGxhdGZvcm1z" name="T3RoZXIgcGxhdGZvcm1z" role="tab" tabindex="-1">Other platforms</button>
                    </div>
                    <div aria-labelledby="tab-3-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" ids="panel-3-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
                        <literal_block force="False" highlight_args="{}" language="pwsh" linenos="False" xml:space="preserve">set SPHINXOPTS=-j2 &amp;&amp; make html</literal_block>
                    </div>
                    <div aria-labelledby="tab-3-T3RoZXIgcGxhdGZvcm1z" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-3-T3RoZXIgcGxhdGZvcm1z" name="T3RoZXIgcGxhdGZvcm1z" role="tabpanel" tabindex="0">
                        <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">make html SPHINXOPTS=-j2</literal_block>
                    </div>
                </container>
                <paragraph>You can use <literal>-j auto</literal> to use all available CPU threads, but this can use a lot
                    of RAM if you have a lot of CPU threads. For instance, on a system with 32 CPU
                    threads, <literal>-j auto</literal> (which corresponds to <literal>-j 32</literal> here) can require 20+ GB of
                    RAM for Sphinx alone.</paragraph>
            </section>
            <section ids="specifying-a-list-of-files" names="specifying\ a\ list\ of\ files 指定文件列表">
                <title>指定文件列表</title>
                <paragraph>You can specify a list of files to build, which can greatly speed up compilation:</paragraph>
                <literal_block force="False" highlight_args="{}" language="sh" linenos="False" xml:space="preserve">make FILELIST='classes/class_node.rst classes/class_resource.rst' html</literal_block>
                <substitution_definition names="weblate_widget"><reference refuri="https://hosted.weblate.org/engage/godot-engine/zh_CN/?utm_source=widget"><image alt="翻译状态" candidates="{'?': 'https://hosted.weblate.org/widgets/godot-engine/zh_CN/godot-docs/287x66-white.png'}" height="66" uri="https://hosted.weblate.org/widgets/godot-engine/zh_CN/godot-docs/287x66-white.png" width="287"></image></reference></substitution_definition>
            </section>
        </section>
    </section>
</document>
