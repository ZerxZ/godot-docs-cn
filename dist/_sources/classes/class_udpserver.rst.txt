:github_url: hide

.. DO NOT EDIT THIS FILE!!!
.. Generated automatically from Godot engine sources.
.. Generator: https://github.com/godotengine/godot/tree/master/doc/tools/make_rst.py.
.. XML source: https://github.com/godotengine/godot/tree/master/doc/classes/UDPServer.xml.

.. _class_UDPServer:

UDPServer
=========

**ç»§æ‰¿ï¼š** :ref:`RefCounted<class_RefCounted>` **<** :ref:`Object<class_Object>`

ç”¨äºå®ç° UDP æœåŠ¡å™¨çš„è¾…åŠ©ç±»ã€‚

.. rst-class:: classref-introduction-group

æè¿°
----

ç®€æ˜“æœåŠ¡å™¨ï¼Œä¼šæ‰“å¼€ UDP å¥—æ¥å­—ï¼Œå¹¶åœ¨æ”¶åˆ°æ–°æ•°æ®åŒ…æ—¶è¿”å›å·²è¿æ¥çš„ :ref:`PacketPeerUDP<class_PacketPeerUDP>`\ ã€‚å¦è§ :ref:`PacketPeerUDP.connect_to_host<class_PacketPeerUDP_method_connect_to_host>`\ ã€‚

æœåŠ¡å™¨å¯åŠ¨åï¼ˆ\ :ref:`listen<class_UDPServer_method_listen>`\ ï¼‰ï¼Œä½ éœ€è¦è°ƒç”¨ :ref:`poll<class_UDPServer_method_poll>` æŒ‰ç…§ä¸€å®šçš„é—´éš”è½®è¯¢ï¼ˆä¾‹å¦‚åœ¨ :ref:`Node._process<class_Node_private_method__process>` ä¸­ï¼‰æ‰èƒ½å¤„ç†æ–°æ•°æ®åŒ…ã€å°†å®ƒä»¬ä¼ é€’ç»™åˆé€‚çš„ :ref:`PacketPeerUDP<class_PacketPeerUDP>`\ ã€è·å–æ–°è¿æ¥ã€‚

ä¸‹é¢æ˜¯ç®€å•çš„ç”¨æ³•ç¤ºä¾‹ï¼š


.. tabs::

 .. code-tab:: gdscript

    # server_node.gd
    class_name ServerNode
    extends Node
    
    var server := UDPServer.new()
    var peers = []
    
    func _ready():
        server.listen(4242)
    
    func _process(delta):
        server.poll() # é‡è¦ï¼
        if server.is_connection_available():
            var peer: PacketPeerUDP = server.take_connection()
            var packet = peer.get_packet()
            print("æ¥å—å¯¹ç­‰ä½“ï¼š%s:%s" % [peer.get_packet_ip(), peer.get_packet_port()])
            print("æ¥æ”¶åˆ°æ•°æ®ï¼š%s" % [packet.get_string_from_utf8()])
            # è¿›è¡Œå›å¤ï¼Œè¿™æ ·å¯¹æ–¹å°±çŸ¥é“æˆ‘ä»¬æ”¶åˆ°äº†æ¶ˆæ¯ã€‚
            peer.put_packet(packet)
            # ä¿æŒå¼•ç”¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½ç»§ç»­ä¸è¿œç¨‹å¯¹ç­‰ä½“è”ç³»ã€‚
            peers.append(peer)
    
        for i in range(0, peers.size()):
            pass # é’ˆå¯¹å·²è¿æ¥çš„å¯¹ç­‰ä½“è¿›è¡Œæ“ä½œã€‚

 .. code-tab:: csharp

    // ServerNode.cs
    using Godot;
    using System.Collections.Generic;
    
    public partial class ServerNode : Node
    {
        private UdpServer _server = new UdpServer();
        private List<PacketPeerUdp> _peers  = new List<PacketPeerUdp>();
    
        public override void _Ready()
        {
            _server.Listen(4242);
        }
    
        public override void _Process(double delta)
        {
            _server.Poll(); // é‡è¦ï¼
            if (_server.IsConnectionAvailable())
            {
                PacketPeerUdp peer = _server.TakeConnection();
                byte[] packet = peer.GetPacket();
                GD.Print($"æ¥å—å¯¹ç­‰ä½“ï¼š{peer.GetPacketIP()}:{peer.GetPacketPort()}");
                GD.Print($"æ¥æ”¶åˆ°æ•°æ®ï¼š{packet.GetStringFromUtf8()}");
                // è¿›è¡Œå›å¤ï¼Œè¿™æ ·å¯¹æ–¹å°±çŸ¥é“æˆ‘ä»¬æ”¶åˆ°äº†æ¶ˆæ¯ã€‚
                peer.PutPacket(packet);
                // ä¿æŒå¼•ç”¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½ç»§ç»­ä¸è¿œç¨‹å¯¹ç­‰ä½“è”ç³»ã€‚
                _peers.Add(peer);
            }
            foreach (var peer in _peers)
            {
                // é’ˆå¯¹å·²è¿æ¥çš„å¯¹ç­‰ä½“è¿›è¡Œæ“ä½œã€‚
            }
        }
    }




.. tabs::

 .. code-tab:: gdscript

    # client_node.gd
    class_name ClientNode
    extends Node
    
    var udp := PacketPeerUDP.new()
    var connected = false
    
    func _ready():
        udp.connect_to_host("127.0.0.1", 4242)
    
    func _process(delta):
        if !connected:
            # å°è¯•è¿æ¥æœåŠ¡å™¨
            udp.put_packet("ç­”æ¡ˆæ˜¯â€¦â€¦42ï¼".to_utf8_buffer())
        if udp.get_available_packet_count() > 0:
            print("å·²è¿æ¥ï¼š%s" % udp.get_packet().get_string_from_utf8())
            connected = true

 .. code-tab:: csharp

    // ClientNode.cs
    using Godot;
    
    public partial class ClientNode : Node
    {
        private PacketPeerUdp _udp = new PacketPeerUdp();
        private bool _connected = false;
    
        public override void _Ready()
        {
            _udp.ConnectToHost("127.0.0.1", 4242);
        }
    
        public override void _Process(double delta)
        {
            if (!_connected)
            {
                // å°è¯•è”ç³»æœåŠ¡å™¨
                _udp.PutPacket("ç­”æ¡ˆæ˜¯â€¦â€¦42ï¼".ToUtf8Buffer());
            }
            if (_udp.GetAvailablePacketCount() > 0)
            {
                GD.Print($"å·²è¿æ¥ï¼š{_udp.GetPacket().GetStringFromUtf8()}");
                _connected = true;
            }
        }
    }



.. rst-class:: classref-reftable-group

å±æ€§
----

.. table::
   :widths: auto

   +-----------------------+----------------------------------------------------------------------------------+--------+
   | :ref:`int<class_int>` | :ref:`max_pending_connections<class_UDPServer_property_max_pending_connections>` | ``16`` |
   +-----------------------+----------------------------------------------------------------------------------+--------+

.. rst-class:: classref-reftable-group

æ–¹æ³•
----

.. table::
   :widths: auto

   +-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`int<class_int>`                     | :ref:`get_local_port<class_UDPServer_method_get_local_port>`\ (\ ) |const|                                                         |
   +-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                   | :ref:`is_connection_available<class_UDPServer_method_is_connection_available>`\ (\ ) |const|                                       |
   +-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                   | :ref:`is_listening<class_UDPServer_method_is_listening>`\ (\ ) |const|                                                             |
   +-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`Error<enum_@GlobalScope_Error>`     | :ref:`listen<class_UDPServer_method_listen>`\ (\ port\: :ref:`int<class_int>`, bind_address\: :ref:`String<class_String>` = "*"\ ) |
   +-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`Error<enum_@GlobalScope_Error>`     | :ref:`poll<class_UDPServer_method_poll>`\ (\ )                                                                                     |
   +-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
   | |void|                                    | :ref:`stop<class_UDPServer_method_stop>`\ (\ )                                                                                     |
   +-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`PacketPeerUDP<class_PacketPeerUDP>` | :ref:`take_connection<class_UDPServer_method_take_connection>`\ (\ )                                                               |
   +-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------+

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

å±æ€§è¯´æ˜
--------

.. _class_UDPServer_property_max_pending_connections:

.. rst-class:: classref-property

:ref:`int<class_int>` **max_pending_connections** = ``16`` :ref:`ğŸ”—<class_UDPServer_property_max_pending_connections>`

.. rst-class:: classref-property-setget

- |void| **set_max_pending_connections**\ (\ value\: :ref:`int<class_int>`\ )
- :ref:`int<class_int>` **get_max_pending_connections**\ (\ )

å®šä¹‰æœ€å¤§çš„å¾…å®šè¿æ¥æ•°ï¼Œåœ¨\ :ref:`poll<class_UDPServer_method_poll>`\ æœŸé—´ï¼Œä»»ä½•è¶…è¿‡è¯¥å€¼çš„æ–°å¾…å®šè¿æ¥å°†è¢«è‡ªåŠ¨æ”¾å¼ƒã€‚æŠŠè¿™ä¸ªå€¼è®¾ç½®ä¸º\ ``0``\ å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢ä»»ä½•æ–°çš„å¾…å®šè¿æ¥è¢«æ¥å—ï¼Œä¾‹å¦‚ï¼Œå½“ä½ çš„æ‰€æœ‰ç©å®¶éƒ½è¿æ¥æ—¶ã€‚

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

æ–¹æ³•è¯´æ˜
--------

.. _class_UDPServer_method_get_local_port:

.. rst-class:: classref-method

:ref:`int<class_int>` **get_local_port**\ (\ ) |const| :ref:`ğŸ”—<class_UDPServer_method_get_local_port>`

è¿”å›è¯¥æœåŠ¡å™¨æ­£åœ¨ç›‘å¬çš„æœ¬åœ°ç«¯å£ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UDPServer_method_is_connection_available:

.. rst-class:: classref-method

:ref:`bool<class_bool>` **is_connection_available**\ (\ ) |const| :ref:`ğŸ”—<class_UDPServer_method_is_connection_available>`

å¦‚æœåœ¨å¥—æ¥å­—ä¸­æ”¶åˆ°ä¸€ä¸ªå…·æœ‰æ–°åœ°å€åŠç«¯å£ç»„åˆçš„æ•°æ®åŒ…ï¼Œåˆ™è¿”å› ``true``\ ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UDPServer_method_is_listening:

.. rst-class:: classref-method

:ref:`bool<class_bool>` **is_listening**\ (\ ) |const| :ref:`ğŸ”—<class_UDPServer_method_is_listening>`

å¦‚æœå¥—æ¥å­—æ˜¯æ‰“å¼€çš„ï¼Œå¹¶ä¸”åœ¨ç›‘å¬ç«¯å£ï¼Œåˆ™è¿”å› ``true``\ ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UDPServer_method_listen:

.. rst-class:: classref-method

:ref:`Error<enum_@GlobalScope_Error>` **listen**\ (\ port\: :ref:`int<class_int>`, bind_address\: :ref:`String<class_String>` = "*"\ ) :ref:`ğŸ”—<class_UDPServer_method_listen>`

å¯åŠ¨æœåŠ¡å™¨ï¼Œæ‰“å¼€ç›‘å¬ç»™å®šç«¯å£ ``port`` çš„ UDP å¥—æ¥å­—ã€‚è¿˜å¯ä»¥æŒ‡å®š ``bind_address``\ ï¼Œä»…ç›‘å¬å‘é€è‡³è¯¥åœ°å€çš„æ•°æ®åŒ…ã€‚å¦è§ :ref:`PacketPeerUDP.bind<class_PacketPeerUDP_method_bind>`\ ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UDPServer_method_poll:

.. rst-class:: classref-method

:ref:`Error<enum_@GlobalScope_Error>` **poll**\ (\ ) :ref:`ğŸ”—<class_UDPServer_method_poll>`

å®šæœŸè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚åœ¨\ :ref:`Node._process<class_Node_private_method__process>`\ é‡Œé¢ï¼Œæ¥å¤„ç†æ–°æ•°æ®åŒ…ã€‚æ¥è‡ªå·²çŸ¥åœ°å€åŠç«¯å£å¯¹çš„æ•°æ®åŒ…ï¼Œå°†è¢«ä¼ é€’åˆ°ç›¸åº”çš„\ :ref:`PacketPeerUDP<class_PacketPeerUDP>`\ ï¼Œä»»ä½•ä»æœªçŸ¥åœ°å€åŠç«¯å£å¯¹æ”¶åˆ°çš„æ•°æ®åŒ…å°†è¢«æ·»åŠ ä¸ºä¸€ä¸ªå¾…å®šè¿æ¥ï¼Œå‚é˜…\ :ref:`is_connection_available<class_UDPServer_method_is_connection_available>`, :ref:`take_connection<class_UDPServer_method_take_connection>`\ ã€‚å¾…å®šè¿æ¥çš„æœ€å¤§æ•°é‡é€šè¿‡\ :ref:`max_pending_connections<class_UDPServer_property_max_pending_connections>`\ å®šä¹‰ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UDPServer_method_stop:

.. rst-class:: classref-method

|void| **stop**\ (\ ) :ref:`ğŸ”—<class_UDPServer_method_stop>`

åœæ­¢æœåŠ¡å™¨ï¼Œå¦‚æœ UDP å¥—æ¥å­—å¤„äºæ‰“å¼€çŠ¶æ€ï¼Œå°±å…³é—­å®ƒã€‚å°†å…³é—­æ‰€æœ‰é€šè¿‡ :ref:`take_connection<class_UDPServer_method_take_connection>` æ¥å—è¿æ¥çš„ :ref:`PacketPeerUDP<class_PacketPeerUDP>`\ ï¼ˆä¸ä¼šé€šçŸ¥è¿œç¨‹å¯¹ç­‰ä½“ï¼‰ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UDPServer_method_take_connection:

.. rst-class:: classref-method

:ref:`PacketPeerUDP<class_PacketPeerUDP>` **take_connection**\ (\ ) :ref:`ğŸ”—<class_UDPServer_method_take_connection>`

è¿”å›ç¬¬ä¸€ä¸ªæŒ‚èµ·çš„è¿æ¥ï¼ˆè¿æ¥åˆ°é€‚å½“çš„åœ°å€åŠç«¯å£ï¼‰ã€‚å¦‚æœæ²¡æœ‰æ–°çš„è¿æ¥å¯ç”¨ï¼Œå°†è¿”å› ``null``\ ã€‚å¦è¯·å‚é˜… :ref:`is_connection_available<class_UDPServer_method_is_connection_available>`\ ã€\ :ref:`PacketPeerUDP.connect_to_host<class_PacketPeerUDP_method_connect_to_host>`\ ã€‚

.. |virtual| replace:: :abbr:`virtual (æœ¬æ–¹æ³•é€šå¸¸éœ€è¦ç”¨æˆ·è¦†ç›–æ‰èƒ½ç”Ÿæ•ˆã€‚)`
.. |const| replace:: :abbr:`const (æœ¬æ–¹æ³•æ— å‰¯ä½œç”¨ï¼Œä¸ä¼šä¿®æ”¹è¯¥å®ä¾‹çš„ä»»ä½•æˆå‘˜å˜é‡ã€‚)`
.. |vararg| replace:: :abbr:`vararg (æœ¬æ–¹æ³•é™¤äº†èƒ½æ¥å—åœ¨æ­¤å¤„æè¿°çš„å‚æ•°å¤–ï¼Œè¿˜èƒ½å¤Ÿç»§ç»­æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚)`
.. |constructor| replace:: :abbr:`constructor (æœ¬æ–¹æ³•ç”¨äºæ„é€ æŸä¸ªç±»å‹ã€‚)`
.. |static| replace:: :abbr:`static (è°ƒç”¨æœ¬æ–¹æ³•æ— éœ€å®ä¾‹ï¼Œå¯ç›´æ¥ä½¿ç”¨ç±»åè¿›è¡Œè°ƒç”¨ã€‚)`
.. |operator| replace:: :abbr:`operator (æœ¬æ–¹æ³•æè¿°çš„æ˜¯ä½¿ç”¨æœ¬ç±»å‹ä½œä¸ºå·¦æ“ä½œæ•°çš„æœ‰æ•ˆè¿ç®—ç¬¦ã€‚)`
.. |bitfield| replace:: :abbr:`BitField (è¿™ä¸ªå€¼æ˜¯ç”±ä¸‹åˆ—ä½æ ‡å¿—æ„æˆä½æ©ç çš„æ•´æ•°ã€‚)`
.. |void| replace:: :abbr:`void (æ— è¿”å›å€¼ã€‚)`
