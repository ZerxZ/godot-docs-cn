:github_url: hide

.. DO NOT EDIT THIS FILE!!!
.. Generated automatically from Godot engine sources.
.. Generator: https://github.com/godotengine/godot/tree/master/doc/tools/make_rst.py.
.. XML source: https://github.com/godotengine/godot/tree/master/doc/classes/WorkerThreadPool.xml.

.. _class_WorkerThreadPool:

WorkerThreadPool
================

**ç»§æ‰¿ï¼š** :ref:`Object<class_Object>`

å•ä¾‹ï¼Œå¯åŠ¨æ—¶ä¼šåˆ†é…ä¸€äº› :ref:`Thread<class_Thread>`\ ï¼Œå¯ä»¥å°†ä»»åŠ¡å¸è½½åˆ°è¿™äº›çº¿ç¨‹ä¸­æ‰§è¡Œã€‚

.. rst-class:: classref-introduction-group

æè¿°
----

**WorkerThreadPool** å•ä¾‹åœ¨é¡¹ç›®å¯åŠ¨æ—¶ä¼šåˆ†é…ä¸€ç»„ :ref:`Thread<class_Thread>`\ ï¼ˆç§°ä½œå·¥ä½œçº¿ç¨‹ï¼‰å¹¶æä¾›å°†ä»»åŠ¡å¸è½½è‡³è¿™äº›çº¿ç¨‹ä¸Šæ‰§è¡Œçš„æ–¹æ³•ã€‚è¿™æ ·å°±èƒ½å¤Ÿç®€åŒ–å¤šçº¿ç¨‹çš„ä½¿ç”¨ï¼Œä¸å¿…åˆ›å»º :ref:`Thread<class_Thread>`\ ã€‚

ä»»åŠ¡é‡Œæ”¾ç½®çš„æ˜¯è¦è®©çº¿ç¨‹æ‰§è¡Œçš„ :ref:`Callable<class_Callable>`\ ã€‚\ **WorkerThreadPool** æ—¢å¯ä»¥åˆ›å»ºå¸¸è§„ä»»åŠ¡ä¹Ÿå¯ä»¥åˆ›å»ºåˆ†ç»„ä»»åŠ¡ï¼Œå¸¸è§„ä»»åŠ¡ç”±å•ä¸ªå·¥ä½œçº¿ç¨‹æ‰§è¡Œï¼Œè€Œåˆ†ç»„ä»»åŠ¡å¯ä»¥åˆ†å¸ƒåœ¨å¤šä¸ªå·¥ä½œçº¿ç¨‹æ‰§è¡Œã€‚åˆ†ç»„ä»»åŠ¡ä¼šå¤šæ¬¡æ‰§è¡ŒåŒä¸€ä¸ª :ref:`Callable<class_Callable>`\ ï¼Œå¯ç”¨äºéå†å¤§é‡çš„å…ƒç´ ï¼Œä¾‹å¦‚åœºæ™¯ä¸­çš„æ•Œäººã€‚

ä»¥ä¸‹æ˜¯å°†å¼€é”€å¾ˆå¤§çš„å‡½æ•°å¸è½½åˆ°å·¥ä½œçº¿ç¨‹æ‰§è¡Œçš„ä¾‹å­ï¼š


.. tabs::

 .. code-tab:: gdscript

    var enemies = [] # ç”¨æ•Œäººå¡«å……çš„æ•°ç»„ã€‚
    
    func process_enemy_ai(enemy_index):
        var processed_enemy = enemies[enemy_index]
        # å¼€é”€å¾ˆå¤§çš„é€»è¾‘â€¦â€¦
    
    func _process(delta):
        var task_id = WorkerThreadPool.add_group_task(process_enemy_ai, enemies.size())
        # å…¶ä»–ä»£ç â€¦â€¦
        WorkerThreadPool.wait_for_group_task_completion(task_id)
        # è¦æ±‚æ•Œäºº AI å·²ç»å¤„ç†å®Œæ¯•çš„å…¶ä»–ä»£ç ã€‚

 .. code-tab:: csharp

    private List<Node> _enemies = new List<Node>(); // ç”¨æ•Œäººå¡«å……çš„æ•°ç»„ã€‚
    
    private void ProcessEnemyAI(int enemyIndex)
    {
        Node processedEnemy = _enemies[enemyIndex];
        // å¼€é”€å¾ˆå¤§çš„é€»è¾‘â€¦â€¦
    }
    
    public override void _Process(double delta)
    {
        long taskId = WorkerThreadPool.AddGroupTask(Callable.From<int>(ProcessEnemyAI), _enemies.Count);
        // å…¶ä»–ä»£ç â€¦â€¦
        WorkerThreadPool.WaitForGroupTaskCompletion(taskId);
        // è¦æ±‚æ•Œäºº AI å·²ç»å¤„ç†å®Œæ¯•çš„å…¶ä»–ä»£ç ã€‚
    }



ä»¥ä¸Šä»£ç è¦æ±‚ ``enemies`` æ•°ç»„ä¸­çš„å…ƒç´ ä¸ªæ•°åœ¨å¤šçº¿ç¨‹éƒ¨åˆ†æ‰§è¡Œæ—¶ä¿æŒä¸å˜ã€‚

\ **æ³¨æ„ï¼š**\ å¦‚æœåˆ†å¸ƒåˆ°å¤šä¸ªçº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡åœ¨è®¡ç®—æ–¹é¢çš„å¼€é”€å¹¶ä¸å¤§ï¼Œé‚£ä¹ˆä½¿ç”¨è¿™ä¸ªå•ä¾‹å¯èƒ½å¯¹æ€§èƒ½æœ‰è´Ÿé¢å½±å“ã€‚

.. rst-class:: classref-introduction-group

æ•™ç¨‹
----

- :doc:`ä½¿ç”¨å¤šçº¿ç¨‹ <../tutorials/performance/using_multiple_threads>`

- :doc:`çº¿ç¨‹å®‰å…¨çš„ API <../tutorials/performance/thread_safe_apis>`

.. rst-class:: classref-reftable-group

æ–¹æ³•
----

.. table::
   :widths: auto

   +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`int<class_int>`                 | :ref:`add_group_task<class_WorkerThreadPool_method_add_group_task>`\ (\ action\: :ref:`Callable<class_Callable>`, elements\: :ref:`int<class_int>`, tasks_needed\: :ref:`int<class_int>` = -1, high_priority\: :ref:`bool<class_bool>` = false, description\: :ref:`String<class_String>` = ""\ ) |
   +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`int<class_int>`                 | :ref:`add_task<class_WorkerThreadPool_method_add_task>`\ (\ action\: :ref:`Callable<class_Callable>`, high_priority\: :ref:`bool<class_bool>` = false, description\: :ref:`String<class_String>` = ""\ )                                                                                          |
   +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`int<class_int>`                 | :ref:`get_group_processed_element_count<class_WorkerThreadPool_method_get_group_processed_element_count>`\ (\ group_id\: :ref:`int<class_int>`\ ) |const|                                                                                                                                         |
   +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`               | :ref:`is_group_task_completed<class_WorkerThreadPool_method_is_group_task_completed>`\ (\ group_id\: :ref:`int<class_int>`\ ) |const|                                                                                                                                                             |
   +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`               | :ref:`is_task_completed<class_WorkerThreadPool_method_is_task_completed>`\ (\ task_id\: :ref:`int<class_int>`\ ) |const|                                                                                                                                                                          |
   +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | |void|                                | :ref:`wait_for_group_task_completion<class_WorkerThreadPool_method_wait_for_group_task_completion>`\ (\ group_id\: :ref:`int<class_int>`\ )                                                                                                                                                       |
   +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`Error<enum_@GlobalScope_Error>` | :ref:`wait_for_task_completion<class_WorkerThreadPool_method_wait_for_task_completion>`\ (\ task_id\: :ref:`int<class_int>`\ )                                                                                                                                                                    |
   +---------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

æ–¹æ³•è¯´æ˜
--------

.. _class_WorkerThreadPool_method_add_group_task:

.. rst-class:: classref-method

:ref:`int<class_int>` **add_group_task**\ (\ action\: :ref:`Callable<class_Callable>`, elements\: :ref:`int<class_int>`, tasks_needed\: :ref:`int<class_int>` = -1, high_priority\: :ref:`bool<class_bool>` = false, description\: :ref:`String<class_String>` = ""\ ) :ref:`ğŸ”—<class_WorkerThreadPool_method_add_group_task>`

å°† ``action`` æ·»åŠ ä¸ºåˆ†ç»„ä»»åŠ¡ï¼Œè®©å¤šä¸ªå·¥ä½œçº¿ç¨‹æ‰§è¡Œã€‚è¯¥ :ref:`Callable<class_Callable>` çš„è°ƒç”¨æ¬¡æ•°ç”± ``elements`` å†³å®šï¼Œç¬¬ä¸€ä¸ªè°ƒç”¨çš„çº¿ç¨‹ä½¿ç”¨ ``0`` ä½œä¸ºå‚æ•°ï¼Œåç»­æ‰§è¡Œæ—¶ä¼šå°†å…¶åŠ  1ï¼Œç›´åˆ°å˜ä¸º ``element - 1``\ ã€‚

ä»»åŠ¡åˆ†å¸ƒçš„çº¿ç¨‹æ•°ç”± ``tasks_needed`` å®šä¹‰ï¼Œé»˜è®¤å€¼ ``-1`` è¡¨ç¤ºåˆ†å¸ƒåˆ°æ‰€æœ‰å·¥ä½œçº¿ç¨‹ã€‚\ ``high_priority`` å†³å®šçš„æ˜¯ä»»åŠ¡å…·æœ‰é«˜ä¼˜å…ˆçº§è¿˜æ˜¯ä½ä¼˜å…ˆçº§ï¼ˆé»˜è®¤ï¼‰ã€‚ä½ è¿˜å¯ä»¥é€‰æ‹©æä¾› ``description`` ä½œä¸ºæè¿°ä¿¡æ¯ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚

è¿”å›åˆ†ç»„ä»»åŠ¡ IDï¼Œå¯ç”¨äºå…¶ä»–æ–¹æ³•ã€‚

\ **è­¦å‘Šï¼š**\ æ¯ä¸ªä»»åŠ¡éƒ½å¿…é¡»åœ¨æŸå¤„ä½¿ç”¨ :ref:`wait_for_task_completion<class_WorkerThreadPool_method_wait_for_task_completion>` æˆ– :ref:`wait_for_group_task_completion<class_WorkerThreadPool_method_wait_for_group_task_completion>` ç­‰å¾…å®Œæˆï¼Œä»è€Œæ¸…ç†ä»»åŠ¡ä¸­åˆ†é…çš„èµ„æºã€‚

.. rst-class:: classref-item-separator

----

.. _class_WorkerThreadPool_method_add_task:

.. rst-class:: classref-method

:ref:`int<class_int>` **add_task**\ (\ action\: :ref:`Callable<class_Callable>`, high_priority\: :ref:`bool<class_bool>` = false, description\: :ref:`String<class_String>` = ""\ ) :ref:`ğŸ”—<class_WorkerThreadPool_method_add_task>`

å°† ``action`` æ·»åŠ ä¸ºåˆ†ç»„ä»»åŠ¡ï¼Œè®©å•ä¸ªå·¥ä½œçº¿ç¨‹æ‰§è¡Œã€‚\ ``high_priority`` å†³å®šçš„æ˜¯ä»»åŠ¡å…·æœ‰é«˜ä¼˜å…ˆçº§è¿˜æ˜¯ä½ä¼˜å…ˆçº§ï¼ˆé»˜è®¤ï¼‰ã€‚ä½ è¿˜å¯ä»¥é€‰æ‹©æä¾› ``description`` ä½œä¸ºæè¿°ä¿¡æ¯ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚

è¿”å›ä»»åŠ¡ IDï¼Œå¯ç”¨äºå…¶ä»–æ–¹æ³•ã€‚

\ **è­¦å‘Šï¼š**\ æ¯ä¸ªä»»åŠ¡éƒ½å¿…é¡»åœ¨æŸå¤„ä½¿ç”¨ :ref:`wait_for_task_completion<class_WorkerThreadPool_method_wait_for_task_completion>` æˆ– :ref:`wait_for_group_task_completion<class_WorkerThreadPool_method_wait_for_group_task_completion>` ç­‰å¾…å®Œæˆï¼Œä»è€Œæ¸…ç†ä»»åŠ¡ä¸­åˆ†é…çš„èµ„æºã€‚

.. rst-class:: classref-item-separator

----

.. _class_WorkerThreadPool_method_get_group_processed_element_count:

.. rst-class:: classref-method

:ref:`int<class_int>` **get_group_processed_element_count**\ (\ group_id\: :ref:`int<class_int>`\ ) |const| :ref:`ğŸ”—<class_WorkerThreadPool_method_get_group_processed_element_count>`

è¿”å›å…·æœ‰ç»™å®š ID çš„åˆ†ç»„ä»»åŠ¡çš„ :ref:`Callable<class_Callable>` å·²ç»è¢«å·¥ä½œçº¿ç¨‹æ‰§è¡Œçš„æ¬¡æ•°ã€‚

\ **æ³¨æ„ï¼š**\ çº¿ç¨‹å·²ç»å¼€å§‹æ‰§è¡Œ :ref:`Callable<class_Callable>` ä½†å°šæœªå®Œæˆçš„æƒ…å†µä¸è®¡ç®—åœ¨å†…ã€‚

.. rst-class:: classref-item-separator

----

.. _class_WorkerThreadPool_method_is_group_task_completed:

.. rst-class:: classref-method

:ref:`bool<class_bool>` **is_group_task_completed**\ (\ group_id\: :ref:`int<class_int>`\ ) |const| :ref:`ğŸ”—<class_WorkerThreadPool_method_is_group_task_completed>`

å¦‚æœ ID å¯¹åº”çš„åˆ†ç»„ä»»åŠ¡å·²å®Œæˆï¼Œåˆ™è¿”å› ``true``\ ã€‚

\ **æ³¨æ„ï¼š**\ åªåº”è¯¥åœ¨æ·»åŠ åˆ†ç»„ä»»åŠ¡ä¹‹åã€ç­‰å¾…å®Œæˆä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•ã€‚

.. rst-class:: classref-item-separator

----

.. _class_WorkerThreadPool_method_is_task_completed:

.. rst-class:: classref-method

:ref:`bool<class_bool>` **is_task_completed**\ (\ task_id\: :ref:`int<class_int>`\ ) |const| :ref:`ğŸ”—<class_WorkerThreadPool_method_is_task_completed>`

å¦‚æœ ID å¯¹åº”çš„ä»»åŠ¡å·²å®Œæˆï¼Œåˆ™è¿”å› ``true``\ ã€‚

\ **æ³¨æ„ï¼š**\ åªåº”è¯¥åœ¨æ·»åŠ åˆ†ç»„ä»»åŠ¡ä¹‹åã€ç­‰å¾…å®Œæˆä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•ã€‚

.. rst-class:: classref-item-separator

----

.. _class_WorkerThreadPool_method_wait_for_group_task_completion:

.. rst-class:: classref-method

|void| **wait_for_group_task_completion**\ (\ group_id\: :ref:`int<class_int>`\ ) :ref:`ğŸ”—<class_WorkerThreadPool_method_wait_for_group_task_completion>`

åœ¨å…·æœ‰ç»™å®š ID çš„åˆ†ç»„ä»»åŠ¡å®Œæˆå‰æš‚åœè°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„çº¿ç¨‹ã€‚

.. rst-class:: classref-item-separator

----

.. _class_WorkerThreadPool_method_wait_for_task_completion:

.. rst-class:: classref-method

:ref:`Error<enum_@GlobalScope_Error>` **wait_for_task_completion**\ (\ task_id\: :ref:`int<class_int>`\ ) :ref:`ğŸ”—<class_WorkerThreadPool_method_wait_for_task_completion>`

æš‚åœè°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹ï¼Œç›´åˆ°ç»™å®š ID å¯¹åº”çš„ä»»åŠ¡å®Œæˆã€‚

å¦‚æœèƒ½å¤ŸæˆåŠŸç­‰å¾…ä»»åŠ¡ï¼Œåˆ™è¿”å› :ref:`@GlobalScope.OK<class_@GlobalScope_constant_OK>`\ ã€‚

å¦‚æœä¸å­˜åœ¨ä¸ä¼ å…¥ ID å¯¹åº”çš„ä»»åŠ¡ï¼ˆå¯èƒ½å·²è¢«ç­‰å¾…æˆ–å¤„ç†ï¼‰ï¼Œåˆ™è¿”å› :ref:`@GlobalScope.ERR_INVALID_PARAMETER<class_@GlobalScope_constant_ERR_INVALID_PARAMETER>`\ ã€‚

å¦‚æœå…¶ä»–æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡è°ƒç”¨äº†è¯¥æ–¹æ³•ï¼Œå¹¶ä¸”ç”±äºä»»åŠ¡è°ƒåº¦çš„åŸå› ï¼Œå­˜åœ¨æ­»é”çš„å¯èƒ½æ€§ï¼ˆä¾‹å¦‚ï¼Œè¦ç­‰å¾…çš„ä»»åŠ¡å¯èƒ½ä½äºè°ƒç”¨å †æ ˆä¸­çš„è¾ƒä½çº§åˆ«ï¼Œå› æ­¤ä¸èƒ½ç»§ç»­ï¼‰ï¼Œåˆ™è¿”å› :ref:`@GlobalScope.ERR_BUSY<class_@GlobalScope_constant_ERR_BUSY>`\ ã€‚è¿™æ˜¯æ¯”è¾ƒé«˜çº§çš„æƒ…å†µï¼Œåªæœ‰ä»»åŠ¡ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼ˆåœ¨å½“å‰å®ç°ä¸­ï¼Œæ£˜æ‰‹çš„æƒ…å†µæ˜¯å°è¯•ç­‰å¾…è¾ƒæ—§ä»»åŠ¡çš„ä»»åŠ¡ï¼‰æ—¶æ‰ä¼šå‡ºç°ã€‚

.. |virtual| replace:: :abbr:`virtual (æœ¬æ–¹æ³•é€šå¸¸éœ€è¦ç”¨æˆ·è¦†ç›–æ‰èƒ½ç”Ÿæ•ˆã€‚)`
.. |const| replace:: :abbr:`const (æœ¬æ–¹æ³•æ²¡æœ‰å‰¯ä½œç”¨ï¼Œä¸ä¼šä¿®æ”¹è¯¥å®ä¾‹çš„ä»»ä½•æˆå‘˜å˜é‡ã€‚)`
.. |vararg| replace:: :abbr:`vararg (æœ¬æ–¹æ³•é™¤äº†èƒ½æ¥å—åœ¨æ­¤å¤„æè¿°çš„å‚æ•°å¤–ï¼Œè¿˜èƒ½å¤Ÿç»§ç»­æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚)`
.. |constructor| replace:: :abbr:`constructor (æœ¬æ–¹æ³•ç”¨äºæ„é€ æŸä¸ªç±»å‹ã€‚)`
.. |static| replace:: :abbr:`static (è°ƒç”¨æœ¬æ–¹æ³•æ— éœ€å®ä¾‹ï¼Œå¯ç›´æ¥ä½¿ç”¨ç±»åè¿›è¡Œè°ƒç”¨ã€‚)`
.. |operator| replace:: :abbr:`operator (æœ¬æ–¹æ³•æè¿°çš„æ˜¯ä½¿ç”¨æœ¬ç±»å‹ä½œä¸ºå·¦æ“ä½œæ•°çš„æœ‰æ•ˆæ“ä½œç¬¦ã€‚)`
.. |bitfield| replace:: :abbr:`BitField (è¿™ä¸ªå€¼æ˜¯ç”±ä¸‹åˆ—æ ‡å¿—æ„æˆçš„ä½æ©ç æ•´æ•°ã€‚)`
.. |void| replace:: :abbr:`void (æ— è¿”å›å€¼ã€‚)`
